<section class="slide" id="server-calls" data-color="teal" tabindex="-1">
  <h2>Serverâ€‘Side API Calls</h2>
  
  <div class="ssrf-layout">
    <div class="ssrf-content">
      <div class="ssrf-explanation">
        <h3>What is SSRF?</h3>
        <p><strong>Server-Side Request Forgery</strong> = Your server makes requests to URLs controlled by attackers</p>
        
        <div class="attack-examples">
          <h4>ğŸ¯ Common Targets:</h4>
          <ul>
            <li><code>169.254.169.254</code> - Cloud metadata (AWS secrets!)</li>
            <li><code>localhost:3000</code> - Internal admin panels</li>
            <li><code>192.168.1.1</code> - Router configs</li>
            <li><code>file:///etc/passwd</code> - Local files</li>
          </ul>
        </div>
        
        <div class="key-rules">
          <h4>ğŸ›¡ï¸ Protection Rules:</h4>
          <ul>
            <li>Use an outbound allowlist (exact hosts)</li>
            <li>Block private/loopback/metadata IPs</li>
            <li>Only allow http/https on standard ports</li>
            <li>Disallow redirects/userinfo tricks</li>
          </ul>
        </div>
      </div>
    </div>
    
    <div class="ssrf-demo-panel">
      <div id="ssrfDemo" class="demo">
        <h4>ğŸ§ª Test SSRF Protection</h4>
        <p class="demo-instructions">Enter URLs your server might fetch (webhooks, APIs, user data sources):</p>
        
        <div class="ssrf-samples">
          <button onclick="document.querySelector('#ssrfDemo input').value='https://example.com/api'; testSSRF(document.querySelector('#ssrfDemo button'))">âœ… Safe URL</button>
          <button onclick="document.querySelector('#ssrfDemo input').value='http://localhost:3000/admin'; testSSRF(document.querySelector('#ssrfDemo button'))">âŒ Internal Target</button>
          <button onclick="document.querySelector('#ssrfDemo input').value='http://169.254.169.254/metadata'; testSSRF(document.querySelector('#ssrfDemo button'))">âŒ Cloud Metadata</button>
        </div>
        
        <input type="url" placeholder="Enter URL to fetch..." />
        <button onclick="testSSRF(this)">Test Fetch</button>
        <div class="ssrf-results"></div>
      </div>
    </div>
  </div>
</section>